"use strict";var TE=Object.create;var Ui=Object.defineProperty;var SE=Object.getOwnPropertyDescriptor;var bE=Object.getOwnPropertyNames;var IE=Object.getPrototypeOf,RE=Object.prototype.hasOwnProperty;var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),AE=(t,e)=>{for(var r in e)Ui(t,r,{get:e[r],enumerable:!0})},Tl=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of bE(e))!RE.call(t,i)&&i!==r&&Ui(t,i,{get:()=>e[i],enumerable:!(n=SE(e,i))||n.enumerable});return t};var q=(t,e,r)=>(r=t!=null?TE(IE(t)):{},Tl(e||!t||!t.__esModule?Ui(r,"default",{value:t,enumerable:!0}):r,t)),OE=t=>Tl(Ui({},"__esModule",{value:!0}),t);var Ye=p(Uo=>{"use strict";Uo.fromCallback=function(t){return Object.defineProperty(function(){if(typeof arguments[arguments.length-1]=="function")t.apply(this,arguments);else return new Promise((e,r)=>{arguments[arguments.length]=(n,i)=>{if(n)return r(n);e(i)},arguments.length++,t.apply(this,arguments)})},"name",{value:t.name})};Uo.fromPromise=function(t){return Object.defineProperty(function(){let e=arguments[arguments.length-1];if(typeof e!="function")return t.apply(this,arguments);t.apply(this,arguments).then(r=>e(null,r),e)},"name",{value:t.name})}});var Ol=p((WA,Al)=>{var zt=require("constants"),PE=process.cwd,Wi=null,qE=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Wi||(Wi=PE.call(process)),Wi};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Bo=process.chdir,process.chdir=function(t){Wi=null,Bo.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Bo));var Bo;Al.exports=NE;function NE(t){zt.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=s(t.chown),t.fchown=s(t.fchown),t.lchown=s(t.lchown),t.chmod=n(t.chmod),t.fchmod=n(t.fchmod),t.lchmod=n(t.lchmod),t.chownSync=o(t.chownSync),t.fchownSync=o(t.fchownSync),t.lchownSync=o(t.lchownSync),t.chmodSync=i(t.chmodSync),t.fchmodSync=i(t.fchmodSync),t.lchmodSync=i(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=c(t.statSync),t.fstatSync=c(t.fstatSync),t.lstatSync=c(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(u,f,d){d&&process.nextTick(d)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(u,f,d,h){h&&process.nextTick(h)},t.lchownSync=function(){}),qE==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(u){function f(d,h,m){var v=Date.now(),g=0;u(d,h,function y(E){if(E&&(E.code==="EACCES"||E.code==="EPERM")&&Date.now()-v<6e4){setTimeout(function(){t.stat(h,function(x,T){x&&x.code==="ENOENT"?u(d,h,y):m(E)})},g),g<100&&(g+=10);return}m&&m(E)})}return Object.setPrototypeOf&&Object.setPrototypeOf(f,u),f}(t.rename)),t.read=typeof t.read!="function"?t.read:function(u){function f(d,h,m,v,g,y){var E;if(y&&typeof y=="function"){var x=0;E=function(T,re,pe){if(T&&T.code==="EAGAIN"&&x<10)return x++,u.call(t,d,h,m,v,g,E);y.apply(this,arguments)}}return u.call(t,d,h,m,v,g,E)}return Object.setPrototypeOf&&Object.setPrototypeOf(f,u),f}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(u){return function(f,d,h,m,v){for(var g=0;;)try{return u.call(t,f,d,h,m,v)}catch(y){if(y.code==="EAGAIN"&&g<10){g++;continue}throw y}}}(t.readSync);function e(u){u.lchmod=function(f,d,h){u.open(f,zt.O_WRONLY|zt.O_SYMLINK,d,function(m,v){if(m){h&&h(m);return}u.fchmod(v,d,function(g){u.close(v,function(y){h&&h(g||y)})})})},u.lchmodSync=function(f,d){var h=u.openSync(f,zt.O_WRONLY|zt.O_SYMLINK,d),m=!0,v;try{v=u.fchmodSync(h,d),m=!1}finally{if(m)try{u.closeSync(h)}catch{}else u.closeSync(h)}return v}}function r(u){zt.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(f,d,h,m){u.open(f,zt.O_SYMLINK,function(v,g){if(v){m&&m(v);return}u.futimes(g,d,h,function(y){u.close(g,function(E){m&&m(y||E)})})})},u.lutimesSync=function(f,d,h){var m=u.openSync(f,zt.O_SYMLINK),v,g=!0;try{v=u.futimesSync(m,d,h),g=!1}finally{if(g)try{u.closeSync(m)}catch{}else u.closeSync(m)}return v}):u.futimes&&(u.lutimes=function(f,d,h,m){m&&process.nextTick(m)},u.lutimesSync=function(){})}function n(u){return u&&function(f,d,h){return u.call(t,f,d,function(m){l(m)&&(m=null),h&&h.apply(this,arguments)})}}function i(u){return u&&function(f,d){try{return u.call(t,f,d)}catch(h){if(!l(h))throw h}}}function s(u){return u&&function(f,d,h,m){return u.call(t,f,d,h,function(v){l(v)&&(v=null),m&&m.apply(this,arguments)})}}function o(u){return u&&function(f,d,h){try{return u.call(t,f,d,h)}catch(m){if(!l(m))throw m}}}function a(u){return u&&function(f,d,h){typeof d=="function"&&(h=d,d=null);function m(v,g){g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),h&&h.apply(this,arguments)}return d?u.call(t,f,d,m):u.call(t,f,m)}}function c(u){return u&&function(f,d){var h=d?u.call(t,f,d):u.call(t,f);return h&&(h.uid<0&&(h.uid+=4294967296),h.gid<0&&(h.gid+=4294967296)),h}}function l(u){if(!u||u.code==="ENOSYS")return!0;var f=!process.getuid||process.getuid()!==0;return!!(f&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var Pl=p((zA,Dl)=>{var kl=require("stream").Stream;Dl.exports=LE;function LE(t){return{ReadStream:e,WriteStream:r};function e(n,i){if(!(this instanceof e))return new e(n,i);kl.call(this);var s=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var o=Object.keys(i),a=0,c=o.length;a<c;a++){var l=o[a];this[l]=i[l]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}t.open(this.path,this.flags,this.mode,function(u,f){if(u){s.emit("error",u),s.readable=!1;return}s.fd=f,s.emit("open",f),s._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);kl.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var s=Object.keys(i),o=0,a=s.length;o<a;o++){var c=s[o];this[c]=i[c]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Nl=p((XA,ql)=>{"use strict";ql.exports=ME;var FE=Object.getPrototypeOf||function(t){return t.__proto__};function ME(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:FE(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var ye=p((QA,Wo)=>{var ce=require("fs"),jE=Ol(),$E=Pl(),HE=Nl(),zi=require("util"),Ie,Qi;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Ie=Symbol.for("graceful-fs.queue"),Qi=Symbol.for("graceful-fs.previous")):(Ie="___graceful-fs.queue",Qi="___graceful-fs.previous");function UE(){}function Ml(t,e){Object.defineProperty(t,Ie,{get:function(){return e}})}var dr=UE;zi.debuglog?dr=zi.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(dr=function(){var t=zi.format.apply(zi,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});ce[Ie]||(Ll=global[Ie]||[],Ml(ce,Ll),ce.close=function(t){function e(r,n){return t.call(ce,r,function(i){i||Fl(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(e,Qi,{value:t}),e}(ce.close),ce.closeSync=function(t){function e(r){t.apply(ce,arguments),Fl()}return Object.defineProperty(e,Qi,{value:t}),e}(ce.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){dr(ce[Ie]),require("assert").equal(ce[Ie].length,0)}));var Ll;global[Ie]||Ml(global,ce[Ie]);Wo.exports=Go(HE(ce));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!ce.__patched&&(Wo.exports=Go(ce),ce.__patched=!0);function Go(t){jE(t),t.gracefulify=Go,t.createReadStream=re,t.createWriteStream=pe;var e=t.readFile;t.readFile=r;function r(w,k,R){return typeof k=="function"&&(R=k,k=null),ae(w,k,R);function ae(J,de,U,B){return e(J,de,function(M){M&&(M.code==="EMFILE"||M.code==="ENFILE")?Ur([ae,[J,de,U],M,B||Date.now(),Date.now()]):typeof U=="function"&&U.apply(this,arguments)})}}var n=t.writeFile;t.writeFile=i;function i(w,k,R,ae){return typeof R=="function"&&(ae=R,R=null),J(w,k,R,ae);function J(de,U,B,M,P){return n(de,U,B,function(F){F&&(F.code==="EMFILE"||F.code==="ENFILE")?Ur([J,[de,U,B,M],F,P||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var s=t.appendFile;s&&(t.appendFile=o);function o(w,k,R,ae){return typeof R=="function"&&(ae=R,R=null),J(w,k,R,ae);function J(de,U,B,M,P){return s(de,U,B,function(F){F&&(F.code==="EMFILE"||F.code==="ENFILE")?Ur([J,[de,U,B,M],F,P||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=c);function c(w,k,R,ae){return typeof R=="function"&&(ae=R,R=0),J(w,k,R,ae);function J(de,U,B,M,P){return a(de,U,B,function(F){F&&(F.code==="EMFILE"||F.code==="ENFILE")?Ur([J,[de,U,B,M],F,P||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var l=t.readdir;t.readdir=f;var u=/^v[0-5]\./;function f(w,k,R){typeof k=="function"&&(R=k,k=null);var ae=u.test(process.version)?function(U,B,M,P){return l(U,J(U,B,M,P))}:function(U,B,M,P){return l(U,B,J(U,B,M,P))};return ae(w,k,R);function J(de,U,B,M){return function(P,F){P&&(P.code==="EMFILE"||P.code==="ENFILE")?Ur([ae,[de,U,B],P,M||Date.now(),Date.now()]):(F&&F.sort&&F.sort(),typeof B=="function"&&B.call(this,P,F))}}}if(process.version.substr(0,4)==="v0.8"){var d=$E(t);y=d.ReadStream,x=d.WriteStream}var h=t.ReadStream;h&&(y.prototype=Object.create(h.prototype),y.prototype.open=E);var m=t.WriteStream;m&&(x.prototype=Object.create(m.prototype),x.prototype.open=T),Object.defineProperty(t,"ReadStream",{get:function(){return y},set:function(w){y=w},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return x},set:function(w){x=w},enumerable:!0,configurable:!0});var v=y;Object.defineProperty(t,"FileReadStream",{get:function(){return v},set:function(w){v=w},enumerable:!0,configurable:!0});var g=x;Object.defineProperty(t,"FileWriteStream",{get:function(){return g},set:function(w){g=w},enumerable:!0,configurable:!0});function y(w,k){return this instanceof y?(h.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}function E(){var w=this;ee(w.path,w.flags,w.mode,function(k,R){k?(w.autoClose&&w.destroy(),w.emit("error",k)):(w.fd=R,w.emit("open",R),w.read())})}function x(w,k){return this instanceof x?(m.apply(this,arguments),this):x.apply(Object.create(x.prototype),arguments)}function T(){var w=this;ee(w.path,w.flags,w.mode,function(k,R){k?(w.destroy(),w.emit("error",k)):(w.fd=R,w.emit("open",R))})}function re(w,k){return new t.ReadStream(w,k)}function pe(w,k){return new t.WriteStream(w,k)}var oe=t.open;t.open=ee;function ee(w,k,R,ae){return typeof R=="function"&&(ae=R,R=null),J(w,k,R,ae);function J(de,U,B,M,P){return oe(de,U,B,function(F,be){F&&(F.code==="EMFILE"||F.code==="ENFILE")?Ur([J,[de,U,B,M],F,P||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}return t}function Ur(t){dr("ENQUEUE",t[0].name,t[1]),ce[Ie].push(t),Vo()}var Xi;function Fl(){for(var t=Date.now(),e=0;e<ce[Ie].length;++e)ce[Ie][e].length>2&&(ce[Ie][e][3]=t,ce[Ie][e][4]=t);Vo()}function Vo(){if(clearTimeout(Xi),Xi=void 0,ce[Ie].length!==0){var t=ce[Ie].shift(),e=t[0],r=t[1],n=t[2],i=t[3],s=t[4];if(i===void 0)dr("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-i>=6e4){dr("TIMEOUT",e.name,r);var o=r.pop();typeof o=="function"&&o.call(null,n)}else{var a=Date.now()-s,c=Math.max(s-i,1),l=Math.min(c*1.2,100);a>=l?(dr("RETRY",e.name,r),e.apply(null,r.concat([i]))):ce[Ie].push(t)}Xi===void 0&&(Xi=setTimeout(Vo,0))}}});var zo=p(hr=>{"use strict";var jl=Ye().fromCallback,ut=ye(),BE=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof ut[t]=="function");Object.keys(ut).forEach(t=>{t!=="promises"&&(hr[t]=ut[t])});BE.forEach(t=>{hr[t]=jl(ut[t])});hr.exists=function(t,e){return typeof e=="function"?ut.exists(t,e):new Promise(r=>ut.exists(t,r))};hr.read=function(t,e,r,n,i,s){return typeof s=="function"?ut.read(t,e,r,n,i,s):new Promise((o,a)=>{ut.read(t,e,r,n,i,(c,l,u)=>{if(c)return a(c);o({bytesRead:l,buffer:u})})})};hr.write=function(t,e,...r){return typeof r[r.length-1]=="function"?ut.write(t,e,...r):new Promise((n,i)=>{ut.write(t,e,...r,(s,o,a)=>{if(s)return i(s);n({bytesWritten:o,buffer:a})})})};typeof ut.realpath.native=="function"&&(hr.realpath.native=jl(ut.realpath.native))});var Qo=p((KA,Hl)=>{"use strict";var Xo=require("path");function $l(t){return t=Xo.normalize(Xo.resolve(t)).split(Xo.sep),t.length>0?t[0]:null}var GE=/[<>:"|?*]/;function VE(t){let e=$l(t);return t=t.replace(e,""),GE.test(t)}Hl.exports={getRootPath:$l,invalidWin32Path:VE}});var Bl=p((JA,Ul)=>{"use strict";var WE=ye(),Yo=require("path"),zE=Qo().invalidWin32Path,XE=parseInt("0777",8);function Ko(t,e,r,n){if(typeof e=="function"?(r=e,e={}):(!e||typeof e!="object")&&(e={mode:e}),process.platform==="win32"&&zE(t)){let o=new Error(t+" contains invalid WIN32 path characters.");return o.code="EINVAL",r(o)}let i=e.mode,s=e.fs||WE;i===void 0&&(i=XE&~process.umask()),n||(n=null),r=r||function(){},t=Yo.resolve(t),s.mkdir(t,i,o=>{if(!o)return n=n||t,r(null,n);switch(o.code){case"ENOENT":if(Yo.dirname(t)===t)return r(o);Ko(Yo.dirname(t),e,(a,c)=>{a?r(a,c):Ko(t,e,r,c)});break;default:s.stat(t,(a,c)=>{a||!c.isDirectory()?r(o,n):r(null,n)});break}})}Ul.exports=Ko});var Vl=p((ZA,Gl)=>{"use strict";var QE=ye(),Jo=require("path"),YE=Qo().invalidWin32Path,KE=parseInt("0777",8);function Zo(t,e,r){(!e||typeof e!="object")&&(e={mode:e});let n=e.mode,i=e.fs||QE;if(process.platform==="win32"&&YE(t)){let s=new Error(t+" contains invalid WIN32 path characters.");throw s.code="EINVAL",s}n===void 0&&(n=KE&~process.umask()),r||(r=null),t=Jo.resolve(t);try{i.mkdirSync(t,n),r=r||t}catch(s){if(s.code==="ENOENT"){if(Jo.dirname(t)===t)throw s;r=Zo(Jo.dirname(t),e,r),Zo(t,e,r)}else{let o;try{o=i.statSync(t)}catch{throw s}if(!o.isDirectory())throw s}}return r}Gl.exports=Zo});var tt=p((eO,Wl)=>{"use strict";var JE=Ye().fromCallback,ea=JE(Bl()),ta=Vl();Wl.exports={mkdirs:ea,mkdirsSync:ta,mkdirp:ea,mkdirpSync:ta,ensureDir:ea,ensureDirSync:ta}});var ra=p((tO,Xl)=>{"use strict";var Me=ye(),zl=require("os"),Yi=require("path");function ZE(){let t=Yi.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));t=Yi.join(zl.tmpdir(),t);let e=new Date(1435410243862);Me.writeFileSync(t,"https://github.com/jprichardson/node-fs-extra/pull/141");let r=Me.openSync(t,"r+");return Me.futimesSync(r,e,e),Me.closeSync(r),Me.statSync(t).mtime>1435410243e3}function ew(t){let e=Yi.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));e=Yi.join(zl.tmpdir(),e);let r=new Date(1435410243862);Me.writeFile(e,"https://github.com/jprichardson/node-fs-extra/pull/141",n=>{if(n)return t(n);Me.open(e,"r+",(i,s)=>{if(i)return t(i);Me.futimes(s,r,r,o=>{if(o)return t(o);Me.close(s,a=>{if(a)return t(a);Me.stat(e,(c,l)=>{if(c)return t(c);t(null,l.mtime>1435410243e3)})})})})})}function tw(t){if(typeof t=="number")return Math.floor(t/1e3)*1e3;if(t instanceof Date)return new Date(Math.floor(t.getTime()/1e3)*1e3);throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function rw(t,e,r,n){Me.open(t,"r+",(i,s)=>{if(i)return n(i);Me.futimes(s,e,r,o=>{Me.close(s,a=>{n&&n(o||a)})})})}function nw(t,e,r){let n=Me.openSync(t,"r+");return Me.futimesSync(n,e,r),Me.closeSync(n)}Xl.exports={hasMillisRes:ew,hasMillisResSync:ZE,timeRemoveMillis:tw,utimesMillis:rw,utimesMillisSync:nw}});var Mn=p((rO,ef)=>{"use strict";var lt=ye(),Ke=require("path"),Ql=10,Yl=5,iw=0,ia=process.versions.node.split("."),Kl=Number.parseInt(ia[0],10),Jl=Number.parseInt(ia[1],10),sw=Number.parseInt(ia[2],10);function Ln(){if(Kl>Ql)return!0;if(Kl===Ql){if(Jl>Yl)return!0;if(Jl===Yl&&sw>=iw)return!0}return!1}function ow(t,e,r){Ln()?lt.stat(t,{bigint:!0},(n,i)=>{if(n)return r(n);lt.stat(e,{bigint:!0},(s,o)=>s?s.code==="ENOENT"?r(null,{srcStat:i,destStat:null}):r(s):r(null,{srcStat:i,destStat:o}))}):lt.stat(t,(n,i)=>{if(n)return r(n);lt.stat(e,(s,o)=>s?s.code==="ENOENT"?r(null,{srcStat:i,destStat:null}):r(s):r(null,{srcStat:i,destStat:o}))})}function aw(t,e){let r,n;Ln()?r=lt.statSync(t,{bigint:!0}):r=lt.statSync(t);try{Ln()?n=lt.statSync(e,{bigint:!0}):n=lt.statSync(e)}catch(i){if(i.code==="ENOENT")return{srcStat:r,destStat:null};throw i}return{srcStat:r,destStat:n}}function cw(t,e,r,n){ow(t,e,(i,s)=>{if(i)return n(i);let{srcStat:o,destStat:a}=s;return a&&a.ino&&a.dev&&a.ino===o.ino&&a.dev===o.dev?n(new Error("Source and destination must not be the same.")):o.isDirectory()&&sa(t,e)?n(new Error(Fn(t,e,r))):n(null,{srcStat:o,destStat:a})})}function uw(t,e,r){let{srcStat:n,destStat:i}=aw(t,e);if(i&&i.ino&&i.dev&&i.ino===n.ino&&i.dev===n.dev)throw new Error("Source and destination must not be the same.");if(n.isDirectory()&&sa(t,e))throw new Error(Fn(t,e,r));return{srcStat:n,destStat:i}}function na(t,e,r,n,i){let s=Ke.resolve(Ke.dirname(t)),o=Ke.resolve(Ke.dirname(r));if(o===s||o===Ke.parse(o).root)return i();Ln()?lt.stat(o,{bigint:!0},(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===e.ino&&c.dev===e.dev?i(new Error(Fn(t,r,n))):na(t,e,o,n,i)):lt.stat(o,(a,c)=>a?a.code==="ENOENT"?i():i(a):c.ino&&c.dev&&c.ino===e.ino&&c.dev===e.dev?i(new Error(Fn(t,r,n))):na(t,e,o,n,i))}function Zl(t,e,r,n){let i=Ke.resolve(Ke.dirname(t)),s=Ke.resolve(Ke.dirname(r));if(s===i||s===Ke.parse(s).root)return;let o;try{Ln()?o=lt.statSync(s,{bigint:!0}):o=lt.statSync(s)}catch(a){if(a.code==="ENOENT")return;throw a}if(o.ino&&o.dev&&o.ino===e.ino&&o.dev===e.dev)throw new Error(Fn(t,r,n));return Zl(t,e,s,n)}function sa(t,e){let r=Ke.resolve(t).split(Ke.sep).filter(i=>i),n=Ke.resolve(e).split(Ke.sep).filter(i=>i);return r.reduce((i,s,o)=>i&&n[o]===s,!0)}function Fn(t,e,r){return`Cannot ${r} '${t}' to a subdirectory of itself, '${e}'.`}ef.exports={checkPaths:cw,checkPathsSync:uw,checkParentPaths:na,checkParentPathsSync:Zl,isSrcSubdir:sa}});var rf=p((nO,tf)=>{"use strict";tf.exports=function(t){if(typeof Buffer.allocUnsafe=="function")try{return Buffer.allocUnsafe(t)}catch{return new Buffer(t)}return new Buffer(t)}});var cf=p((iO,af)=>{"use strict";var ne=ye(),jn=require("path"),lw=tt().mkdirsSync,fw=ra().utimesMillisSync,$n=Mn();function dw(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`);let{srcStat:n,destStat:i}=$n.checkPathsSync(t,e,"copy");return $n.checkParentPathsSync(t,n,e,"copy"),hw(i,t,e,r)}function hw(t,e,r,n){if(n.filter&&!n.filter(e,r))return;let i=jn.dirname(r);return ne.existsSync(i)||lw(i),nf(t,e,r,n)}function nf(t,e,r,n){if(!(n.filter&&!n.filter(e,r)))return pw(t,e,r,n)}function pw(t,e,r,n){let s=(n.dereference?ne.statSync:ne.lstatSync)(e);if(s.isDirectory())return yw(s,t,e,r,n);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return mw(s,t,e,r,n);if(s.isSymbolicLink())return ww(t,e,r,n)}function mw(t,e,r,n,i){return e?gw(t,r,n,i):sf(t,r,n,i)}function gw(t,e,r,n){if(n.overwrite)return ne.unlinkSync(r),sf(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function sf(t,e,r,n){return typeof ne.copyFileSync=="function"?(ne.copyFileSync(e,r),ne.chmodSync(r,t.mode),n.preserveTimestamps?fw(r,t.atime,t.mtime):void 0):vw(t,e,r,n)}function vw(t,e,r,n){let s=rf()(65536),o=ne.openSync(e,"r"),a=ne.openSync(r,"w",t.mode),c=0;for(;c<t.size;){let l=ne.readSync(o,s,0,65536,c);ne.writeSync(a,s,0,l),c+=l}n.preserveTimestamps&&ne.futimesSync(a,t.atime,t.mtime),ne.closeSync(o),ne.closeSync(a)}function yw(t,e,r,n,i){if(!e)return _w(t,r,n,i);if(e&&!e.isDirectory())throw new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`);return of(r,n,i)}function _w(t,e,r,n){return ne.mkdirSync(r),of(e,r,n),ne.chmodSync(r,t.mode)}function of(t,e,r){ne.readdirSync(t).forEach(n=>Ew(n,t,e,r))}function Ew(t,e,r,n){let i=jn.join(e,t),s=jn.join(r,t),{destStat:o}=$n.checkPathsSync(i,s,"copy");return nf(o,i,s,n)}function ww(t,e,r,n){let i=ne.readlinkSync(e);if(n.dereference&&(i=jn.resolve(process.cwd(),i)),t){let s;try{s=ne.readlinkSync(r)}catch(o){if(o.code==="EINVAL"||o.code==="UNKNOWN")return ne.symlinkSync(i,r);throw o}if(n.dereference&&(s=jn.resolve(process.cwd(),s)),$n.isSrcSubdir(i,s))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${s}'.`);if(ne.statSync(r).isDirectory()&&$n.isSrcSubdir(s,i))throw new Error(`Cannot overwrite '${s}' with '${i}'.`);return Cw(i,r)}else return ne.symlinkSync(i,r)}function Cw(t,e){return ne.unlinkSync(e),ne.symlinkSync(t,e)}af.exports=dw});var oa=p((sO,uf)=>{"use strict";uf.exports={copySync:cf()}});var bt=p((oO,ff)=>{"use strict";var xw=Ye().fromPromise,lf=zo();function Tw(t){return lf.access(t).then(()=>!0).catch(()=>!1)}ff.exports={pathExists:xw(Tw),pathExistsSync:lf.existsSync}});var Ef=p((aO,_f)=>{"use strict";var Re=ye(),Hn=require("path"),Sw=tt().mkdirs,bw=bt().pathExists,Iw=ra().utimesMillis,Un=Mn();function Rw(t,e,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`),Un.checkPaths(t,e,"copy",(i,s)=>{if(i)return n(i);let{srcStat:o,destStat:a}=s;Un.checkParentPaths(t,o,e,"copy",c=>c?n(c):r.filter?pf(df,a,t,e,r,n):df(a,t,e,r,n))})}function df(t,e,r,n,i){let s=Hn.dirname(r);bw(s,(o,a)=>{if(o)return i(o);if(a)return aa(t,e,r,n,i);Sw(s,c=>c?i(c):aa(t,e,r,n,i))})}function pf(t,e,r,n,i,s){Promise.resolve(i.filter(r,n)).then(o=>o?t(e,r,n,i,s):s(),o=>s(o))}function aa(t,e,r,n,i){return n.filter?pf(hf,t,e,r,n,i):hf(t,e,r,n,i)}function hf(t,e,r,n,i){(n.dereference?Re.stat:Re.lstat)(e,(o,a)=>{if(o)return i(o);if(a.isDirectory())return Dw(a,t,e,r,n,i);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return Aw(a,t,e,r,n,i);if(a.isSymbolicLink())return Nw(t,e,r,n,i)})}function Aw(t,e,r,n,i,s){return e?Ow(t,r,n,i,s):mf(t,r,n,i,s)}function Ow(t,e,r,n,i){if(n.overwrite)Re.unlink(r,s=>s?i(s):mf(t,e,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function mf(t,e,r,n,i){return typeof Re.copyFile=="function"?Re.copyFile(e,r,s=>s?i(s):gf(t,r,n,i)):kw(t,e,r,n,i)}function kw(t,e,r,n,i){let s=Re.createReadStream(e);s.on("error",o=>i(o)).once("open",()=>{let o=Re.createWriteStream(r,{mode:t.mode});o.on("error",a=>i(a)).on("open",()=>s.pipe(o)).once("close",()=>gf(t,r,n,i))})}function gf(t,e,r,n){Re.chmod(e,t.mode,i=>i?n(i):r.preserveTimestamps?Iw(e,t.atime,t.mtime,n):n())}function Dw(t,e,r,n,i,s){return e?e&&!e.isDirectory()?s(new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`)):vf(r,n,i,s):Pw(t,r,n,i,s)}function Pw(t,e,r,n,i){Re.mkdir(r,s=>{if(s)return i(s);vf(e,r,n,o=>o?i(o):Re.chmod(r,t.mode,i))})}function vf(t,e,r,n){Re.readdir(t,(i,s)=>i?n(i):yf(s,t,e,r,n))}function yf(t,e,r,n,i){let s=t.pop();return s?qw(t,s,e,r,n,i):i()}function qw(t,e,r,n,i,s){let o=Hn.join(r,e),a=Hn.join(n,e);Un.checkPaths(o,a,"copy",(c,l)=>{if(c)return s(c);let{destStat:u}=l;aa(u,o,a,i,f=>f?s(f):yf(t,r,n,i,s))})}function Nw(t,e,r,n,i){Re.readlink(e,(s,o)=>{if(s)return i(s);if(n.dereference&&(o=Hn.resolve(process.cwd(),o)),t)Re.readlink(r,(a,c)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Re.symlink(o,r,i):i(a):(n.dereference&&(c=Hn.resolve(process.cwd(),c)),Un.isSrcSubdir(o,c)?i(new Error(`Cannot copy '${o}' to a subdirectory of itself, '${c}'.`)):t.isDirectory()&&Un.isSrcSubdir(c,o)?i(new Error(`Cannot overwrite '${c}' with '${o}'.`)):Lw(o,r,i)));else return Re.symlink(o,r,i)})}function Lw(t,e,r){Re.unlink(e,n=>n?r(n):Re.symlink(t,e,r))}_f.exports=Rw});var ca=p((cO,wf)=>{"use strict";var Fw=Ye().fromCallback;wf.exports={copy:Fw(Ef())}});var Of=p((uO,Af)=>{"use strict";var Cf=ye(),bf=require("path"),j=require("assert"),Bn=process.platform==="win32";function If(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||Cf[r],r=r+"Sync",t[r]=t[r]||Cf[r]}),t.maxBusyTries=t.maxBusyTries||3}function ua(t,e,r){let n=0;typeof e=="function"&&(r=e,e={}),j(t,"rimraf: missing path"),j.strictEqual(typeof t,"string","rimraf: path should be a string"),j.strictEqual(typeof r,"function","rimraf: callback function required"),j(e,"rimraf: invalid options argument provided"),j.strictEqual(typeof e,"object","rimraf: options should be object"),If(e),xf(t,e,function i(s){if(s){if((s.code==="EBUSY"||s.code==="ENOTEMPTY"||s.code==="EPERM")&&n<e.maxBusyTries){n++;let o=n*100;return setTimeout(()=>xf(t,e,i),o)}s.code==="ENOENT"&&(s=null)}r(s)})}function xf(t,e,r){j(t),j(e),j(typeof r=="function"),e.lstat(t,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Bn)return Tf(t,e,n,r);if(i&&i.isDirectory())return Ki(t,e,n,r);e.unlink(t,s=>{if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return Bn?Tf(t,e,s,r):Ki(t,e,s,r);if(s.code==="EISDIR")return Ki(t,e,s,r)}return r(s)})})}function Tf(t,e,r,n){j(t),j(e),j(typeof n=="function"),r&&j(r instanceof Error),e.chmod(t,438,i=>{i?n(i.code==="ENOENT"?null:r):e.stat(t,(s,o)=>{s?n(s.code==="ENOENT"?null:r):o.isDirectory()?Ki(t,e,r,n):e.unlink(t,n)})})}function Sf(t,e,r){let n;j(t),j(e),r&&j(r instanceof Error);try{e.chmodSync(t,438)}catch(i){if(i.code==="ENOENT")return;throw r}try{n=e.statSync(t)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?Ji(t,e,r):e.unlinkSync(t)}function Ki(t,e,r,n){j(t),j(e),r&&j(r instanceof Error),j(typeof n=="function"),e.rmdir(t,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Mw(t,e,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function Mw(t,e,r){j(t),j(e),j(typeof r=="function"),e.readdir(t,(n,i)=>{if(n)return r(n);let s=i.length,o;if(s===0)return e.rmdir(t,r);i.forEach(a=>{ua(bf.join(t,a),e,c=>{if(!o){if(c)return r(o=c);--s===0&&e.rmdir(t,r)}})})})}function Rf(t,e){let r;e=e||{},If(e),j(t,"rimraf: missing path"),j.strictEqual(typeof t,"string","rimraf: path should be a string"),j(e,"rimraf: missing options"),j.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&Bn&&Sf(t,e,n)}try{r&&r.isDirectory()?Ji(t,e,null):e.unlinkSync(t)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return Bn?Sf(t,e,n):Ji(t,e,n);if(n.code!=="EISDIR")throw n;Ji(t,e,n)}}function Ji(t,e,r){j(t),j(e),r&&j(r instanceof Error);try{e.rmdirSync(t)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")jw(t,e);else if(n.code!=="ENOENT")throw n}}function jw(t,e){if(j(t),j(e),e.readdirSync(t).forEach(r=>Rf(bf.join(t,r),e)),Bn){let r=Date.now();do try{return e.rmdirSync(t,e)}catch{}while(Date.now()-r<500)}else return e.rmdirSync(t,e)}Af.exports=ua;ua.sync=Rf});var Gn=p((lO,Df)=>{"use strict";var $w=Ye().fromCallback,kf=Of();Df.exports={remove:$w(kf),removeSync:kf.sync}});var $f=p((fO,jf)=>{"use strict";var Hw=Ye().fromCallback,Nf=ye(),Lf=require("path"),Ff=tt(),Mf=Gn(),Pf=Hw(function(e,r){r=r||function(){},Nf.readdir(e,(n,i)=>{if(n)return Ff.mkdirs(e,r);i=i.map(o=>Lf.join(e,o)),s();function s(){let o=i.pop();if(!o)return r();Mf.remove(o,a=>{if(a)return r(a);s()})}})});function qf(t){let e;try{e=Nf.readdirSync(t)}catch{return Ff.mkdirsSync(t)}e.forEach(r=>{r=Lf.join(t,r),Mf.removeSync(r)})}jf.exports={emptyDirSync:qf,emptydirSync:qf,emptyDir:Pf,emptydir:Pf}});var Gf=p((dO,Bf)=>{"use strict";var Uw=Ye().fromCallback,Hf=require("path"),Vn=ye(),Uf=tt(),Bw=bt().pathExists;function Gw(t,e){function r(){Vn.writeFile(t,"",n=>{if(n)return e(n);e()})}Vn.stat(t,(n,i)=>{if(!n&&i.isFile())return e();let s=Hf.dirname(t);Bw(s,(o,a)=>{if(o)return e(o);if(a)return r();Uf.mkdirs(s,c=>{if(c)return e(c);r()})})})}function Vw(t){let e;try{e=Vn.statSync(t)}catch{}if(e&&e.isFile())return;let r=Hf.dirname(t);Vn.existsSync(r)||Uf.mkdirsSync(r),Vn.writeFileSync(t,"")}Bf.exports={createFile:Uw(Gw),createFileSync:Vw}});var Qf=p((hO,Xf)=>{"use strict";var Ww=Ye().fromCallback,Wf=require("path"),pr=ye(),zf=tt(),Vf=bt().pathExists;function zw(t,e,r){function n(i,s){pr.link(i,s,o=>{if(o)return r(o);r(null)})}Vf(e,(i,s)=>{if(i)return r(i);if(s)return r(null);pr.lstat(t,o=>{if(o)return o.message=o.message.replace("lstat","ensureLink"),r(o);let a=Wf.dirname(e);Vf(a,(c,l)=>{if(c)return r(c);if(l)return n(t,e);zf.mkdirs(a,u=>{if(u)return r(u);n(t,e)})})})})}function Xw(t,e){if(pr.existsSync(e))return;try{pr.lstatSync(t)}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let n=Wf.dirname(e);return pr.existsSync(n)||zf.mkdirsSync(n),pr.linkSync(t,e)}Xf.exports={createLink:Ww(zw),createLinkSync:Xw}});var Kf=p((pO,Yf)=>{"use strict";var Xt=require("path"),Wn=ye(),Qw=bt().pathExists;function Yw(t,e,r){if(Xt.isAbsolute(t))return Wn.lstat(t,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:t,toDst:t}));{let n=Xt.dirname(e),i=Xt.join(n,t);return Qw(i,(s,o)=>s?r(s):o?r(null,{toCwd:i,toDst:t}):Wn.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:Xt.relative(n,t)})))}}function Kw(t,e){let r;if(Xt.isAbsolute(t)){if(r=Wn.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let n=Xt.dirname(e),i=Xt.join(n,t);if(r=Wn.existsSync(i),r)return{toCwd:i,toDst:t};if(r=Wn.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:Xt.relative(n,t)}}}Yf.exports={symlinkPaths:Yw,symlinkPathsSync:Kw}});var ed=p((mO,Zf)=>{"use strict";var Jf=ye();function Jw(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);Jf.lstat(t,(n,i)=>{if(n)return r(null,"file");e=i&&i.isDirectory()?"dir":"file",r(null,e)})}function Zw(t,e){let r;if(e)return e;try{r=Jf.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Zf.exports={symlinkType:Jw,symlinkTypeSync:Zw}});var ad=p((gO,od)=>{"use strict";var eC=Ye().fromCallback,rd=require("path"),Br=ye(),nd=tt(),tC=nd.mkdirs,rC=nd.mkdirsSync,id=Kf(),nC=id.symlinkPaths,iC=id.symlinkPathsSync,sd=ed(),sC=sd.symlinkType,oC=sd.symlinkTypeSync,td=bt().pathExists;function aC(t,e,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,td(e,(i,s)=>{if(i)return n(i);if(s)return n(null);nC(t,e,(o,a)=>{if(o)return n(o);t=a.toDst,sC(a.toCwd,r,(c,l)=>{if(c)return n(c);let u=rd.dirname(e);td(u,(f,d)=>{if(f)return n(f);if(d)return Br.symlink(t,e,l,n);tC(u,h=>{if(h)return n(h);Br.symlink(t,e,l,n)})})})})})}function cC(t,e,r){if(Br.existsSync(e))return;let i=iC(t,e);t=i.toDst,r=oC(i.toCwd,r);let s=rd.dirname(e);return Br.existsSync(s)||rC(s),Br.symlinkSync(t,e,r)}od.exports={createSymlink:eC(aC),createSymlinkSync:cC}});var ud=p((vO,cd)=>{"use strict";var Zi=Gf(),es=Qf(),ts=ad();cd.exports={createFile:Zi.createFile,createFileSync:Zi.createFileSync,ensureFile:Zi.createFile,ensureFileSync:Zi.createFileSync,createLink:es.createLink,createLinkSync:es.createLinkSync,ensureLink:es.createLink,ensureLinkSync:es.createLinkSync,createSymlink:ts.createSymlink,createSymlinkSync:ts.createSymlinkSync,ensureSymlink:ts.createSymlink,ensureSymlinkSync:ts.createSymlinkSync}});var hd=p((yO,dd)=>{var Gr;try{Gr=ye()}catch{Gr=require("fs")}function uC(t,e,r){r==null&&(r=e,e={}),typeof e=="string"&&(e={encoding:e}),e=e||{};var n=e.fs||Gr,i=!0;"throws"in e&&(i=e.throws),n.readFile(t,e,function(s,o){if(s)return r(s);o=fd(o);var a;try{a=JSON.parse(o,e?e.reviver:null)}catch(c){return i?(c.message=t+": "+c.message,r(c)):r(null,null)}r(null,a)})}function lC(t,e){e=e||{},typeof e=="string"&&(e={encoding:e});var r=e.fs||Gr,n=!0;"throws"in e&&(n=e.throws);try{var i=r.readFileSync(t,e);return i=fd(i),JSON.parse(i,e.reviver)}catch(s){if(n)throw s.message=t+": "+s.message,s;return null}}function ld(t,e){var r,n=`
`;typeof e=="object"&&e!==null&&(e.spaces&&(r=e.spaces),e.EOL&&(n=e.EOL));var i=JSON.stringify(t,e?e.replacer:null,r);return i.replace(/\n/g,n)+n}function fC(t,e,r,n){n==null&&(n=r,r={}),r=r||{};var i=r.fs||Gr,s="";try{s=ld(e,r)}catch(o){n&&n(o,null);return}i.writeFile(t,s,r,n)}function dC(t,e,r){r=r||{};var n=r.fs||Gr,i=ld(e,r);return n.writeFileSync(t,i,r)}function fd(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t=t.replace(/^\uFEFF/,""),t}var hC={readFile:uC,readFileSync:lC,writeFile:fC,writeFileSync:dC};dd.exports=hC});var ns=p((_O,md)=>{"use strict";var pd=Ye().fromCallback,rs=hd();md.exports={readJson:pd(rs.readFile),readJsonSync:rs.readFileSync,writeJson:pd(rs.writeFile),writeJsonSync:rs.writeFileSync}});var yd=p((EO,vd)=>{"use strict";var pC=require("path"),mC=tt(),gC=bt().pathExists,gd=ns();function vC(t,e,r,n){typeof r=="function"&&(n=r,r={});let i=pC.dirname(t);gC(i,(s,o)=>{if(s)return n(s);if(o)return gd.writeJson(t,e,r,n);mC.mkdirs(i,a=>{if(a)return n(a);gd.writeJson(t,e,r,n)})})}vd.exports=vC});var Ed=p((wO,_d)=>{"use strict";var yC=ye(),_C=require("path"),EC=tt(),wC=ns();function CC(t,e,r){let n=_C.dirname(t);yC.existsSync(n)||EC.mkdirsSync(n),wC.writeJsonSync(t,e,r)}_d.exports=CC});var Cd=p((CO,wd)=>{"use strict";var xC=Ye().fromCallback,Be=ns();Be.outputJson=xC(yd());Be.outputJsonSync=Ed();Be.outputJSON=Be.outputJson;Be.outputJSONSync=Be.outputJsonSync;Be.writeJSON=Be.writeJson;Be.writeJSONSync=Be.writeJsonSync;Be.readJSON=Be.readJson;Be.readJSONSync=Be.readJsonSync;wd.exports=Be});var Rd=p((xO,Id)=>{"use strict";var Sd=ye(),TC=require("path"),SC=oa().copySync,bd=Gn().removeSync,bC=tt().mkdirpSync,xd=Mn();function IC(t,e,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i}=xd.checkPathsSync(t,e,"move");return xd.checkParentPathsSync(t,i,e,"move"),bC(TC.dirname(e)),RC(t,e,n)}function RC(t,e,r){if(r)return bd(e),Td(t,e,r);if(Sd.existsSync(e))throw new Error("dest already exists.");return Td(t,e,r)}function Td(t,e,r){try{Sd.renameSync(t,e)}catch(n){if(n.code!=="EXDEV")throw n;return AC(t,e,r)}}function AC(t,e,r){return SC(t,e,{overwrite:r,errorOnExist:!0}),bd(t)}Id.exports=IC});var Od=p((TO,Ad)=>{"use strict";Ad.exports={moveSync:Rd()}});var Nd=p((SO,qd)=>{"use strict";var OC=ye(),kC=require("path"),DC=ca().copy,Pd=Gn().remove,PC=tt().mkdirp,qC=bt().pathExists,kd=Mn();function NC(t,e,r,n){typeof r=="function"&&(n=r,r={});let i=r.overwrite||r.clobber||!1;kd.checkPaths(t,e,"move",(s,o)=>{if(s)return n(s);let{srcStat:a}=o;kd.checkParentPaths(t,a,e,"move",c=>{if(c)return n(c);PC(kC.dirname(e),l=>l?n(l):LC(t,e,i,n))})})}function LC(t,e,r,n){if(r)return Pd(e,i=>i?n(i):Dd(t,e,r,n));qC(e,(i,s)=>i?n(i):s?n(new Error("dest already exists.")):Dd(t,e,r,n))}function Dd(t,e,r,n){OC.rename(t,e,i=>i?i.code!=="EXDEV"?n(i):FC(t,e,r,n):n())}function FC(t,e,r,n){DC(t,e,{overwrite:r,errorOnExist:!0},s=>s?n(s):Pd(t,n))}qd.exports=NC});var Fd=p((bO,Ld)=>{"use strict";var MC=Ye().fromCallback;Ld.exports={move:MC(Nd())}});var Hd=p((IO,$d)=>{"use strict";var jC=Ye().fromCallback,zn=ye(),Md=require("path"),jd=tt(),$C=bt().pathExists;function HC(t,e,r,n){typeof r=="function"&&(n=r,r="utf8");let i=Md.dirname(t);$C(i,(s,o)=>{if(s)return n(s);if(o)return zn.writeFile(t,e,r,n);jd.mkdirs(i,a=>{if(a)return n(a);zn.writeFile(t,e,r,n)})})}function UC(t,...e){let r=Md.dirname(t);if(zn.existsSync(r))return zn.writeFileSync(t,...e);jd.mkdirsSync(r),zn.writeFileSync(t,...e)}$d.exports={outputFile:jC(HC),outputFileSync:UC}});var fa=p((RO,la)=>{"use strict";la.exports=Object.assign({},zo(),oa(),ca(),$f(),ud(),Cd(),tt(),Od(),Fd(),Hd(),bt(),Gn());var Ud=require("fs");Object.getOwnPropertyDescriptor(Ud,"promises")&&Object.defineProperty(la.exports,"promises",{get(){return Ud.promises}})});var zd=p((kO,Wd)=>{var{Transform:GC}=require("stream"),[da]=Buffer.from("\r"),[ha]=Buffer.from(`
`),Vd={escape:'"',headers:null,mapHeaders:({header:t})=>t,mapValues:({value:t})=>t,newline:`
`,quote:'"',raw:!1,separator:",",skipComments:!1,skipLines:null,maxRowBytes:Number.MAX_SAFE_INTEGER,strict:!1},pa=class extends GC{constructor(e={}){super({objectMode:!0,highWaterMark:16}),Array.isArray(e)&&(e={headers:e});let r=Object.assign({},Vd,e);r.customNewline=r.newline!==Vd.newline;for(let n of["newline","quote","separator"])typeof r[n]<"u"&&([r[n]]=Buffer.from(r[n]));r.escape=(e||{}).escape?Buffer.from(r.escape)[0]:r.quote,this.state={empty:r.raw?Buffer.alloc(0):"",escaped:!1,first:!0,lineNumber:0,previousEnd:0,rowLength:0,quoted:!1},this._prev=null,r.headers===!1&&(r.strict=!1),(r.headers||r.headers===!1)&&(this.state.first=!1),this.options=r,this.headers=r.headers}parseCell(e,r,n){let{escape:i,quote:s}=this.options;e[r]===s&&e[n-1]===s&&(r++,n--);let o=r;for(let a=r;a<n;a++)e[a]===i&&a+1<n&&e[a+1]===s&&a++,o!==a&&(e[o]=e[a]),o++;return this.parseValue(e,r,o)}parseLine(e,r,n){let{customNewline:i,escape:s,mapHeaders:o,mapValues:a,quote:c,separator:l,skipComments:u,skipLines:f}=this.options;n--,!i&&e.length&&e[n-1]===da&&n--;let d=l,h=[],m=!1,v=r;if(u){let E=typeof u=="string"?u:"#";if(e[r]===Buffer.from(E)[0])return}let g=E=>{if(this.state.first)return E;let x=h.length,T=this.headers[x];return a({header:T,index:x,value:E})};for(let E=r;E<n;E++){let x=!m&&e[E]===c,T=m&&e[E]===c&&E+1<=n&&e[E+1]===d,re=m&&e[E]===s&&E+1<n&&e[E+1]===c;if(x||T){m=!m;continue}else if(re){E++;continue}if(e[E]===d&&!m){let pe=this.parseCell(e,v,E);pe=g(pe),h.push(pe),v=E+1}}if(v<n){let E=this.parseCell(e,v,n);E=g(E),h.push(E)}e[n-1]===d&&h.push(g(this.state.empty));let y=f&&f>this.state.lineNumber;if(this.state.lineNumber++,this.state.first&&!y){this.state.first=!1,this.headers=h.map((E,x)=>o({header:E,index:x})),this.emit("headers",this.headers);return}if(!y&&this.options.strict&&h.length!==this.headers.length){let E=new RangeError("Row length does not match headers");this.emit("error",E)}else y||this.writeRow(h)}parseValue(e,r,n){return this.options.raw?e.slice(r,n):e.toString("utf-8",r,n)}writeRow(e){(this.headers===!1||e.length>this.headers.length)&&(this.headers=e.map((n,i)=>i));let r=e.reduce((n,i,s)=>{let o=this.headers[s];return o!==null&&(n[o]=i),n},{});this.push(r)}_flush(e){if(this.state.escaped||!this._prev)return e();this.parseLine(this._prev,this.state.previousEnd,this._prev.length+1),e()}_transform(e,r,n){typeof e=="string"&&(e=Buffer.from(e));let{escape:i,quote:s}=this.options,o=0,a=e;this._prev&&(o=this._prev.length,a=Buffer.concat([this._prev,e]),this._prev=null);let c=a.length;for(let l=o;l<c;l++){let u=a[l],f=l+1<c?a[l+1]:null;if(this.state.rowLength++,this.state.rowLength>this.options.maxRowBytes)return n(new Error("Row exceeds the maximum size"));if(!this.state.escaped&&u===i&&f===s&&l!==o){this.state.escaped=!0;continue}else if(u===s){this.state.escaped?this.state.escaped=!1:this.state.quoted=!this.state.quoted;continue}this.state.quoted||(this.state.first&&!this.options.customNewline&&(u===ha?this.options.newline=ha:u===da&&f!==ha&&(this.options.newline=da)),u===this.options.newline&&(this.parseLine(a,this.state.previousEnd,l+1),this.state.previousEnd=l+1,this.state.rowLength=0))}if(this.state.previousEnd===c)return this.state.previousEnd=0,n();if(c-this.state.previousEnd<e.length)return this._prev=e,this.state.previousEnd-=c-e.length,n();this._prev=a,n()}};Wd.exports=t=>new pa(t)});var ga=p((FO,th)=>{"use strict";th.exports=function(e,r){return function(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return e.apply(r,i)}}});var Ve=p((MO,ih)=>{"use strict";var zC=ga(),gr=Object.prototype.toString;function _a(t){return gr.call(t)==="[object Array]"}function va(t){return typeof t>"u"}function XC(t){return t!==null&&!va(t)&&t.constructor!==null&&!va(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function QC(t){return gr.call(t)==="[object ArrayBuffer]"}function YC(t){return typeof FormData<"u"&&t instanceof FormData}function KC(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function JC(t){return typeof t=="string"}function ZC(t){return typeof t=="number"}function rh(t){return t!==null&&typeof t=="object"}function us(t){if(gr.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function ex(t){return gr.call(t)==="[object Date]"}function tx(t){return gr.call(t)==="[object File]"}function rx(t){return gr.call(t)==="[object Blob]"}function nh(t){return gr.call(t)==="[object Function]"}function nx(t){return rh(t)&&nh(t.pipe)}function ix(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}function sx(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function ox(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Ea(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),_a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function ya(){var t={};function e(i,s){us(t[s])&&us(i)?t[s]=ya(t[s],i):us(i)?t[s]=ya({},i):_a(i)?t[s]=i.slice():t[s]=i}for(var r=0,n=arguments.length;r<n;r++)Ea(arguments[r],e);return t}function ax(t,e,r){return Ea(e,function(i,s){r&&typeof i=="function"?t[s]=zC(i,r):t[s]=i}),t}function cx(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}ih.exports={isArray:_a,isArrayBuffer:QC,isBuffer:XC,isFormData:YC,isArrayBufferView:KC,isString:JC,isNumber:ZC,isObject:rh,isPlainObject:us,isUndefined:va,isDate:ex,isFile:tx,isBlob:rx,isFunction:nh,isStream:nx,isURLSearchParams:ix,isStandardBrowserEnv:ox,forEach:Ea,merge:ya,extend:ax,trim:sx,stripBOM:cx}});var ls=p((jO,oh)=>{"use strict";var Wr=Ve();function sh(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}oh.exports=function(e,r,n){if(!r)return e;var i;if(n)i=n(r);else if(Wr.isURLSearchParams(r))i=r.toString();else{var s=[];Wr.forEach(r,function(c,l){c===null||typeof c>"u"||(Wr.isArray(c)?l=l+"[]":c=[c],Wr.forEach(c,function(f){Wr.isDate(f)?f=f.toISOString():Wr.isObject(f)&&(f=JSON.stringify(f)),s.push(sh(l)+"="+sh(f))}))}),i=s.join("&")}if(i){var o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}});var ch=p(($O,ah)=>{"use strict";var ux=Ve();function fs(){this.handlers=[]}fs.prototype.use=function(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};fs.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};fs.prototype.forEach=function(e){ux.forEach(this.handlers,function(n){n!==null&&e(n)})};ah.exports=fs});var lh=p((HO,uh)=>{"use strict";var lx=Ve();uh.exports=function(e,r){lx.forEach(e,function(i,s){s!==r&&s.toUpperCase()===r.toUpperCase()&&(e[r]=i,delete e[s])})}});var ds=p((UO,fh)=>{"use strict";fh.exports=function(e,r,n,i,s){return e.config=r,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}});var hs=p((BO,dh)=>{"use strict";var fx=ds();dh.exports=function(e,r,n,i,s){var o=new Error(e);return fx(o,r,n,i,s)}});var wa=p((GO,hh)=>{"use strict";var dx=hs();hh.exports=function(e,r,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?e(n):r(dx("Request failed with status code "+n.status,n.config,null,n.request,n))}});var mh=p((VO,ph)=>{"use strict";var ps=Ve();ph.exports=ps.isStandardBrowserEnv()?function(){return{write:function(r,n,i,s,o,a){var c=[];c.push(r+"="+encodeURIComponent(n)),ps.isNumber(i)&&c.push("expires="+new Date(i).toGMTString()),ps.isString(s)&&c.push("path="+s),ps.isString(o)&&c.push("domain="+o),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var vh=p((WO,gh)=>{"use strict";gh.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}});var _h=p((zO,yh)=>{"use strict";yh.exports=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e}});var Ca=p((XO,Eh)=>{"use strict";var hx=vh(),px=_h();Eh.exports=function(e,r){return e&&!hx(r)?px(e,r):r}});var Ch=p((QO,wh)=>{"use strict";var xa=Ve(),mx=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];wh.exports=function(e){var r={},n,i,s;return e&&xa.forEach(e.split(`
`),function(a){if(s=a.indexOf(":"),n=xa.trim(a.substr(0,s)).toLowerCase(),i=xa.trim(a.substr(s+1)),n){if(r[n]&&mx.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([i]):r[n]=r[n]?r[n]+", "+i:i}}),r}});var Sh=p((YO,Th)=>{"use strict";var xh=Ve();Th.exports=xh.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function i(s){var o=s;return e&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=i(window.location.href),function(o){var a=xh.isString(o)?i(o):o;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}()});var zr=p((KO,bh)=>{"use strict";function Ta(t){this.message=t}Ta.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Ta.prototype.__CANCEL__=!0;bh.exports=Ta});var Rh=p((JO,Ih)=>{"use strict";var ms=Ve(),gx=wa(),vx=mh(),yx=ls(),_x=Ca(),Ex=Ch(),wx=Sh(),Sa=hs(),Cx=Xr(),xx=zr();Ih.exports=function(e){return new Promise(function(n,i){var s=e.data,o=e.headers,a=e.responseType,c;function l(){e.cancelToken&&e.cancelToken.unsubscribe(c),e.signal&&e.signal.removeEventListener("abort",c)}ms.isFormData(s)&&delete o["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",d=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(f+":"+d)}var h=_x(e.baseURL,e.url);u.open(e.method.toUpperCase(),yx(h,e.params,e.paramsSerializer),!0),u.timeout=e.timeout;function m(){if(!!u){var g="getAllResponseHeaders"in u?Ex(u.getAllResponseHeaders()):null,y=!a||a==="text"||a==="json"?u.responseText:u.response,E={data:y,status:u.status,statusText:u.statusText,headers:g,config:e,request:u};gx(function(T){n(T),l()},function(T){i(T),l()},E),u=null}}if("onloadend"in u?u.onloadend=m:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(m)},u.onabort=function(){!u||(i(Sa("Request aborted",e,"ECONNABORTED",u)),u=null)},u.onerror=function(){i(Sa("Network Error",e,null,u)),u=null},u.ontimeout=function(){var y=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",E=e.transitional||Cx.transitional;e.timeoutErrorMessage&&(y=e.timeoutErrorMessage),i(Sa(y,e,E.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",u)),u=null},ms.isStandardBrowserEnv()){var v=(e.withCredentials||wx(h))&&e.xsrfCookieName?vx.read(e.xsrfCookieName):void 0;v&&(o[e.xsrfHeaderName]=v)}"setRequestHeader"in u&&ms.forEach(o,function(y,E){typeof s>"u"&&E.toLowerCase()==="content-type"?delete o[E]:u.setRequestHeader(E,y)}),ms.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),a&&a!=="json"&&(u.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&u.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(c=function(g){!u||(i(!g||g&&g.type?new xx("canceled"):g),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(c),e.signal&&(e.signal.aborted?c():e.signal.addEventListener("abort",c))),s||(s=null),u.send(s)})}});var Oh=p((ZO,Ah)=>{var Qr=1e3,Yr=Qr*60,Kr=Yr*60,vr=Kr*24,Tx=vr*7,Sx=vr*365.25;Ah.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return bx(t);if(r==="number"&&isFinite(t))return e.long?Rx(t):Ix(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function bx(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Sx;case"weeks":case"week":case"w":return r*Tx;case"days":case"day":case"d":return r*vr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Kr;case"minutes":case"minute":case"mins":case"min":case"m":return r*Yr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Qr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Ix(t){var e=Math.abs(t);return e>=vr?Math.round(t/vr)+"d":e>=Kr?Math.round(t/Kr)+"h":e>=Yr?Math.round(t/Yr)+"m":e>=Qr?Math.round(t/Qr)+"s":t+"ms"}function Rx(t){var e=Math.abs(t);return e>=vr?gs(t,e,vr,"day"):e>=Kr?gs(t,e,Kr,"hour"):e>=Yr?gs(t,e,Yr,"minute"):e>=Qr?gs(t,e,Qr,"second"):t+" ms"}function gs(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var ba=p((ek,kh)=>{function Ax(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=Oh(),r.destroy=l,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let f=0;for(let d=0;d<u.length;d++)f=(f<<5)-f+u.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(u){let f,d=null,h,m;function v(...g){if(!v.enabled)return;let y=v,E=Number(new Date),x=E-(f||E);y.diff=x,y.prev=f,y.curr=E,f=E,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let T=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(pe,oe)=>{if(pe==="%%")return"%";T++;let ee=r.formatters[oe];if(typeof ee=="function"){let w=g[T];pe=ee.call(y,w),g.splice(T,1),T--}return pe}),r.formatArgs.call(y,g),(y.log||r.log).apply(y,g)}return v.namespace=u,v.useColors=r.useColors(),v.color=r.selectColor(u),v.extend=n,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(h!==r.namespaces&&(h=r.namespaces,m=r.enabled(u)),m),set:g=>{d=g}}),typeof r.init=="function"&&r.init(v),v}function n(u,f){let d=r(this.namespace+(typeof f>"u"?":":f)+u);return d.log=this.log,d}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let f,d=(typeof u=="string"?u:"").split(/[\s,]+/),h=d.length;for(f=0;f<h;f++)!d[f]||(u=d[f].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(u))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}kh.exports=Ax});var Dh=p((rt,vs)=>{rt.formatArgs=kx;rt.save=Dx;rt.load=Px;rt.useColors=Ox;rt.storage=qx();rt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();rt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Ox(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function kx(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+vs.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}rt.log=console.debug||console.log||(()=>{});function Dx(t){try{t?rt.storage.setItem("debug",t):rt.storage.removeItem("debug")}catch{}}function Px(){let t;try{t=rt.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function qx(){try{return localStorage}catch{}}vs.exports=ba()(rt);var{formatters:Nx}=vs.exports;Nx.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var qh=p((tk,Ph)=>{"use strict";Ph.exports=(t,e)=>{e=e||process.argv;let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),i=e.indexOf("--");return n!==-1&&(i===-1?!0:n<i)}});var Lh=p((rk,Nh)=>{"use strict";var Lx=require("os"),yt=qh(),{env:_e}=process,Qt;yt("no-color")||yt("no-colors")||yt("color=false")?Qt=0:(yt("color")||yt("colors")||yt("color=true")||yt("color=always"))&&(Qt=1);"FORCE_COLOR"in _e&&(_e.FORCE_COLOR===!0||_e.FORCE_COLOR==="true"?Qt=1:_e.FORCE_COLOR===!1||_e.FORCE_COLOR==="false"?Qt=0:Qt=_e.FORCE_COLOR.length===0?1:Math.min(parseInt(_e.FORCE_COLOR,10),3));function Fx(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Mx(t){if(Qt===0)return 0;if(yt("color=16m")||yt("color=full")||yt("color=truecolor"))return 3;if(yt("color=256"))return 2;if(t&&!t.isTTY&&Qt===void 0)return 0;let e=Qt||0;if(_e.TERM==="dumb")return e;if(process.platform==="win32"){let r=Lx.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in _e)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in _e)||_e.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in _e)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(_e.TEAMCITY_VERSION)?1:0;if(_e.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in _e){let r=parseInt((_e.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(_e.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(_e.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(_e.TERM)||"COLORTERM"in _e?1:e}function Ia(t){let e=Mx(t);return Fx(e)}Nh.exports={supportsColor:Ia,stdout:Ia(process.stdout),stderr:Ia(process.stderr)}});var Mh=p((Oe,_s)=>{var jx=require("tty"),ys=require("util");Oe.init=Wx;Oe.log=Bx;Oe.formatArgs=Hx;Oe.save=Gx;Oe.load=Vx;Oe.useColors=$x;Oe.destroy=ys.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Oe.colors=[6,2,3,4,5,1];try{let t=Lh();t&&(t.stderr||t).level>=2&&(Oe.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Oe.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function $x(){return"colors"in Oe.inspectOpts?Boolean(Oe.inspectOpts.colors):jx.isatty(process.stderr.fd)}function Hx(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${i};1m${e} \x1B[0m`;t[0]=s+t[0].split(`
`).join(`
`+s),t.push(i+"m+"+_s.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Ux()+e+" "+t[0]}function Ux(){return Oe.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Bx(...t){return process.stderr.write(ys.format(...t)+`
`)}function Gx(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function Vx(){return process.env.DEBUG}function Wx(t){t.inspectOpts={};let e=Object.keys(Oe.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Oe.inspectOpts[e[r]]}_s.exports=ba()(Oe);var{formatters:Fh}=_s.exports;Fh.o=function(t){return this.inspectOpts.colors=this.useColors,ys.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Fh.O=function(t){return this.inspectOpts.colors=this.useColors,ys.inspect(t,this.inspectOpts)}});var jh=p((nk,Ra)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Ra.exports=Dh():Ra.exports=Mh()});var Hh=p((ik,$h)=>{var Qn;$h.exports=function(){if(!Qn){try{Qn=jh()("follow-redirects")}catch{}typeof Qn!="function"&&(Qn=function(){})}Qn.apply(null,arguments)}});var Pa=p((sk,Da)=>{var yr=require("url"),Aa=yr.URL,zx=require("http"),Xx=require("https"),Gh=require("stream").Writable,Qx=require("assert"),Vh=Hh(),_r=["abort","aborted","connect","error","socket","timeout"],ka=Object.create(null);_r.forEach(function(t){ka[t]=function(e,r,n){this._redirectable.emit(t,e,r,n)}});var Uh=Es("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),Yx=Es("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),Kx=Es("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),Jx=Es("ERR_STREAM_WRITE_AFTER_END","write after end");function nt(t,e){Gh.call(this),this._sanitizeOptions(t),this._options=t,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],e&&this.on("response",e);var r=this;this._onNativeResponse=function(n){r._processResponse(n)},this._performRequest()}nt.prototype=Object.create(Gh.prototype);nt.prototype.abort=function(){zh(this._currentRequest),this.emit("abort")};nt.prototype.write=function(t,e,r){if(this._ending)throw new Jx;if(!(typeof t=="string"||typeof t=="object"&&"length"in t))throw new TypeError("data should be a string, Buffer or Uint8Array");if(typeof e=="function"&&(r=e,e=null),t.length===0){r&&r();return}this._requestBodyLength+t.length<=this._options.maxBodyLength?(this._requestBodyLength+=t.length,this._requestBodyBuffers.push({data:t,encoding:e}),this._currentRequest.write(t,e,r)):(this.emit("error",new Kx),this.abort())};nt.prototype.end=function(t,e,r){if(typeof t=="function"?(r=t,t=e=null):typeof e=="function"&&(r=e,e=null),!t)this._ended=this._ending=!0,this._currentRequest.end(null,null,r);else{var n=this,i=this._currentRequest;this.write(t,e,function(){n._ended=!0,i.end(null,null,r)}),this._ending=!0}};nt.prototype.setHeader=function(t,e){this._options.headers[t]=e,this._currentRequest.setHeader(t,e)};nt.prototype.removeHeader=function(t){delete this._options.headers[t],this._currentRequest.removeHeader(t)};nt.prototype.setTimeout=function(t,e){var r=this;function n(o){o.setTimeout(t),o.removeListener("timeout",o.destroy),o.addListener("timeout",o.destroy)}function i(o){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout(function(){r.emit("timeout"),s()},t),n(o)}function s(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",s),r.removeListener("error",s),r.removeListener("response",s),e&&r.removeListener("timeout",e),r.socket||r._currentRequest.removeListener("socket",i)}return e&&this.on("timeout",e),this.socket?i(this.socket):this._currentRequest.once("socket",i),this.on("socket",n),this.on("abort",s),this.on("error",s),this.on("response",s),this};["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(t){nt.prototype[t]=function(e,r){return this._currentRequest[t](e,r)}});["aborted","connection","socket"].forEach(function(t){Object.defineProperty(nt.prototype,t,{get:function(){return this._currentRequest[t]}})});nt.prototype._sanitizeOptions=function(t){if(t.headers||(t.headers={}),t.host&&(t.hostname||(t.hostname=t.host),delete t.host),!t.pathname&&t.path){var e=t.path.indexOf("?");e<0?t.pathname=t.path:(t.pathname=t.path.substring(0,e),t.search=t.path.substring(e))}};nt.prototype._performRequest=function(){var t=this._options.protocol,e=this._options.nativeProtocols[t];if(!e){this.emit("error",new TypeError("Unsupported protocol "+t));return}if(this._options.agents){var r=t.substr(0,t.length-1);this._options.agent=this._options.agents[r]}var n=this._currentRequest=e.request(this._options,this._onNativeResponse);this._currentUrl=yr.format(this._options),n._redirectable=this;for(var i=0;i<_r.length;i++)n.on(_r[i],ka[_r[i]]);if(this._isRedirect){var s=0,o=this,a=this._requestBodyBuffers;(function c(l){if(n===o._currentRequest)if(l)o.emit("error",l);else if(s<a.length){var u=a[s++];n.finished||n.write(u.data,u.encoding,c)}else o._ended&&n.end()})()}};nt.prototype._processResponse=function(t){var e=t.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:t.headers,statusCode:e});var r=t.headers.location;if(!r||this._options.followRedirects===!1||e<300||e>=400){t.responseUrl=this._currentUrl,t.redirects=this._redirects,this.emit("response",t),this._requestBodyBuffers=[];return}if(zh(this._currentRequest),t.destroy(),++this._redirectCount>this._options.maxRedirects){this.emit("error",new Yx);return}((e===301||e===302)&&this._options.method==="POST"||e===303&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],Oa(/^content-/i,this._options.headers));var n=Oa(/^host$/i,this._options.headers),i=yr.parse(this._currentUrl),s=n||i.host,o=/^\w+:/.test(r)?this._currentUrl:yr.format(Object.assign(i,{host:s})),a;try{a=yr.resolve(o,r)}catch(u){this.emit("error",new Uh(u));return}Vh("redirecting to",a),this._isRedirect=!0;var c=yr.parse(a);if(Object.assign(this._options,c),(c.protocol!==i.protocol&&c.protocol!=="https:"||c.host!==s&&!e0(c.host,s))&&Oa(/^(?:authorization|cookie)$/i,this._options.headers),typeof this._options.beforeRedirect=="function"){var l={headers:t.headers};try{this._options.beforeRedirect.call(null,this._options,l)}catch(u){this.emit("error",u);return}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(u){this.emit("error",new Uh(u))}};function Wh(t){var e={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(t).forEach(function(n){var i=n+":",s=r[i]=t[n],o=e[n]=Object.create(s);function a(l,u,f){if(typeof l=="string"){var d=l;try{l=Bh(new Aa(d))}catch{l=yr.parse(d)}}else Aa&&l instanceof Aa?l=Bh(l):(f=u,u=l,l={protocol:i});return typeof u=="function"&&(f=u,u=null),u=Object.assign({maxRedirects:e.maxRedirects,maxBodyLength:e.maxBodyLength},l,u),u.nativeProtocols=r,Qx.equal(u.protocol,i,"protocol mismatch"),Vh("options",u),new nt(u,f)}function c(l,u,f){var d=o.request(l,u,f);return d.end(),d}Object.defineProperties(o,{request:{value:a,configurable:!0,enumerable:!0,writable:!0},get:{value:c,configurable:!0,enumerable:!0,writable:!0}})}),e}function Zx(){}function Bh(t){var e={protocol:t.protocol,hostname:t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,hash:t.hash,search:t.search,pathname:t.pathname,path:t.pathname+t.search,href:t.href};return t.port!==""&&(e.port=Number(t.port)),e}function Oa(t,e){var r;for(var n in e)t.test(n)&&(r=e[n],delete e[n]);return r===null||typeof r>"u"?void 0:String(r).trim()}function Es(t,e){function r(n){Error.captureStackTrace(this,this.constructor),n?(this.message=e+": "+n.message,this.cause=n):this.message=e}return r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="Error ["+t+"]",r.prototype.code=t,r}function zh(t){for(var e=0;e<_r.length;e++)t.removeListener(_r[e],ka[_r[e]]);t.on("error",Zx),t.abort()}function e0(t,e){let r=t.length-e.length-1;return r>0&&t[r]==="."&&t.endsWith(e)}Da.exports=Wh({http:zx,https:Xx});Da.exports.wrap=Wh});var ws=p((ok,Xh)=>{Xh.exports={version:"0.24.0"}});var ep=p((ak,Zh)=>{"use strict";var Yn=Ve(),Qh=wa(),t0=Ca(),r0=ls(),n0=require("http"),i0=require("https"),s0=Pa().http,o0=Pa().https,Yh=require("url"),a0=require("zlib"),c0=ws().version,Cs=hs(),qa=ds(),u0=Xr(),l0=zr(),Kh=/https:?/;function Jh(t,e,r){if(t.hostname=e.host,t.host=e.host,t.port=e.port,t.path=r,e.auth){var n=Buffer.from(e.auth.username+":"+e.auth.password,"utf8").toString("base64");t.headers["Proxy-Authorization"]="Basic "+n}t.beforeRedirect=function(s){s.headers.host=s.host,Jh(s,e,s.href)}}Zh.exports=function(e){return new Promise(function(n,i){var s;function o(){e.cancelToken&&e.cancelToken.unsubscribe(s),e.signal&&e.signal.removeEventListener("abort",s)}var a=function(L){o(),n(L)},c=function(L){o(),i(L)},l=e.data,u=e.headers,f={};if(Object.keys(u).forEach(function(L){f[L.toLowerCase()]=L}),"user-agent"in f?u[f["user-agent"]]||delete u[f["user-agent"]]:u["User-Agent"]="axios/"+c0,l&&!Yn.isStream(l)){if(!Buffer.isBuffer(l))if(Yn.isArrayBuffer(l))l=Buffer.from(new Uint8Array(l));else if(Yn.isString(l))l=Buffer.from(l,"utf-8");else return c(Cs("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));f["content-length"]||(u["Content-Length"]=l.length)}var d=void 0;if(e.auth){var h=e.auth.username||"",m=e.auth.password||"";d=h+":"+m}var v=t0(e.baseURL,e.url),g=Yh.parse(v),y=g.protocol||"http:";if(!d&&g.auth){var E=g.auth.split(":"),x=E[0]||"",T=E[1]||"";d=x+":"+T}d&&f.authorization&&delete u[f.authorization];var re=Kh.test(y),pe=re?e.httpsAgent:e.httpAgent,oe={path:r0(g.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:u,agent:pe,agents:{http:e.httpAgent,https:e.httpsAgent},auth:d};e.socketPath?oe.socketPath=e.socketPath:(oe.hostname=g.hostname,oe.port=g.port);var ee=e.proxy;if(!ee&&ee!==!1){var w=y.slice(0,-1)+"_proxy",k=process.env[w]||process.env[w.toUpperCase()];if(k){var R=Yh.parse(k),ae=process.env.no_proxy||process.env.NO_PROXY,J=!0;if(ae){var de=ae.split(",").map(function(L){return L.trim()});J=!de.some(function(L){return L?L==="*"||L[0]==="."&&g.hostname.substr(g.hostname.length-L.length)===L?!0:g.hostname===L:!1})}if(J&&(ee={host:R.hostname,port:R.port,protocol:R.protocol},R.auth)){var U=R.auth.split(":");ee.auth={username:U[0],password:U[1]}}}}ee&&(oe.headers.host=g.hostname+(g.port?":"+g.port:""),Jh(oe,ee,y+"//"+g.hostname+(g.port?":"+g.port:"")+oe.path));var B,M=re&&(ee?Kh.test(ee.protocol):!0);e.transport?B=e.transport:e.maxRedirects===0?B=M?i0:n0:(e.maxRedirects&&(oe.maxRedirects=e.maxRedirects),B=M?o0:s0),e.maxBodyLength>-1&&(oe.maxBodyLength=e.maxBodyLength),e.insecureHTTPParser&&(oe.insecureHTTPParser=e.insecureHTTPParser);var P=B.request(oe,function(L){if(!P.aborted){var vt=L,$i=L.req||P;if(L.statusCode!==204&&$i.method!=="HEAD"&&e.decompress!==!1)switch(L.headers["content-encoding"]){case"gzip":case"compress":case"deflate":vt=vt.pipe(a0.createUnzip()),delete L.headers["content-encoding"];break}var Hi={status:L.statusCode,statusText:L.statusMessage,headers:L.headers,config:e,request:$i};if(e.responseType==="stream")Hi.data=vt,Qh(a,c,Hi);else{var wl=[],Cl=0;vt.on("data",function(St){wl.push(St),Cl+=St.length,e.maxContentLength>-1&&Cl>e.maxContentLength&&(vt.destroy(),c(Cs("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,$i)))}),vt.on("error",function(St){P.aborted||c(qa(St,e,null,$i))}),vt.on("end",function(){var St=Buffer.concat(wl);e.responseType!=="arraybuffer"&&(St=St.toString(e.responseEncoding),(!e.responseEncoding||e.responseEncoding==="utf8")&&(St=Yn.stripBOM(St))),Hi.data=St,Qh(a,c,Hi)})}}});if(P.on("error",function(L){P.aborted&&L.code!=="ERR_FR_TOO_MANY_REDIRECTS"||c(qa(L,e,null,P))}),e.timeout){var F=parseInt(e.timeout,10);if(isNaN(F)){c(Cs("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",P));return}P.setTimeout(F,function(){P.abort();var L=e.transitional||u0.transitional;c(Cs("timeout of "+F+"ms exceeded",e,L.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",P))})}(e.cancelToken||e.signal)&&(s=function(be){P.aborted||(P.abort(),c(!be||be&&be.type?new l0("canceled"):be))},e.cancelToken&&e.cancelToken.subscribe(s),e.signal&&(e.signal.aborted?s():e.signal.addEventListener("abort",s))),Yn.isStream(l)?l.on("error",function(L){c(qa(L,e,null,P))}).pipe(P):P.end(l)})}});var Xr=p((ck,np)=>{"use strict";var ke=Ve(),tp=lh(),f0=ds(),d0={"Content-Type":"application/x-www-form-urlencoded"};function rp(t,e){!ke.isUndefined(t)&&ke.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function h0(){var t;return typeof XMLHttpRequest<"u"?t=Rh():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(t=ep()),t}function p0(t,e,r){if(ke.isString(t))try{return(e||JSON.parse)(t),ke.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}var xs={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:h0(),transformRequest:[function(e,r){return tp(r,"Accept"),tp(r,"Content-Type"),ke.isFormData(e)||ke.isArrayBuffer(e)||ke.isBuffer(e)||ke.isStream(e)||ke.isFile(e)||ke.isBlob(e)?e:ke.isArrayBufferView(e)?e.buffer:ke.isURLSearchParams(e)?(rp(r,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):ke.isObject(e)||r&&r["Content-Type"]==="application/json"?(rp(r,"application/json"),p0(e)):e}],transformResponse:[function(e){var r=this.transitional||xs.transitional,n=r&&r.silentJSONParsing,i=r&&r.forcedJSONParsing,s=!n&&this.responseType==="json";if(s||i&&ke.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(s)throw o.name==="SyntaxError"?f0(o,this,"E_JSON_PARSE"):o}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ke.forEach(["delete","get","head"],function(e){xs.headers[e]={}});ke.forEach(["post","put","patch"],function(e){xs.headers[e]=ke.merge(d0)});np.exports=xs});var sp=p((uk,ip)=>{"use strict";var m0=Ve(),g0=Xr();ip.exports=function(e,r,n){var i=this||g0;return m0.forEach(n,function(o){e=o.call(i,e,r)}),e}});var Na=p((lk,op)=>{"use strict";op.exports=function(e){return!!(e&&e.__CANCEL__)}});var up=p((fk,cp)=>{"use strict";var ap=Ve(),La=sp(),v0=Na(),y0=Xr(),_0=zr();function Fa(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new _0("canceled")}cp.exports=function(e){Fa(e),e.headers=e.headers||{},e.data=La.call(e,e.data,e.headers,e.transformRequest),e.headers=ap.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),ap.forEach(["delete","get","head","post","put","patch","common"],function(i){delete e.headers[i]});var r=e.adapter||y0.adapter;return r(e).then(function(i){return Fa(e),i.data=La.call(e,i.data,i.headers,e.transformResponse),i},function(i){return v0(i)||(Fa(e),i&&i.response&&(i.response.data=La.call(e,i.response.data,i.response.headers,e.transformResponse))),Promise.reject(i)})}});var Ma=p((dk,lp)=>{"use strict";var it=Ve();lp.exports=function(e,r){r=r||{};var n={};function i(u,f){return it.isPlainObject(u)&&it.isPlainObject(f)?it.merge(u,f):it.isPlainObject(f)?it.merge({},f):it.isArray(f)?f.slice():f}function s(u){if(it.isUndefined(r[u])){if(!it.isUndefined(e[u]))return i(void 0,e[u])}else return i(e[u],r[u])}function o(u){if(!it.isUndefined(r[u]))return i(void 0,r[u])}function a(u){if(it.isUndefined(r[u])){if(!it.isUndefined(e[u]))return i(void 0,e[u])}else return i(void 0,r[u])}function c(u){if(u in r)return i(e[u],r[u]);if(u in e)return i(void 0,e[u])}var l={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return it.forEach(Object.keys(e).concat(Object.keys(r)),function(f){var d=l[f]||s,h=d(f);it.isUndefined(h)&&d!==c||(n[f]=h)}),n}});var hp=p((hk,dp)=>{"use strict";var E0=ws().version,ja={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){ja[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});var fp={};ja.transitional=function(e,r,n){function i(s,o){return"[Axios v"+E0+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return function(s,o,a){if(e===!1)throw new Error(i(o," has been removed"+(r?" in "+r:"")));return r&&!fp[o]&&(fp[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,o,a):!0}};function w0(t,e,r){if(typeof t!="object")throw new TypeError("options must be an object");for(var n=Object.keys(t),i=n.length;i-- >0;){var s=n[i],o=e[s];if(o){var a=t[s],c=a===void 0||o(a,s,t);if(c!==!0)throw new TypeError("option "+s+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+s)}}dp.exports={assertOptions:w0,validators:ja}});var _p=p((pk,yp)=>{"use strict";var gp=Ve(),C0=ls(),pp=ch(),mp=up(),Ts=Ma(),vp=hp(),Jr=vp.validators;function Kn(t){this.defaults=t,this.interceptors={request:new pp,response:new pp}}Kn.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=Ts(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var r=e.transitional;r!==void 0&&vp.assertOptions(r,{silentJSONParsing:Jr.transitional(Jr.boolean),forcedJSONParsing:Jr.transitional(Jr.boolean),clarifyTimeoutError:Jr.transitional(Jr.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach(function(d){typeof d.runWhen=="function"&&d.runWhen(e)===!1||(i=i&&d.synchronous,n.unshift(d.fulfilled,d.rejected))});var s=[];this.interceptors.response.forEach(function(d){s.push(d.fulfilled,d.rejected)});var o;if(!i){var a=[mp,void 0];for(Array.prototype.unshift.apply(a,n),a=a.concat(s),o=Promise.resolve(e);a.length;)o=o.then(a.shift(),a.shift());return o}for(var c=e;n.length;){var l=n.shift(),u=n.shift();try{c=l(c)}catch(f){u(f);break}}try{o=mp(c)}catch(f){return Promise.reject(f)}for(;s.length;)o=o.then(s.shift(),s.shift());return o};Kn.prototype.getUri=function(e){return e=Ts(this.defaults,e),C0(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};gp.forEach(["delete","get","head","options"],function(e){Kn.prototype[e]=function(r,n){return this.request(Ts(n||{},{method:e,url:r,data:(n||{}).data}))}});gp.forEach(["post","put","patch"],function(e){Kn.prototype[e]=function(r,n,i){return this.request(Ts(i||{},{method:e,url:r,data:n}))}});yp.exports=Kn});var wp=p((mk,Ep)=>{"use strict";var x0=zr();function Zr(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(i){e=i});var r=this;this.promise.then(function(n){if(!!r._listeners){var i,s=r._listeners.length;for(i=0;i<s;i++)r._listeners[i](n);r._listeners=null}}),this.promise.then=function(n){var i,s=new Promise(function(o){r.subscribe(o),i=o}).then(n);return s.cancel=function(){r.unsubscribe(i)},s},t(function(i){r.reason||(r.reason=new x0(i),e(r.reason))})}Zr.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Zr.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};Zr.prototype.unsubscribe=function(e){if(!!this._listeners){var r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}};Zr.source=function(){var e,r=new Zr(function(i){e=i});return{token:r,cancel:e}};Ep.exports=Zr});var xp=p((gk,Cp)=>{"use strict";Cp.exports=function(e){return function(n){return e.apply(null,n)}}});var Sp=p((vk,Tp)=>{"use strict";Tp.exports=function(e){return typeof e=="object"&&e.isAxiosError===!0}});var Rp=p((yk,$a)=>{"use strict";var bp=Ve(),T0=ga(),Ss=_p(),S0=Ma(),b0=Xr();function Ip(t){var e=new Ss(t),r=T0(Ss.prototype.request,e);return bp.extend(r,Ss.prototype,e),bp.extend(r,e),r.create=function(i){return Ip(S0(t,i))},r}var It=Ip(b0);It.Axios=Ss;It.Cancel=zr();It.CancelToken=wp();It.isCancel=Na();It.VERSION=ws().version;It.all=function(e){return Promise.all(e)};It.spread=xp();It.isAxiosError=Sp();$a.exports=It;$a.exports.default=It});var Op=p((_k,Ap)=>{Ap.exports=Rp()});var Pe=p((wk,kp)=>{"use strict";var I0=function(){function t(){}return t.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t.enableDebug&&console.info(t.TAG+e,r)},t.warn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t.disableWarnings||console.warn(t.TAG+e,r)},t.enableDebug=!1,t.disableWarnings=!1,t.disableErrors=!1,t.TAG="ApplicationInsights:",t}();kp.exports=I0});var Ms=p((S,zp)=>{S=zp.exports=N;var W;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?W=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:W=function(){};S.SEMVER_SPEC_VERSION="2.0.0";var Ba=256,Rs=Number.MAX_SAFE_INTEGER||9007199254740991,Ua=16,Q=S.re=[],_=S.src=[],D=0,en=D++;_[en]="0|[1-9]\\d*";var tn=D++;_[tn]="[0-9]+";var za=D++;_[za]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var Pp=D++;_[Pp]="("+_[en]+")\\.("+_[en]+")\\.("+_[en]+")";var qp=D++;_[qp]="("+_[tn]+")\\.("+_[tn]+")\\.("+_[tn]+")";var Ga=D++;_[Ga]="(?:"+_[en]+"|"+_[za]+")";var Va=D++;_[Va]="(?:"+_[tn]+"|"+_[za]+")";var Xa=D++;_[Xa]="(?:-("+_[Ga]+"(?:\\."+_[Ga]+")*))";var Qa=D++;_[Qa]="(?:-?("+_[Va]+"(?:\\."+_[Va]+")*))";var Wa=D++;_[Wa]="[0-9A-Za-z-]+";var ti=D++;_[ti]="(?:\\+("+_[Wa]+"(?:\\."+_[Wa]+")*))";var Ya=D++,Np="v?"+_[Pp]+_[Xa]+"?"+_[ti]+"?";_[Ya]="^"+Np+"$";var Ka="[v=\\s]*"+_[qp]+_[Qa]+"?"+_[ti]+"?",Ja=D++;_[Ja]="^"+Ka+"$";var sn=D++;_[sn]="((?:<|>)?=?)";var As=D++;_[As]=_[tn]+"|x|X|\\*";var Os=D++;_[Os]=_[en]+"|x|X|\\*";var Er=D++;_[Er]="[v=\\s]*("+_[Os]+")(?:\\.("+_[Os]+")(?:\\.("+_[Os]+")(?:"+_[Xa]+")?"+_[ti]+"?)?)?";var nn=D++;_[nn]="[v=\\s]*("+_[As]+")(?:\\.("+_[As]+")(?:\\.("+_[As]+")(?:"+_[Qa]+")?"+_[ti]+"?)?)?";var Lp=D++;_[Lp]="^"+_[sn]+"\\s*"+_[Er]+"$";var Fp=D++;_[Fp]="^"+_[sn]+"\\s*"+_[nn]+"$";var Mp=D++;_[Mp]="(?:^|[^\\d])(\\d{1,"+Ua+"})(?:\\.(\\d{1,"+Ua+"}))?(?:\\.(\\d{1,"+Ua+"}))?(?:$|[^\\d])";var Ls=D++;_[Ls]="(?:~>?)";var ks=D++;_[ks]="(\\s*)"+_[Ls]+"\\s+";Q[ks]=new RegExp(_[ks],"g");var R0="$1~",jp=D++;_[jp]="^"+_[Ls]+_[Er]+"$";var $p=D++;_[$p]="^"+_[Ls]+_[nn]+"$";var Fs=D++;_[Fs]="(?:\\^)";var Ds=D++;_[Ds]="(\\s*)"+_[Fs]+"\\s+";Q[Ds]=new RegExp(_[Ds],"g");var A0="$1^",Hp=D++;_[Hp]="^"+_[Fs]+_[Er]+"$";var Up=D++;_[Up]="^"+_[Fs]+_[nn]+"$";var Za=D++;_[Za]="^"+_[sn]+"\\s*("+Ka+")$|^$";var ec=D++;_[ec]="^"+_[sn]+"\\s*("+Np+")$|^$";var Zn=D++;_[Zn]="(\\s*)"+_[sn]+"\\s*("+Ka+"|"+_[Er]+")";Q[Zn]=new RegExp(_[Zn],"g");var O0="$1$2$3",Bp=D++;_[Bp]="^\\s*("+_[Er]+")\\s+-\\s+("+_[Er]+")\\s*$";var Gp=D++;_[Gp]="^\\s*("+_[nn]+")\\s+-\\s+("+_[nn]+")\\s*$";var Vp=D++;_[Vp]="(<|>)?=?\\s*\\*";for(Yt=0;Yt<D;Yt++)W(Yt,_[Yt]),Q[Yt]||(Q[Yt]=new RegExp(_[Yt]));var Yt;S.parse=wr;function wr(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof N)return t;if(typeof t!="string"||t.length>Ba)return null;var r=e.loose?Q[Ja]:Q[Ya];if(!r.test(t))return null;try{return new N(t,e)}catch{return null}}S.valid=k0;function k0(t,e){var r=wr(t,e);return r?r.version:null}S.clean=D0;function D0(t,e){var r=wr(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}S.SemVer=N;function N(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof N){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>Ba)throw new TypeError("version is longer than "+Ba+" characters");if(!(this instanceof N))return new N(t,e);W("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?Q[Ja]:Q[Ya]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Rs||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Rs||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Rs||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<Rs)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}N.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};N.prototype.toString=function(){return this.version};N.prototype.compare=function(t){return W("SemVer.compare",this.version,this.options,t),t instanceof N||(t=new N(t,this.options)),this.compareMain(t)||this.comparePre(t)};N.prototype.compareMain=function(t){return t instanceof N||(t=new N(t,this.options)),rn(this.major,t.major)||rn(this.minor,t.minor)||rn(this.patch,t.patch)};N.prototype.comparePre=function(t){if(t instanceof N||(t=new N(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(W("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return rn(r,n)}while(++e)};N.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};S.inc=P0;function P0(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new N(t,r).inc(e,n).version}catch{return null}}S.diff=q0;function q0(t,e){if(tc(t,e))return null;var r=wr(t),n=wr(e),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var o in r)if((o==="major"||o==="minor"||o==="patch")&&r[o]!==n[o])return i+o;return s}S.compareIdentifiers=rn;var Dp=/^[0-9]+$/;function rn(t,e){var r=Dp.test(t),n=Dp.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}S.rcompareIdentifiers=N0;function N0(t,e){return rn(e,t)}S.major=L0;function L0(t,e){return new N(t,e).major}S.minor=F0;function F0(t,e){return new N(t,e).minor}S.patch=M0;function M0(t,e){return new N(t,e).patch}S.compare=Nt;function Nt(t,e,r){return new N(t,r).compare(new N(e,r))}S.compareLoose=j0;function j0(t,e){return Nt(t,e,!0)}S.rcompare=$0;function $0(t,e,r){return Nt(e,t,r)}S.sort=H0;function H0(t,e){return t.sort(function(r,n){return S.compare(r,n,e)})}S.rsort=U0;function U0(t,e){return t.sort(function(r,n){return S.rcompare(r,n,e)})}S.gt=ei;function ei(t,e,r){return Nt(t,e,r)>0}S.lt=Ps;function Ps(t,e,r){return Nt(t,e,r)<0}S.eq=tc;function tc(t,e,r){return Nt(t,e,r)===0}S.neq=Wp;function Wp(t,e,r){return Nt(t,e,r)!==0}S.gte=rc;function rc(t,e,r){return Nt(t,e,r)>=0}S.lte=nc;function nc(t,e,r){return Nt(t,e,r)<=0}S.cmp=qs;function qs(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return tc(t,r,n);case"!=":return Wp(t,r,n);case">":return ei(t,r,n);case">=":return rc(t,r,n);case"<":return Ps(t,r,n);case"<=":return nc(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}S.Comparator=ht;function ht(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ht){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof ht))return new ht(t,e);W("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===ri?this.value="":this.value=this.operator+this.semver.version,W("comp",this)}var ri={};ht.prototype.parse=function(t){var e=this.options.loose?Q[Za]:Q[ec],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new N(r[2],this.options.loose):this.semver=ri};ht.prototype.toString=function(){return this.value};ht.prototype.test=function(t){return W("Comparator.test",t,this.options.loose),this.semver===ri?!0:(typeof t=="string"&&(t=new N(t,this.options)),qs(t,this.operator,this.semver,this.options))};ht.prototype.intersects=function(t,e){if(!(t instanceof ht))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new ue(t.value,e),Ns(this.value,r,e);if(t.operator==="")return r=new ue(this.value,e),Ns(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),a=qs(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),c=qs(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||i||s&&o||a||c};S.Range=ue;function ue(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ue)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new ue(t.raw,e);if(t instanceof ht)return new ue(t.value,e);if(!(this instanceof ue))return new ue(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}ue.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};ue.prototype.toString=function(){return this.range};ue.prototype.parseRange=function(t){var e=this.options.loose;t=t.trim();var r=e?Q[Gp]:Q[Bp];t=t.replace(r,J0),W("hyphen replace",t),t=t.replace(Q[Zn],O0),W("comparator trim",t,Q[Zn]),t=t.replace(Q[ks],R0),t=t.replace(Q[Ds],A0),t=t.split(/\s+/).join(" ");var n=e?Q[Za]:Q[ec],i=t.split(" ").map(function(s){return G0(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new ht(s,this.options)},this),i};ue.prototype.intersects=function(t,e){if(!(t instanceof ue))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(i){return i.every(function(s){return n.intersects(s,e)})})})})};S.toComparators=B0;function B0(t,e){return new ue(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function G0(t,e){return W("comp",t,e),t=z0(t,e),W("caret",t),t=V0(t,e),W("tildes",t),t=Q0(t,e),W("xrange",t),t=K0(t,e),W("stars",t),t}function We(t){return!t||t.toLowerCase()==="x"||t==="*"}function V0(t,e){return t.trim().split(/\s+/).map(function(r){return W0(r,e)}).join(" ")}function W0(t,e){var r=e.loose?Q[$p]:Q[jp];return t.replace(r,function(n,i,s,o,a){W("tilde",t,n,i,s,o,a);var c;return We(i)?c="":We(s)?c=">="+i+".0.0 <"+(+i+1)+".0.0":We(o)?c=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":a?(W("replaceTilde pr",a),c=">="+i+"."+s+"."+o+"-"+a+" <"+i+"."+(+s+1)+".0"):c=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0",W("tilde return",c),c})}function z0(t,e){return t.trim().split(/\s+/).map(function(r){return X0(r,e)}).join(" ")}function X0(t,e){W("caret",t,e);var r=e.loose?Q[Up]:Q[Hp];return t.replace(r,function(n,i,s,o,a){W("caret",t,n,i,s,o,a);var c;return We(i)?c="":We(s)?c=">="+i+".0.0 <"+(+i+1)+".0.0":We(o)?i==="0"?c=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+".0 <"+(+i+1)+".0.0":a?(W("replaceCaret pr",a),i==="0"?s==="0"?c=">="+i+"."+s+"."+o+"-"+a+" <"+i+"."+s+"."+(+o+1):c=">="+i+"."+s+"."+o+"-"+a+" <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+"."+o+"-"+a+" <"+(+i+1)+".0.0"):(W("no pr"),i==="0"?s==="0"?c=">="+i+"."+s+"."+o+" <"+i+"."+s+"."+(+o+1):c=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0":c=">="+i+"."+s+"."+o+" <"+(+i+1)+".0.0"),W("caret return",c),c})}function Q0(t,e){return W("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return Y0(r,e)}).join(" ")}function Y0(t,e){t=t.trim();var r=e.loose?Q[Fp]:Q[Lp];return t.replace(r,function(n,i,s,o,a,c){W("xRange",t,n,i,s,o,a,c);var l=We(s),u=l||We(o),f=u||We(a),d=f;return i==="="&&d&&(i=""),l?i===">"||i==="<"?n="<0.0.0":n="*":i&&d?(u&&(o=0),a=0,i===">"?(i=">=",u?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",u?s=+s+1:o=+o+1),n=i+s+"."+o+"."+a):u?n=">="+s+".0.0 <"+(+s+1)+".0.0":f&&(n=">="+s+"."+o+".0 <"+s+"."+(+o+1)+".0"),W("xRange return",n),n})}function K0(t,e){return W("replaceStars",t,e),t.trim().replace(Q[Vp],"")}function J0(t,e,r,n,i,s,o,a,c,l,u,f,d){return We(r)?e="":We(n)?e=">="+r+".0.0":We(i)?e=">="+r+"."+n+".0":e=">="+e,We(c)?a="":We(l)?a="<"+(+c+1)+".0.0":We(u)?a="<"+c+"."+(+l+1)+".0":f?a="<="+c+"."+l+"."+u+"-"+f:a="<="+a,(e+" "+a).trim()}ue.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new N(t,this.options));for(var e=0;e<this.set.length;e++)if(Z0(this.set[e],t,this.options))return!0;return!1};function Z0(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(W(t[n].semver),t[n].semver!==ri&&t[n].semver.prerelease.length>0){var i=t[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}S.satisfies=Ns;function Ns(t,e,r){try{e=new ue(e,r)}catch{return!1}return e.test(t)}S.maxSatisfying=eT;function eT(t,e,r){var n=null,i=null;try{var s=new ue(e,r)}catch{return null}return t.forEach(function(o){s.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new N(n,r))}),n}S.minSatisfying=tT;function tT(t,e,r){var n=null,i=null;try{var s=new ue(e,r)}catch{return null}return t.forEach(function(o){s.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new N(n,r))}),n}S.minVersion=rT;function rT(t,e){t=new ue(t,e);var r=new N("0.0.0");if(t.test(r)||(r=new N("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var i=t.set[n];i.forEach(function(s){var o=new N(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!r||ei(r,o))&&(r=o);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}S.validRange=nT;function nT(t,e){try{return new ue(t,e).range||"*"}catch{return null}}S.ltr=iT;function iT(t,e,r){return ic(t,e,"<",r)}S.gtr=sT;function sT(t,e,r){return ic(t,e,">",r)}S.outside=ic;function ic(t,e,r,n){t=new N(t,n),e=new ue(e,n);var i,s,o,a,c;switch(r){case">":i=ei,s=nc,o=Ps,a=">",c=">=";break;case"<":i=Ps,s=rc,o=ei,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ns(t,e,n))return!1;for(var l=0;l<e.set.length;++l){var u=e.set[l],f=null,d=null;if(u.forEach(function(h){h.semver===ri&&(h=new ht(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,n)?f=h:o(h.semver,d.semver,n)&&(d=h)}),f.operator===a||f.operator===c||(!d.operator||d.operator===a)&&s(t,d.semver))return!1;if(d.operator===c&&o(t,d.semver))return!1}return!0}S.prerelease=oT;function oT(t,e){var r=wr(t,e);return r&&r.prerelease.length?r.prerelease:null}S.intersects=aT;function aT(t,e,r){return t=new ue(t,r),e=new ue(e,r),t.intersects(e)}S.coerce=cT;function cT(t){if(t instanceof N)return t;if(typeof t!="string")return null;var e=t.match(Q[Mp]);return e==null?null:wr(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var oc=p(sc=>{"use strict";Object.defineProperty(sc,"__esModule",{value:!0});var uT=require("path"),lT=Ms(),Qp=require("module"),fT=Object.keys(process.binding("natives")),Xp=Qp.prototype.require;function dT(t){var e={};return function(n){var i=Xp.apply(this,arguments);if(t[n]){var s=Qp._resolveFilename(n,this);if(e.hasOwnProperty(s))return e[s];var o=void 0;if(fT.indexOf(n)<0)try{o=Xp.call(this,uT.join(n,"package.json")).version}catch{return i}else o=process.version.substring(1);var a=o.indexOf("-");a>=0&&(o=o.substring(0,a));for(var c=i,l=0,u=t[n];l<u.length;l++){var f=u[l];lT.satisfies(o,f.versionSpecifier)&&(c=f.patch(c,s))}return e[s]=c}return i}}sc.makePatchingRequire=dT});var Yp=p((xk,hT)=>{hT.exports={name:"diagnostic-channel",version:"0.2.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"^7.0.12",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"^2.2.1"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var Ee=p(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});var pT=oc(),mT=oc();js.makePatchingRequire=mT.makePatchingRequire;var Kp=function(t){return!0},gT=function(){function t(){this.version=Yp().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.currentlyPublishing=!1}return t.prototype.shouldPublish=function(e){var r=this.subscribers[e];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},t.prototype.publish=function(e,r){if(!this.currentlyPublishing){var n=this.subscribers[e];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var o=s.listener,a=s.filter;try{a&&a(!0)&&o(i)}catch{}}),this.currentlyPublishing=!1}}},t.prototype.subscribe=function(e,r,n){n===void 0&&(n=Kp),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:r,filter:n})},t.prototype.unsubscribe=function(e,r,n){n===void 0&&(n=Kp);var i=this.subscribers[e];if(i){for(var s=0;s<i.length;++s)if(i[s].listener===r&&i[s].filter===n)return i.splice(s,1),!0}return!1},t.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete e.knownPatches[r]})},t.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},t.prototype.addContextPreservation=function(e){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return e(r(n))}},t.prototype.registerMonkeyPatch=function(e,r){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(r)},t.prototype.getPatchesObject=function(){return this.knownPatches},t}();global.diagnosticsSource||(global.diagnosticsSource=new gT,Jp=require("module"),Jp.prototype.require=pT.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var Jp;js.channel=global.diagnosticsSource});var Zp=p(Lt=>{"use strict";var vT=Lt&&Lt.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(Lt,"__esModule",{value:!0});var $s=Ee();Lt.AzureMonitorSymbol="Azure_Monitor_Tracer";var yT=function(t){try{var e=require("@opentelemetry/tracing").BasicTracer,r=$s.channel.spanContextPropagator?{scopeManager:$s.channel.spanContextPropagator}:void 0,n=new e(r),i=n.startSpan;n.startSpan=function(s,o){if(!o||!o.parent){var a=n.getCurrentSpan();a&&a.operation&&a.operation.traceparent&&(o=vT({},o,{parent:{traceId:a.operation.traceparent.traceId,spanId:a.operation.traceparent.spanId}}))}var c=i.call(this,s,o);return c.addEvent("Application Insights Integration enabled"),c},n.addSpanProcessor(new _T),n[Lt.AzureMonitorSymbol]=!0,t.setTracer(n)}catch{}return t},_T=function(){function t(){}return t.prototype.onStart=function(e){},t.prototype.onEnd=function(e){$s.channel.publish("azure-coretracing",e)},t.prototype.shutdown=function(){},t}();Lt.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:yT};function ET(){$s.channel.registerMonkeyPatch("@azure/core-tracing",Lt.azureCoreTracing)}Lt.enable=ET});var tm=p(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});var em=Ee(),wT=function(t){var e=t.prototype._emit;return t.prototype._emit=function(r,n){var i=e.apply(this,arguments);if(!n){var s=i;s||(s=e.call(this,r,!0)),em.channel.publish("bunyan",{level:r.level,result:s})}return i},t};ni.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:wT};function CT(){em.channel.registerMonkeyPatch("bunyan",ni.bunyan)}ni.enable=CT});var nm=p(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});var ac=Ee(),rm=require("stream"),xT=function(t){var e=new rm.Writable,r=new rm.Writable;e.write=function(l){if(!l)return!0;var u=l.toString();return ac.channel.publish("console",{message:u}),!0},r.write=function(l){if(!l)return!0;var u=l.toString();return ac.channel.publish("console",{message:u,stderr:!0}),!0};for(var n=new t.Console(e,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(l){var u=t[l];u&&(t[l]=function(){if(n[l])try{n[l].apply(n,arguments)}catch{}return u.apply(t,arguments)})},o=0,a=i;o<a.length;o++){var c=a[o];s(c)}return t};ii.console={versionSpecifier:">= 4.0.0",patch:xT};function TT(){ac.channel.registerMonkeyPatch("console",ii.console),require("console")}ii.enable=TT});var im=p(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});var cc=Ee(),ST=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var a=typeof arguments[1]=="function"?1:2;return typeof arguments[a]=="function"&&(arguments[a]=cc.channel.bindToContext(arguments[a])),i.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=cc.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t};si.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:ST};function bT(){cc.channel.registerMonkeyPatch("mongodb-core",si.mongoCore)}si.enable=bT});var om=p(_t=>{"use strict";var sm=_t&&_t.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(_t,"__esModule",{value:!0});var je=Ee(),IT=function(t){var e=t.instrument({operationIdGenerator:{next:function(){return je.channel.bindToContext(function(n){return n()})}}}),r={};return e.on("started",function(n){r[n.requestId]||(r[n.requestId]=sm({},n,{time:new Date}))}),e.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return je.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):je.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),e.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return je.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):je.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),t},RT=function(t){var e=t.instrument(),r={},n={};return e.on("started",function(i){r[i.requestId]||(n[i.requestId]=je.channel.bindToContext(function(s){return s()}),r[i.requestId]=sm({},i,{time:new Date}))}),e.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return je.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),e.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return je.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),t},AT=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var a=typeof arguments[1]=="function"?1:2;return typeof arguments[a]=="function"&&(arguments[a]=je.channel.bindToContext(arguments[a])),i.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=je.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t},OT=function(t){AT(t);var e=t.instrument(),r={},n={};return e.on("started",function(i){r[i.requestId]||(n[i.requestId]=je.channel.bindToContext(function(s){return s()}),r[i.requestId]=i)}),e.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return je.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),e.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return je.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),t};_t.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:IT};_t.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:RT};_t.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:OT};function kT(){je.channel.registerMonkeyPatch("mongodb",_t.mongo2),je.channel.registerMonkeyPatch("mongodb",_t.mongo3),je.channel.registerMonkeyPatch("mongodb",_t.mongo330)}_t.enable=kT});var cm=p(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});var Hs=Ee(),am=require("path"),DT=function(t,e){var r=function(c,l){return function(u,f){var d=c[u];d&&(c[u]=function(){for(var m=arguments.length-1,v=arguments.length-1;v>=0;--v)if(typeof arguments[v]=="function"){m=v;break}else if(typeof arguments[v]<"u")break;var g=arguments[m],y={result:null,startTime:null,startDate:null};typeof g=="function"&&(f?(y.startTime=process.hrtime(),y.startDate=new Date,arguments[m]=Hs.channel.bindToContext(f(y,g))):arguments[m]=Hs.channel.bindToContext(g));var E=d.apply(this,arguments);return y.result=E,E})}},n=function(c,l){return r(c.prototype,l+".prototype")},i=["connect","changeUser","ping","statistics","end"],s=require(am.dirname(e)+"/lib/Connection");i.forEach(function(c){return n(s,"Connection")(c)}),r(s,"Connection")("createQuery",function(c,l){return function(u){var f=process.hrtime(c.startTime),d=f[0]*1e3+f[1]/1e6|0;Hs.channel.publish("mysql",{query:c.result,callbackArgs:arguments,err:u,duration:d,time:c.startDate}),l.apply(this,arguments)}});var o=["_enqueueCallback"],a=require(am.dirname(e)+"/lib/Pool");return o.forEach(function(c){return n(a,"Pool")(c)}),t};oi.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:DT};function PT(){Hs.channel.registerMonkeyPatch("mysql",oi.mysql)}oi.enable=PT});var lm=p(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});var um=Ee();function qT(t){var e=t.prototype.connect;return t.prototype.connect=function(n){return n&&(arguments[0]=um.channel.bindToContext(n)),e.apply(this,arguments)},t}ai.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:qT};function NT(){um.channel.registerMonkeyPatch("pg-pool",ai.postgresPool1)}ai.enable=NT});var dm=p(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});var on=Ee(),fm=require("events");function LT(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,o,a){var c={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},l=process.hrtime(),u;function f(d){d&&d[n]&&(d=d[n]);var h=on.channel.bindToContext(function(m,v){var g=process.hrtime(l);if(c.result=v&&{rowCount:v.rowCount,command:v.command},c.error=m,c.duration=Math.ceil(g[0]*1e3+g[1]/1e6),on.channel.publish("postgres",c),m){if(d)return d.apply(this,arguments);u&&u instanceof fm.EventEmitter&&u.emit("error",m)}else d&&d.apply(this,arguments)});try{return Object.defineProperty(h,n,{value:d}),h}catch{return d}}try{typeof s=="string"?o instanceof Array?(c.query.preparable={text:s,args:o},a=f(a)):(c.query.text=s,a?a=f(a):o=f(o)):(typeof s.name=="string"?c.query.plan=s.name:s.values instanceof Array?c.query.preparable={text:s.text,args:s.values}:c.query.text=s.text,a?a=f(a):o?o=f(o):s.callback=f(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=o,arguments[2]=a,arguments.length=arguments.length>3?arguments.length:3,u=r.apply(this,arguments),u},t}function FT(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,o,a){var c=this,l=!!a,u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},f=process.hrtime(),d;function h(m){m&&m[n]&&(m=m[n]);var v=on.channel.bindToContext(function(g,y){var E=process.hrtime(f);if(u.result=y&&{rowCount:y.rowCount,command:y.command},u.error=g,u.duration=Math.ceil(E[0]*1e3+E[1]/1e6),on.channel.publish("postgres",u),g){if(m)return m.apply(this,arguments);d&&d instanceof fm.EventEmitter&&d.emit("error",g)}else m&&m.apply(this,arguments)});try{return Object.defineProperty(v,n,{value:m}),v}catch{return m}}try{typeof s=="string"?o instanceof Array?(u.query.preparable={text:s,args:o},l=typeof a=="function",a=l?h(a):a):(u.query.text=s,a?(l=typeof a=="function",a=l?h(a):a):(l=typeof o=="function",o=l?h(o):o)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,a?(l=typeof a=="function",a=h(a)):o?(l=typeof o=="function",o=l?h(o):o):(l=typeof s.callback=="function",s.callback=l?h(s.callback):s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=o,arguments[2]=a,arguments.length=arguments.length>3?arguments.length:3,d=r.apply(this,arguments),l?d:d.then(function(m){return h()(void 0,m),new c._Promise(function(v,g){v(m)})}).catch(function(m){return h()(m,void 0),new c._Promise(function(v,g){g(m)})})},t}Cr.postgres6={versionSpecifier:"6.*",patch:LT};Cr.postgres7={versionSpecifier:">=7.* <=8.*",patch:FT};function MT(){on.channel.registerMonkeyPatch("pg",Cr.postgres6),on.channel.registerMonkeyPatch("pg",Cr.postgres7)}Cr.enable=MT});var hm=p(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});var uc=Ee(),jT=function(t){var e=t.RedisClient.prototype.internal_send_command;return t.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,s=process.hrtime(),o=new Date;r.callback=uc.channel.bindToContext(function(a,c){var l=process.hrtime(s),u=l[0]*1e3+l[1]/1e6|0;uc.channel.publish("redis",{duration:u,address:i,commandObj:r,err:a,result:c,time:o}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return e.call(this,r)},t};ci.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:jT};function $T(){uc.channel.registerMonkeyPatch("redis",ci.redis)}ci.enable=$T});var pm=p(xr=>{"use strict";var HT=xr&&xr.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(xr,"__esModule",{value:!0});var lc=Ee(),UT=function(t){var e=t.Connection.prototype.makeRequest;return t.Connection.prototype.makeRequest=function(){function n(s){var o=process.hrtime(),a={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return lc.channel.bindToContext(function(c,l,u){var f=process.hrtime(o);a=HT({},a,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!c&&{rowCount:l,rows:u},query:{text:this.parametersByName.statement.value},error:c,duration:Math.ceil(f[0]*1e3+f[1]/1e6)}),lc.channel.publish("tedious",a),s.call(this,c,l,u)})}var i=arguments[0];arguments[0].callback=n(i.callback),e.apply(this,arguments)},t};xr.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:UT};function BT(){lc.channel.registerMonkeyPatch("tedious",xr.tedious)}xr.enable=BT});var mm=p(Et=>{"use strict";var GT=Et&&Et.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),VT=Et&&Et.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&(r[n[i]]=t[n[i]]);return r};Object.defineProperty(Et,"__esModule",{value:!0});var Us=Ee(),WT=function(t){var e=t.Logger.prototype.log,r,n=function(i,s,o){var a;return r===t.config.npm.levels?a="npm":r===t.config.syslog.levels?a="syslog":a="unknown",Us.channel.publish("winston",{level:i,message:s,meta:o,levelKind:a}),s};return t.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),e.apply(this,arguments)},t},zT=function(t){var e=function(o,a){var c;return o.config.npm.levels[a]!=null?c="npm":o.config.syslog.levels[a]!=null?c="syslog":c="unknown",c},r=function(o){GT(a,o);function a(c,l){var u=o.call(this,l)||this;return u.winston=c,u}return a.prototype.log=function(c,l){var u=c.message,f=c.level,d=c.meta,h=VT(c,["message","level","meta"]);f=typeof Symbol.for=="function"?c[Symbol.for("level")]:f,u=c instanceof Error?c:u;var m=e(this.winston,f);d=d||{};for(var v in h)h.hasOwnProperty(v)&&(d[v]=h[v]);Us.channel.publish("winston",{message:u,level:f,levelKind:m,meta:d}),l()},a}(t.Transport);function n(){var o=arguments[0].levels||t.config.npm.levels,a;for(var c in o)o.hasOwnProperty(c)&&(a=a===void 0||o[c]>o[a]?c:a);this.add(new r(t,{level:a}))}var i=t.createLogger;t.createLogger=function(){var a=arguments[0].levels||t.config.npm.levels,c;for(var l in a)a.hasOwnProperty(l)&&(c=c===void 0||a[l]>a[c]?l:c);var u=i.apply(this,arguments);u.add(new r(t,{level:c}));var f=u.configure;return u.configure=function(){f.apply(this,arguments),n.apply(this,arguments)},u};var s=t.createLogger;return t.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},t.add(new r(t)),t};Et.winston3={versionSpecifier:"3.x",patch:zT};Et.winston2={versionSpecifier:"2.x",patch:WT};function XT(){Us.channel.registerMonkeyPatch("winston",Et.winston2),Us.channel.registerMonkeyPatch("winston",Et.winston3)}Et.enable=XT});var Im=p(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});var gm=Zp();Je.azuresdk=gm;var vm=tm();Je.bunyan=vm;var ym=nm();Je.console=ym;var _m=im();Je.mongodbCore=_m;var Em=om();Je.mongodb=Em;var wm=cm();Je.mysql=wm;var Cm=lm();Je.pgPool=Cm;var xm=dm();Je.pg=xm;var Tm=hm();Je.redis=Tm;var Sm=pm();Je.tedious=Sm;var bm=mm();Je.winston=bm;function QT(){vm.enable(),ym.enable(),_m.enable(),Em.enable(),wm.enable(),xm.enable(),Cm.enable(),Tm.enable(),bm.enable(),gm.enable(),Sm.enable()}Je.enable=QT});var Vs=p(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});var fc=Pe();an.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var dc="DiagnosticChannel";if(an.IsInitialized){Rt=Im(),Rm=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",Bs=Rm.split(","),hc={bunyan:Rt.bunyan,console:Rt.console,mongodb:Rt.mongodb,mongodbCore:Rt.mongodbCore,mysql:Rt.mysql,redis:Rt.redis,pg:Rt.pg,pgPool:Rt.pgPool,winston:Rt.winston};for(Gs in hc)Bs.indexOf(Gs)===-1&&(hc[Gs].enable(),fc.info(dc,"Subscribed to "+Gs+" events"));Bs.length>0&&fc.info(dc,"Some modules will not be patched",Bs)}else fc.info(dc,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var Rt,Rm,Bs,hc,Gs;function YT(t){!an.IsInitialized||Ee().channel.addContextPreservation(t)}an.registerContextPreservation=YT});var Ws=p((Mk,km)=>{"use strict";function pc(t){return typeof t=="function"}var ze=console.error.bind(console);function ui(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function li(t){t&&t.logger&&(pc(t.logger)?ze=t.logger:ze("new logger isn't a function, not replacing"))}function Am(t,e,r){if(!t||!t[e]){ze("no original function "+e+" to wrap");return}if(!r){ze("no wrapper function"),ze(new Error().stack);return}if(!pc(t[e])||!pc(r)){ze("original object and wrapper must be functions");return}var n=t[e],i=r(n,e);return ui(i,"__original",n),ui(i,"__unwrap",function(){t[e]===i&&ui(t,e,n)}),ui(i,"__wrapped",!0),ui(t,e,i),i}function KT(t,e,r){if(t)Array.isArray(t)||(t=[t]);else{ze("must provide one or more modules to patch"),ze(new Error().stack);return}if(!(e&&Array.isArray(e))){ze("must provide one or more functions to wrap on modules");return}t.forEach(function(n){e.forEach(function(i){Am(n,i,r)})})}function Om(t,e){if(!t||!t[e]){ze("no function to unwrap."),ze(new Error().stack);return}if(!t[e].__unwrap)ze("no original to unwrap to -- has "+e+" already been unwrapped?");else return t[e].__unwrap()}function JT(t,e){if(t)Array.isArray(t)||(t=[t]);else{ze("must provide one or more modules to patch"),ze(new Error().stack);return}if(!(e&&Array.isArray(e))){ze("must provide one or more functions to unwrap on modules");return}t.forEach(function(r){e.forEach(function(n){Om(r,n)})})}li.wrap=Am;li.massWrap=KT;li.unwrap=Om;li.massUnwrap=JT;km.exports=li});var Qs=p((jk,Nm)=>{"use strict";var Pm=Ws(),cn=Pm.wrap,zs=Pm.unwrap,Ft="wrap@before";function Xs(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function ZT(t,e){for(var r=e.length,n=0;n<r;n++){var i=e[n],s=t[Ft];if(typeof s=="function")s(i);else if(Array.isArray(s))for(var o=s.length,a=0;a<o;a++)s[a](i)}}function qm(t,e){var r;return r=t._events&&t._events[e],Array.isArray(r)||(r?r=[r]:r=[]),r}function eS(t,e,r){var n=qm(t,e),i=n.filter(function(s){return r.indexOf(s)===-1});i.length>0&&ZT(t,i)}function Dm(t,e){if(!!t){var r=t;if(typeof t=="function")r=e(t);else if(Array.isArray(t)){r=[];for(var n=0;n<t.length;n++)r[n]=e(t[n])}return r}}Nm.exports=function(e,r,n){if(!e||!e.on||!e.addListener||!e.removeListener||!e.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(o){return function(c,l){var u=qm(this,c).slice();try{var f=o.call(this,c,l);return eS(this,c,u),f}finally{this.on.__wrapped||cn(this,"on",i),this.addListener.__wrapped||cn(this,"addListener",i)}}}function s(o){return function(c){if(!this._events||!this._events[c])return o.apply(this,arguments);var l=this._events[c];function u(f){return function(){this._events[c]=l;try{return f.apply(this,arguments)}finally{l=this._events[c],this._events[c]=Dm(l,n)}}}cn(this,"removeListener",u);try{return this._events[c]=Dm(l,n),o.apply(this,arguments)}finally{zs(this,"removeListener"),this._events[c]=l}}}e[Ft]?typeof e[Ft]=="function"?Xs(e,Ft,[e[Ft],r]):Array.isArray(e[Ft])&&e[Ft].push(r):Xs(e,Ft,r),e.__wrapped||(cn(e,"addListener",i),cn(e,"on",i),cn(e,"emit",s),Xs(e,"__unwrap",function(){zs(e,"addListener"),zs(e,"on"),zs(e,"emit"),delete e[Ft],delete e.__wrapped}),Xs(e,"__wrapped",!0))}});var jm=p(($k,Mm)=>{"use strict";var H=require("util"),Mt=require("assert"),tS=Qs(),te=require("async_hooks"),fi="cls@contexts",di="error@context",le=process.env.DEBUG_CLS_HOOKED,$=-1;Mm.exports={getNamespace:Lm,createNamespace:rS,destroyNamespace:Fm,reset:nS,ERROR_SYMBOL:di};function pt(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}pt.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=r,le){let n=" ".repeat(this._indent<0?0:this._indent);ie(n+"CONTEXT-SET KEY:"+e+"="+r+" in ns:"+this.name+" currentUid:"+$+" active:"+H.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};pt.prototype.get=function(e){if(!this.active){if(le){let r=te.currentId(),n=te.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);ie(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${$} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(le){let r=te.executionAsyncId(),n=te.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);ie(i+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+$+" active:"+H.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),ie(`${i}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${$} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${H.inspect(this.active)}`)}return this.active[e]};pt.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=$,le){let r=te.executionAsyncId(),n=te.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);ie(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${$} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${H.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e};pt.prototype.run=function(e){let r=this.createContext();this.enter(r);try{if(le){let n=te.triggerAsyncId(),i=te.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);ie(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${$} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${H.inspect(r)}`)}return e(r),r}catch(n){throw n&&(n[di]=r),n}finally{if(le){let n=te.triggerAsyncId(),i=te.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);ie(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${$} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${H.inspect(r)}`)}this.exit(r)}};pt.prototype.runAndReturn=function(e){let r;return this.run(function(n){r=e(n)}),r};pt.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return le&&ie("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+$+" len:"+this._set.length+" "+H.inspect(r)),n.then(i=>(le&&ie("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+$+" len:"+this._set.length+" "+H.inspect(r)),this.exit(r),i)).catch(i=>{throw i[di]=r,le&&ie("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+$+" len:"+this._set.length+" "+H.inspect(r)),this.exit(r),i})};pt.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[di]=r),s}finally{n.exit(r)}}};pt.prototype.enter=function(e){if(Mt.ok(e,"context must be provided for entering"),le){let r=te.executionAsyncId(),n=te.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);ie(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${$} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${H.inspect(e)}`)}this._set.push(this.active),this.active=e};pt.prototype.exit=function(e){if(Mt.ok(e,"context must be provided for exiting"),le){let n=te.executionAsyncId(),i=te.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);ie(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${$} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${H.inspect(e)}`)}if(this.active===e){Mt.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(le&&ie("??ERROR?? context exiting but not entered - ignoring: "+H.inspect(e)),Mt.ok(r>=0,`context not currently entered; can't exit. 
`+H.inspect(this)+`
`+H.inspect(e))):(Mt.ok(r,"can't remove top context"),this._set.splice(r,1))};pt.prototype.bindEmitter=function(e){Mt.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(o){!o||(o[fi]||(o[fi]=Object.create(null)),o[fi][n]={namespace:r,context:r.active})}function s(o){if(!(o&&o[fi]))return o;let a=o,c=o[fi];return Object.keys(c).forEach(function(l){let u=c[l];a=u.namespace.bind(a,u.context)}),a}tS(e,i,s)};pt.prototype.fromException=function(e){return e[di]};function Lm(t){return process.namespaces[t]}function rS(t){Mt.ok(t,"namespace must be given a name."),le&&ie(`NS-CREATING NAMESPACE (${t})`);let e=new pt(t);return e.id=$,te.createHook({init(n,i,s,o){if($=te.executionAsyncId(),e.active){if(e._contexts.set(n,e.active),le){let a=" ".repeat(e._indent<0?0:e._indent);ie(`${a}INIT [${i}] (${t}) asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${o}`)}}else if($===0){let a=te.triggerAsyncId(),c=e._contexts.get(a);if(c){if(e._contexts.set(n,c),le){let l=" ".repeat(e._indent<0?0:e._indent);ie(`${l}INIT USING CONTEXT FROM TRIGGERID [${i}] (${t}) asyncId:${n} currentUid:${$} triggerId:${a} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${o}`)}}else if(le){let l=" ".repeat(e._indent<0?0:e._indent);ie(`${l}INIT MISSING CONTEXT [${i}] (${t}) asyncId:${n} currentUid:${$} triggerId:${a} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${o}`)}}if(le&&i==="PROMISE"){ie(H.inspect(o,{showHidden:!0}));let a=o.parentId,c=" ".repeat(e._indent<0?0:e._indent);ie(`${c}INIT RESOURCE-PROMISE [${i}] (${t}) parentId:${a} asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${o}`)}},before(n){$=te.executionAsyncId();let i;if(i=e._contexts.get(n)||e._contexts.get($),i){if(le){let s=te.triggerAsyncId(),o=" ".repeat(e._indent<0?0:e._indent);ie(`${o}BEFORE (${t}) asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`),e._indent+=2}e.enter(i)}else if(le){let s=te.triggerAsyncId(),o=" ".repeat(e._indent<0?0:e._indent);ie(`${o}BEFORE MISSING CONTEXT (${t}) asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${H.inspect(e._contexts,{showHidden:!0,depth:2,colors:!0})}`),e._indent+=2}},after(n){$=te.executionAsyncId();let i;if(i=e._contexts.get(n)||e._contexts.get($),i){if(le){let s=te.triggerAsyncId();e._indent-=2;let o=" ".repeat(e._indent<0?0:e._indent);ie(`${o}AFTER (${t}) asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`)}e.exit(i)}else if(le){let s=te.triggerAsyncId();e._indent-=2;let o=" ".repeat(e._indent<0?0:e._indent);ie(`${o}AFTER MISSING CONTEXT (${t}) asyncId:${n} currentUid:${$} triggerId:${s} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`)}},destroy(n){if($=te.executionAsyncId(),le){let i=te.triggerAsyncId(),s=" ".repeat(e._indent<0?0:e._indent);ie(`${s}DESTROY (${t}) currentUid:${$} asyncId:${n} triggerId:${i} active:${H.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(e._contexts.get($))}`)}e._contexts.delete(n)}}).enable(),process.namespaces[t]=e,e}function Fm(t){let e=Lm(t);Mt.ok(e,`can't delete nonexistent namespace! "`+t+'"'),Mt.ok(e.id,"don't assign to process.namespaces directly! "+H.inspect(e)),process.namespaces[t]=null}function nS(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){Fm(t)}),process.namespaces=Object.create(null)}process.namespaces={};function ie(...t){le&&process._rawDebug(`${H.format(...t)}`)}});var Hm=p((Hk,$m)=>{"use strict";function iS(){}$m.exports=function(){let e=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let c=0;c<arguments.length;c++)i[c]=arguments[c];let s=i[0];if(typeof s!="function")throw new TypeError("callback is not a function");let o=new iS,a=--r.counter;return e.init.call(o,a,0,null,null),i[0]=function(){e.pre.call(o,a);let c=!0;try{s.apply(this,arguments),c=!1}finally{c&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(o,a,!0),e.destroy.call(null,a)})}e.post.call(o,a,!1),e.destroy.call(null,a)},n.apply(process,i)}}});var Bm=p((Uk,Um)=>{"use strict";function sS(){}Um.exports=function(){let e=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=c;function s(l,u,f,d){return typeof l!="function"?d?o(f):a(f):function(){e.pre.call(u,f);try{return l.apply(this,arguments)}finally{e.post.call(u,f,!1),e.destroy.call(null,f)}}}function o(l){return function(f){return e.destroy.call(null,l),f}}function a(l){return function(f){throw e.destroy.call(null,l),f}}function c(l,u){if(!r.enabled)return i.call(this,l,u);let f=new sS,d=--r.counter;return e.init.call(f,d,0,null,null),i.call(this,s(l,f,d,!0),s(u,f,d,!1))}}});var Vm=p((Bk,Gm)=>{"use strict";var st=require("timers");function oS(){}function aS(){}function cS(){}var uS=new Map,lS=new Map,fS=new Map,mc=null,gc=!1;Gm.exports=function(){vc(this._hooks,this._state,"setTimeout","clearTimeout",oS,uS,!0),vc(this._hooks,this._state,"setInterval","clearInterval",aS,lS,!1),vc(this._hooks,this._state,"setImmediate","clearImmediate",cS,fS,!0),global.setTimeout=st.setTimeout,global.setInterval=st.setInterval,global.setImmediate=st.setImmediate,global.clearTimeout=st.clearTimeout,global.clearInterval=st.clearInterval,global.clearImmediate=st.clearImmediate};function vc(t,e,r,n,i,s,o){let a=st[r],c=st[n];st[r]=function(){if(!e.enabled)return a.apply(st,arguments);let l=new Array(arguments.length);for(let m=0;m<arguments.length;m++)l[m]=arguments[m];let u=l[0];if(typeof u!="function")throw new TypeError('"callback" argument must be a function');let f=new i,d=--e.counter,h;return t.init.call(f,d,0,null,null),l[0]=function(){mc=h,t.pre.call(f,d);let m=!0;try{u.apply(this,arguments),m=!1}finally{m&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(f,d,!0),s.delete(h),t.destroy.call(null,d)})}t.post.call(f,d,!1),mc=null,(o||gc)&&(gc=!1,s.delete(h),t.destroy.call(null,d))},h=a.apply(st,l),s.set(h,d),h},st[n]=function(l){if(mc===l&&l!==null)gc=!0;else if(s.has(l)){let u=s.get(l);s.delete(l),t.destroy.call(null,u)}c.apply(st,arguments)}}});var yc=p((Gk,dS)=>{dS.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var Xm=p((Vk,zm)=>{"use strict";var pi=process.binding("async_wrap"),hS=pi.Providers.TIMERWRAP,Wm={nextTick:Hm(),promise:Bm(),timers:Vm()},hi=new Set;function pS(){this.enabled=!1,this.counter=0}function _c(){let t=this.initFns=[],e=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,s,o,a){if(s===hS){hi.add(i);return}for(let c of t)c(i,this,s,o,a)},this.pre=function(i){if(!hi.has(i))for(let s of e)s(i,this)},this.post=function(i,s){if(!hi.has(i))for(let o of r)o(i,this,s)},this.destroy=function(i){if(hi.has(i)){hi.delete(i);return}for(let s of n)s(i)}}_c.prototype.add=function(t){t.init&&this.initFns.push(t.init),t.pre&&this.preFns.push(t.pre),t.post&&this.postFns.push(t.post),t.destroy&&this.destroyFns.push(t.destroy)};function Ys(t,e){let r=t.indexOf(e);r!==-1&&t.splice(r,1)}_c.prototype.remove=function(t){t.init&&Ys(this.initFns,t.init),t.pre&&Ys(this.preFns,t.pre),t.post&&Ys(this.postFns,t.post),t.destroy&&Ys(this.destroyFns,t.destroy)};function mi(){this._state=new pS,this._hooks=new _c,this.version=yc().version,this.providers=pi.Providers;for(let t of Object.keys(Wm))Wm[t].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),pi.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}zm.exports=mi;mi.prototype.addHooks=function(t){this._hooks.add(t)};mi.prototype.removeHooks=function(t){this._hooks.remove(t)};mi.prototype.enable=function(){this._state.enabled=!0,pi.enable()};mi.prototype.disable=function(){this._state.enabled=!1,pi.disable()}});var Ec=p((Wk,mS)=>{mS.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var Ym=p((zk,Qm)=>{function gS(t){try{return Error.prototype.toString.call(t)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}Qm.exports=function(e,r){var n=[];n.push(gS(e));for(var i=0;i<r.length;i++){var s=r[i],o;try{o=s.toString()}catch(a){try{o="<error: "+a+">"}catch{o="<error>"}}n.push("    at "+o)}return n.join(`
`)}});var eg=p((Xk,Zm)=>{var Ks=Ym();function Jm(){this.extend=new gi,this.filter=new gi,this.format=new vi,this.version=Ec().version}var Cc=!1;Jm.prototype.callSite=function t(e){e||(e={}),Cc=!0;var r={};Error.captureStackTrace(r,t);var n=r.stack;return Cc=!1,n=n.slice(e.slice||0),e.extend&&(n=this.extend._modify(r,n)),e.filter&&(n=this.filter._modify(r,n)),n};var Kt=new Jm;function gi(){this._modifiers=[]}gi.prototype._modify=function(t,e){for(var r=0,n=this._modifiers.length;r<n;r++)e=this._modifiers[r](t,e);return e};gi.prototype.attach=function(t){this._modifiers.push(t)};gi.prototype.deattach=function(t){var e=this._modifiers.indexOf(t);return e===-1?!1:(this._modifiers.splice(e,1),!0)};function vi(){this._formater=Ks,this._previous=void 0}vi.prototype.replace=function(t){t?this._formater=t:this.restore()};vi.prototype.restore=function(){this._formater=Ks,this._previous=void 0};vi.prototype._backup=function(){this._previous=this._formater};vi.prototype._roolback=function(){this._previous===Ks?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&Kt.format.replace(Error.prepareStackTrace);var wc=!1;function Km(t,e){if(Cc)return e;if(wc)return Ks(t,e);var r=e.concat();r=Kt.extend._modify(t,r),r=Kt.filter._modify(t,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(t)&&Object.getOwnPropertyDescriptor(t,"callSite")===void 0&&(t.callSite={original:e,mutated:r}),wc=!0;var n=Kt.format._formater(t,r);return wc=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return Km},set:function(t){t===Km?Kt.format._roolback():(Kt.format._backup(),Kt.format.replace(t))}});function vS(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:vS,set:function(t){Object.defineProperty(this,"callSite",{value:t,writable:!0,configurable:!0})},configurable:!0});Zm.exports=Kt});var Tc=p((Qk,xc)=>{if(global._stackChain)if(global._stackChain.version===Ec().version)xc.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else xc.exports=global._stackChain=eg()});var tg=p((Yk,Sc)=>{"use strict";var yS=Xm();if(global._asyncHook)if(global._asyncHook.version===yc().version)Sc.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else Tc().filter.attach(function(e,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),Sc.exports=global._asyncHook=new yS});var ag=p((Kk,og)=>{"use strict";var ge=require("util"),jt=require("assert"),_S=Qs(),un=tg(),yi="cls@contexts",_i="error@context",ng=[];for(let t in un.providers)ng[un.providers[t]]=t;var he=process.env.DEBUG_CLS_HOOKED,we=-1;og.exports={getNamespace:ig,createNamespace:ES,destroyNamespace:sg,reset:wS,ERROR_SYMBOL:_i};function mt(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map}mt.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return he&&me("    SETTING KEY:"+e+"="+r+" in ns:"+this.name+" uid:"+we+" active:"+ge.inspect(this.active,!0)),this.active[e]=r,r};mt.prototype.get=function(e){if(!this.active){he&&me("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+we+" active:"+ge.inspect(this.active,!0));return}return he&&me("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+we+" active:"+ge.inspect(this.active,!0)),this.active[e]};mt.prototype.createContext=function(){he&&me("   CREATING Context: "+this.name+" uid:"+we+" len:"+this._set.length+"  active:"+ge.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=we,he&&me("   CREATED Context: "+this.name+" uid:"+we+" len:"+this._set.length+"  context:"+ge.inspect(e,!0,2,!0)),e};mt.prototype.run=function(e){let r=this.createContext();this.enter(r);try{return he&&me(" BEFORE RUN: "+this.name+" uid:"+we+" len:"+this._set.length+" "+ge.inspect(r)),e(r),r}catch(n){throw n&&(n[_i]=r),n}finally{he&&me(" AFTER RUN: "+this.name+" uid:"+we+" len:"+this._set.length+" "+ge.inspect(r)),this.exit(r)}};mt.prototype.runAndReturn=function(e){var r;return this.run(function(n){r=e(n)}),r};mt.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return he&&me(" BEFORE runPromise: "+this.name+" uid:"+we+" len:"+this._set.length+" "+ge.inspect(r)),n.then(i=>(he&&me(" AFTER runPromise: "+this.name+" uid:"+we+" len:"+this._set.length+" "+ge.inspect(r)),this.exit(r),i)).catch(i=>{throw i[_i]=r,he&&me(" AFTER runPromise: "+this.name+" uid:"+we+" len:"+this._set.length+" "+ge.inspect(r)),this.exit(r),i})};mt.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[_i]=r),s}finally{n.exit(r)}}};mt.prototype.enter=function(e){jt.ok(e,"context must be provided for entering"),he&&me("  ENTER "+this.name+" uid:"+we+" len:"+this._set.length+" context: "+ge.inspect(e)),this._set.push(this.active),this.active=e};mt.prototype.exit=function(e){if(jt.ok(e,"context must be provided for exiting"),he&&me("  EXIT "+this.name+" uid:"+we+" len:"+this._set.length+" context: "+ge.inspect(e)),this.active===e){jt.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(he&&me("??ERROR?? context exiting but not entered - ignoring: "+ge.inspect(e)),jt.ok(r>=0,`context not currently entered; can't exit. 
`+ge.inspect(this)+`
`+ge.inspect(e))):(jt.ok(r,"can't remove top context"),this._set.splice(r,1))};mt.prototype.bindEmitter=function(e){jt.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(o){!o||(o[yi]||(o[yi]=Object.create(null)),o[yi][n]={namespace:r,context:r.active})}function s(o){if(!(o&&o[yi]))return o;let a=o,c=o[yi];return Object.keys(c).forEach(function(l){let u=c[l];a=u.namespace.bind(a,u.context)}),a}_S(e,i,s)};mt.prototype.fromException=function(e){return e[_i]};function ig(t){return process.namespaces[t]}function ES(t){jt.ok(t,"namespace must be given a name."),he&&me("CREATING NAMESPACE "+t);let e=new mt(t);return e.id=we,un.addHooks({init(r,n,i,s,o){we=r,s?(e._contexts.set(r,e._contexts.get(s)),he&&me("PARENTID: "+t+" uid:"+r+" parent:"+s+" provider:"+i)):e._contexts.set(we,e.active),he&&me("INIT "+t+" uid:"+r+" parent:"+s+" provider:"+ng[i]+" active:"+ge.inspect(e.active,!0))},pre(r,n){we=r;let i=e._contexts.get(r);i?(he&&me(" PRE "+t+" uid:"+r+" handle:"+Js(n)+" context:"+ge.inspect(i)),e.enter(i)):he&&me(" PRE MISSING CONTEXT "+t+" uid:"+r+" handle:"+Js(n))},post(r,n){we=r;let i=e._contexts.get(r);i?(he&&me(" POST "+t+" uid:"+r+" handle:"+Js(n)+" context:"+ge.inspect(i)),e.exit(i)):he&&me(" POST MISSING CONTEXT "+t+" uid:"+r+" handle:"+Js(n))},destroy(r){we=r,he&&me("DESTROY "+t+" uid:"+r+" context:"+ge.inspect(e._contexts.get(we))+" active:"+ge.inspect(e.active,!0)),e._contexts.delete(r)}}),process.namespaces[t]=e,e}function sg(t){let e=ig(t);jt.ok(e,`can't delete nonexistent namespace! "`+t+'"'),jt.ok(e.id,"don't assign to process.namespaces directly! "+ge.inspect(e)),process.namespaces[t]=null}function wS(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){sg(t)}),process.namespaces=Object.create(null)}process.namespaces={};un._state&&!un._state.enabled&&un.enable();function me(t){process.env.DEBUG&&process._rawDebug(t)}function Js(t){if(!t)return t;if(typeof t=="function")return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(t.constructor&&t.constructor.name)return t.constructor.name}if(he){bc=Tc();for(rg in bc.filter._modifiers)bc.filter.deattach(rg)}var bc,rg});var cg=p((Jk,Ic)=>{"use strict";var CS=Ms();process&&CS.gte(process.versions.node,"8.0.0")?Ic.exports=jm():Ic.exports=ag()});var fg=p((Zk,lg)=>{var xS=Ws().wrap,Ac=1<<0,Oc=1<<1,kc=1<<2,eo=1<<3,Y=[],TS=0,$e=!1,Jt=[],ln,Dc;function Pc(t,e){var r=t.length,n=e.length,i=[];if(r===0&&n===0)return i;for(var s=0;s<r;s++)i[s]=t[s];if(n===0)return i;for(var o=0;o<n;o++){var a=!0;for(s=0;s<r;s++)if(t[s].uid===e[o].uid){a=!1;break}a&&i.push(e[o])}return i}process._fatalException?(Zs=!1,ln=function(e){var r=Y.length;if(Zs||r===0)return!1;var n=!1;Zs=!0;for(var i=0;i<r;++i){var s=Y[i];if((s.flags&eo)!==0){var o=fn&&fn[s.uid];n=s.error(o,e)||n}}return Zs=!1,Jt.length>0&&(Y=Jt.pop()),fn=void 0,n&&!$e},Dc=function(e,r,n){var i=[];$e=!0;for(var s=0;s<n;++s){var o=r[s];if(i[o.uid]=o.data,(o.flags&Ac)!==0){var a=o.create(o.data);a!==void 0&&(i[o.uid]=a)}}return $e=!1,function(){fn=i,Jt.push(Y),Y=Pc(r,Y),$e=!0;for(var c=0;c<n;++c)(r[c].flags&Oc)>0&&r[c].before(this,i[r[c].uid]);$e=!1;var l=e.apply(this,arguments);for($e=!0,c=0;c<n;++c)(r[c].flags&kc)>0&&r[c].after(this,i[r[c].uid]);return $e=!1,Y=Jt.pop(),fn=void 0,l}},xS(process,"_fatalException",function(t){return function(r){return ln(r)||t(r)}})):(Rc=!1,ln=function(e){if(Rc)throw e;for(var r=!1,n=Y.length,i=0;i<n;++i){var s=Y[i];(s.flags&eo)!==0&&(r=s.error(null,e)||r)}if(!r&&$e)throw e},Dc=function(e,r,n){var i=[];$e=!0;for(var s=0;s<n;++s){var o=r[s];if(i[o.uid]=o.data,(o.flags&Ac)!==0){var a=o.create(o.data);a!==void 0&&(i[o.uid]=a)}}return $e=!1,function(){var c=!1,l=!1;Jt.push(Y),Y=Pc(r,Y),$e=!0;for(var u=0;u<n;++u)(r[u].flags&Oc)>0&&r[u].before(this,i[r[u].uid]);$e=!1;var f;try{f=e.apply(this,arguments)}catch(d){c=!0;for(var u=0;u<n;++u)if((Y[u].flags&eo)!=0)try{l=Y[u].error(i[r[u].uid],d)||l}catch(m){throw Rc=!0,m}if(!l)throw process.removeListener("uncaughtException",ln),process._originalNextTick(function(){process.addListener("uncaughtException",ln)}),d}finally{if(!c||l){for($e=!0,u=0;u<n;++u)(r[u].flags&kc)>0&&r[u].after(this,i[r[u].uid]);$e=!1}Y=Jt.pop()}return f}},process.addListener("uncaughtException",ln));var Zs,fn,Rc;function SS(t,e,r){$e=!0;for(var n=0;n<r;++n){var i=e[n];i.create&&i.create(i.data)}return $e=!1,function(){Jt.push(Y),Y=Pc(e,Y);var s=t.apply(this,arguments);return Y=Jt.pop(),s}}function bS(t){var e=Y.length;if(e===0)return t;for(var r=Y.slice(),n=0;n<e;++n)if(r[n].flags>0)return Dc(t,r,e);return SS(t,r,e)}function At(t,e){typeof t.create=="function"&&(this.create=t.create,this.flags|=Ac),typeof t.before=="function"&&(this.before=t.before,this.flags|=Oc),typeof t.after=="function"&&(this.after=t.after,this.flags|=kc),typeof t.error=="function"&&(this.error=t.error,this.flags|=eo),this.uid=++TS,this.data=e===void 0?null:e}At.prototype.create=void 0;At.prototype.before=void 0;At.prototype.after=void 0;At.prototype.error=void 0;At.prototype.data=void 0;At.prototype.uid=0;At.prototype.flags=0;function ug(t,e){if(typeof t!="object"||!t)throw new TypeError("callbacks argument must be an object");return t instanceof At?t:new At(t,e)}function IS(t,e){var r;t instanceof At?r=t:r=ug(t,e);for(var n=!1,i=0;i<Y.length;i++)if(r===Y[i]){n=!0;break}return n||Y.push(r),r}function RS(t){for(var e=0;e<Y.length;e++)if(t===Y[e]){Y.splice(e,1);break}}process.createAsyncListener=ug;process.addAsyncListener=IS;process.removeAsyncListener=RS;lg.exports=bS});var hg=p((tD,dg)=>{"use strict";dg.exports=(t,e)=>class extends t{constructor(n){var i,s;super(a);var o=this;try{n.apply(i,s)}catch(c){s[1](c)}return o;function a(c,l){i=this,s=[u,f];function u(d){return e(o,!1),c(d)}function f(d){return e(o,!1),l(d)}}}}});var Eg=p(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var vg=Ws(),ro=Ms(),Ze=vg.wrap,Zt=vg.massWrap,fe=fg(),AS=require("util"),OS=ro.gte(process.version,"6.0.0"),Lc=ro.gte(process.version,"7.0.0"),kS=ro.gte(process.version,"8.0.0"),DS=ro.gte(process.version,"11.0.0"),Ot=require("net");Lc&&!Ot._normalizeArgs?Ot._normalizeArgs=function(t){if(t.length===0)return[{},null];var e=t[0],r={};typeof e=="object"&&e!==null?r=e:FS(e)?r.path=e:(r.port=e,t.length>1&&typeof t[1]=="string"&&(r.host=t[1]));var n=t[t.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Lc&&!Ot._normalizeConnectArgs&&(Ot._normalizeConnectArgs=function(t){var e={};function r(i){return(i=Number(i))>=0?i:!1}typeof t[0]=="object"&&t[0]!==null?e=t[0]:typeof t[0]=="string"&&r(t[0])===!1?e.path=t[0]:(e.port=t[0],typeof t[1]=="string"&&(e.host=t[1]));var n=t[t.length-1];return typeof n=="function"?[e,n]:[e]});"_setUpListenHandle"in Ot.Server.prototype?Ze(Ot.Server.prototype,"_setUpListenHandle",pg):Ze(Ot.Server.prototype,"_listen2",pg);function pg(t){return function(){this.on("connection",function(e){e._handle&&(e._handle.onread=fe(e._handle.onread))});try{return t.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=fe(this._handle.onconnection))}}}function yg(t){if(t&&t._handle){var e=t._handle;e._originalOnread||(e._originalOnread=e.onread),e.onread=fe(e._originalOnread)}}Ze(Ot.Socket.prototype,"connect",function(t){return function(){var e;kS&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?e=arguments[0]:e=Lc?Ot._normalizeArgs(arguments):Ot._normalizeConnectArgs(arguments),e[1]&&(e[1]=fe(e[1]));var r=t.apply(this,e);return yg(this),r}});var PS=require("http");Ze(PS.Agent.prototype,"addRequest",function(t){return function(e){var r=e.onSocket;return e.onSocket=fe(function(n){return yg(n),r.apply(this,arguments)}),t.apply(this,arguments)}});var qc=require("child_process");function mg(t){Array.isArray(t.stdio)&&t.stdio.forEach(function(e){e&&e._handle&&(e._handle.onread=fe(e._handle.onread),Ze(e._handle,"close",no))}),t._handle&&(t._handle.onexit=fe(t._handle.onexit))}qc.ChildProcess?Ze(qc.ChildProcess.prototype,"spawn",function(t){return function(){var e=t.apply(this,arguments);return mg(this),e}}):Zt(qc,["execFile","fork","spawn"],function(t){return function(){var e=t.apply(this,arguments);return mg(e),e}});process._fatalException||(process._originalNextTick=process.nextTick);var jc=[];process._nextDomainTick&&jc.push("_nextDomainTick");process._tickDomainCallback&&jc.push("_tickDomainCallback");Zt(process,jc,kt);Ze(process,"nextTick",no);var $c=["setTimeout","setInterval"];global.setImmediate&&$c.push("setImmediate");var _g=require("timers"),qS=global.setTimeout===_g.setTimeout;Zt(_g,$c,no);qS&&Zt(global,$c,no);var Fc=require("dns");Zt(Fc,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],kt);Fc.resolveNaptr&&Ze(Fc,"resolveNaptr",kt);var Sr=require("fs");Zt(Sr,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],kt);Sr.lchown&&Ze(Sr,"lchown",kt);Sr.lchmod&&Ze(Sr,"lchmod",kt);Sr.ftruncate&&Ze(Sr,"ftruncate",kt);var Ei;try{Ei=require("zlib")}catch{}Ei&&Ei.Deflate&&Ei.Deflate.prototype&&(Tr=Object.getPrototypeOf(Ei.Deflate.prototype),Tr._transform?Ze(Tr,"_transform",kt):Tr.write&&Tr.flush&&Tr.end&&Zt(Tr,["write","flush","end"],kt));var Tr,Mc;try{Mc=require("crypto")}catch{}Mc&&(Nc=["pbkdf2","randomBytes"],DS||Nc.push("pseudoRandomBytes"),Zt(Mc,Nc,kt));var Nc,to=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";to&&(gg=process.addAsyncListener({create:function(){to=!1}}),global.Promise.resolve(!0).then(function(){to=!1}),process.removeAsyncListener(gg));var gg;to&&NS();function NS(){var t=global.Promise;function e(o){if(!(this instanceof e))return t(o);if(typeof o!="function")return new t(o);var a,c,l=new t(u);l.__proto__=e.prototype;try{o.apply(a,c)}catch(f){c[1](f)}return l;function u(f,d){a=this,c=[h,m];function h(v){return n(l,!1),f(v)}function m(v){return n(l,!1),d(v)}}}if(AS.inherits(e,t),Ze(t.prototype,"then",s),t.prototype.chain&&Ze(t.prototype,"chain",s),OS)global.Promise=hg()(t,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(o){typeof t[o]=="function"&&(e[o]=t[o])}),global.Promise=e}function n(o,a){(!o.__asl_wrapper||a)&&(o.__asl_wrapper=fe(i))}function i(o,a,c,l){var u;try{return u=a.call(o,c),{returnVal:u,error:!1}}catch(f){return{errorVal:f,error:!0}}finally{u instanceof t?l.__asl_wrapper=function(){var d=u.__asl_wrapper||i;return d.apply(this,arguments)}:n(l,!0)}}function s(o){return function(){var c=this,l=o.apply(c,Array.prototype.map.call(arguments,u));return l.__asl_wrapper=function(d,h,m,v){return c.__asl_wrapper?(c.__asl_wrapper(d,function(){},null,l),l.__asl_wrapper(d,h,m,v)):i(d,h,m,v)},l;function u(f){return typeof f!="function"?f:fe(function(d){var h=(c.__asl_wrapper||i)(this,f,d,l);if(h.error)throw h.errorVal;return h.returnVal})}}}}function kt(t){var e=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=fe(arguments[n])}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof n=="function"&&(n=fe(n)),t.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?e.apply(this,arguments):(typeof i=="function"&&(i=fe(i)),t.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?e.apply(this,arguments):(typeof s=="function"&&(s=fe(s)),t.call(this,r,n,i,s))};case 5:return function(r,n,i,s,o){return arguments.length!==5?e.apply(this,arguments):(typeof o=="function"&&(o=fe(o)),t.call(this,r,n,i,s,o))};case 6:return function(r,n,i,s,o,a){return arguments.length!==6?e.apply(this,arguments):(typeof a=="function"&&(a=fe(a)),t.call(this,r,n,i,s,o,a))};default:return e}}function no(t){var e=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=fe(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r,n,i,s))};case 5:return function(r,n,i,s,o){return arguments.length!==5?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r,n,i,s,o))};case 6:return function(r,n,i,s,o,a){return arguments.length!==6?e.apply(this,arguments):(typeof r=="function"&&(r=fe(r)),t.call(this,r,n,i,s,o,a))};default:return e}}function LS(t){return(t=Number(t))>=0?t:!1}function FS(t){return typeof t=="string"&&LS(t)===!1}});var Sg=p((iD,Tg)=>{"use strict";var $t=require("assert"),MS=Qs(),wi="cls@contexts",Hc="error@context";process.addAsyncListener||Eg();function wt(t){this.name=t,this.active=null,this._set=[],this.id=null}wt.prototype.set=function(t,e){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[t]=e,e};wt.prototype.get=function(t){if(!!this.active)return this.active[t]};wt.prototype.createContext=function(){return Object.create(this.active)};wt.prototype.run=function(t){var e=this.createContext();this.enter(e);try{return t(e),e}catch(r){throw r&&(r[Hc]=e),r}finally{this.exit(e)}};wt.prototype.runAndReturn=function(t){var e;return this.run(function(r){e=t(r)}),e};wt.prototype.bind=function(t,e){e||(this.active?e=this.active:e=this.createContext());var r=this;return function(){r.enter(e);try{return t.apply(this,arguments)}catch(n){throw n&&(n[Hc]=e),n}finally{r.exit(e)}}};wt.prototype.enter=function(t){$t.ok(t,"context must be provided for entering"),this._set.push(this.active),this.active=t};wt.prototype.exit=function(t){if($t.ok(t,"context must be provided for exiting"),this.active===t){$t.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var e=this._set.lastIndexOf(t);$t.ok(e>=0,"context not currently entered; can't exit"),$t.ok(e,"can't remove top context"),this._set.splice(e,1)};wt.prototype.bindEmitter=function(t){$t.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");var e=this,r="context@"+this.name;function n(s){!s||(s[wi]||(s[wi]=Object.create(null)),s[wi][r]={namespace:e,context:e.active})}function i(s){if(!(s&&s[wi]))return s;var o=s,a=s[wi];return Object.keys(a).forEach(function(c){var l=a[c];o=l.namespace.bind(o,l.context)}),o}MS(t,n,i)};wt.prototype.fromException=function(t){return t[Hc]};function wg(t){return process.namespaces[t]}function jS(t){$t.ok(t,"namespace must be given a name!");var e=new wt(t);return e.id=process.addAsyncListener({create:function(){return e.active},before:function(r,n){n&&e.enter(n)},after:function(r,n){n&&e.exit(n)},error:function(r){r&&e.exit(r)}}),process.namespaces[t]=e,e}function Cg(t){var e=wg(t);$t.ok(e,"can't delete nonexistent namespace!"),$t.ok(e.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(e.id),process.namespaces[t]=null}function xg(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){Cg(t)}),process.namespaces=Object.create(null)}process.namespaces||xg();Tg.exports={getNamespace:wg,createNamespace:jS,destroyNamespace:Cg,reset:xg}});var dn=p(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});var $S=Pe(),HS=Vs(),US=function(){function t(){}return t.getCurrentContext=function(){if(!t.enabled)return null;var e=t.session.get(t.CONTEXT_NAME);return e===void 0?null:e},t.generateContextObject=function(e,r,n,i,s,o){return r=r||e,this.enabled?{operation:{name:n,id:e,parentId:r,traceparent:s,tracestate:o},customProperties:new BS(i)}:null},t.runWithContext=function(e,r){if(t.enabled)return t.session.bind(r,(n={},n[t.CONTEXT_NAME]=e,n))();return r();var n},t.wrapEmitter=function(e){t.enabled&&t.session.bindEmitter(e)},t.wrapCallback=function(e){return t.enabled?t.session.bind(e):e},t.enable=function(e){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}t.hasEverEnabled||(this.forceClsHooked=e,this.hasEverEnabled=!0,typeof this.cls>"u"&&(t.forceClsHooked===!0||t.forceClsHooked===void 0&&t.shouldUseClsHooked()?this.cls=cg():this.cls=Sg()),t.session=this.cls.createNamespace("AI-CLS-Session"),HS.registerContextPreservation(function(r){return t.session.bind(r)})),this.enabled=!0}},t.disable=function(){this.enabled=!1},t.reset=function(){t.hasEverEnabled&&(t.session=null,t.session=this.cls.createNamespace("AI-CLS-Session"))},t.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},t.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},t.canUseClsHooked=function(){var e=process.versions.node.split("."),r=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,n=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,i=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(r&&n)&&i},t.enabled=!1,t.hasEverEnabled=!1,t.forceClsHooked=void 0,t.CONTEXT_NAME="ApplicationInsights-Context",t}();Uc.CorrelationContextManager=US;var BS=function(){function t(e){this.props=[],this.addHeaderData(e)}return t.prototype.addHeaderData=function(e){var r=e?e.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},t.prototype.serializeToHeader=function(){return this.props.map(function(e){return e.key+"="+e.value}).join(", ")},t.prototype.getProperty=function(e){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===e)return n.value}},t.prototype.setProperty=function(e,r){if(t.bannedCharacters.test(e)||t.bannedCharacters.test(r)){$S.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+e+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===e){i.value=r;return}}this.props.push({key:e,value:r})},t.bannedCharacters=/[,=]/,t}()});var Ht=p((oD,bg)=>{"use strict";var GS=function(){function t(){}return t}();bg.exports=GS});var Rg=p((Bc,Ig)=>{"use strict";var VS=Bc&&Bc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),WS=Ht(),zS=function(t){VS(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(WS);Ig.exports=zS});var Gc=p((aD,Ag)=>{"use strict";var XS=function(){function t(){}return t}();Ag.exports=XS});var kg=p((cD,Og)=>{"use strict";var QS=function(){function t(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return t}();Og.exports=QS});var Pg=p((Vc,Dg)=>{"use strict";var YS=Vc&&Vc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),KS=Gc(),JS=function(t){YS(e,t);function e(){return t.call(this)||this}return e}(KS);Dg.exports=JS});var zc=p((uD,qg)=>{"use strict";var Wc;(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(Wc||(Wc={}));qg.exports=Wc});var Lg=p((lD,Ng)=>{"use strict";var ZS=zc(),eb=function(){function t(){this.kind=ZS.Measurement}return t}();Ng.exports=eb});var Mg=p((fD,Fg)=>{"use strict";var tb=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();Fg.exports=tb});var Qc=p((Xc,jg)=>{"use strict";var rb=Xc&&Xc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nb=Ht(),ib=function(t){rb(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(nb);jg.exports=ib});var Hg=p((Yc,$g)=>{"use strict";var sb=Yc&&Yc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ob=Ht(),ab=function(t){sb(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return e}(ob);$g.exports=ab});var Bg=p((dD,Ug)=>{"use strict";var cb=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return t}();Ug.exports=cb});var Vg=p((Kc,Gg)=>{"use strict";var ub=Kc&&Kc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lb=Ht(),fb=function(t){ub(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r}return e}(lb);Gg.exports=fb});var zg=p((Jc,Wg)=>{"use strict";var db=Jc&&Jc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hb=Ht(),pb=function(t){db(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return e}(hb);Wg.exports=pb});var Qg=p((Zc,Xg)=>{"use strict";var mb=Zc&&Zc.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gb=Qc(),vb=function(t){mb(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(gb);Xg.exports=vb});var Kg=p((eu,Yg)=>{"use strict";var yb=eu&&eu.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_b=Ht(),Eb=function(t){yb(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return e}(_b);Yg.exports=Eb});var Zg=p((tu,Jg)=>{"use strict";var wb=tu&&tu.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cb=Ht(),xb=function(t){wb(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(Cb);Jg.exports=xb});var tv=p((hD,ev)=>{"use strict";var ru;(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(ru||(ru={}));ev.exports=ru});var nv=p((pD,rv)=>{"use strict";var Tb=function(){function t(){}return t}();rv.exports=Tb});var nu=p(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.AvailabilityData=Rg();Ce.Base=Gc();Ce.ContextTagKeys=kg();Ce.Data=Pg();Ce.DataPoint=Lg();Ce.DataPointType=zc();Ce.Domain=Ht();Ce.Envelope=Mg();Ce.EventData=Qc();Ce.ExceptionData=Hg();Ce.ExceptionDetails=Bg();Ce.MessageData=Vg();Ce.MetricData=zg();Ce.PageViewData=Qg();Ce.RemoteDependencyData=Kg();Ce.RequestData=Zg();Ce.SeverityLevel=tv();Ce.StackFrame=nv()});var iv=p(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});var br=nu(),Sb=function(){function t(){}return t.TYPE_HTTP="Http",t.TYPE_AI="Http (tracked component)",t}();io.RemoteDependencyDataConstants=Sb;function bb(t){return"properties"in t||t instanceof br.EventData||t instanceof br.ExceptionData||t instanceof br.MessageData||t instanceof br.MetricData||t instanceof br.PageViewData||t instanceof br.RemoteDependencyData||t instanceof br.RequestData}io.domainSupportsProperties=bb});var sv=p(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});function Ib(t){switch(t){case Xe.Event:return"EventData";case Xe.Exception:return"ExceptionData";case Xe.Trace:return"MessageData";case Xe.Metric:return"MetricData";case Xe.Request:return"RequestData";case Xe.Dependency:return"RemoteDependencyData";case Xe.Availability:return"AvailabilityData"}}Ir.telemetryTypeToBaseType=Ib;function Rb(t){switch(t){case"EventData":return Xe.Event;case"ExceptionData":return Xe.Exception;case"MessageData":return Xe.Trace;case"MetricData":return Xe.Metric;case"RequestData":return Xe.Request;case"RemoteDependencyData":return Xe.Dependency;case"AvailabilityData":return Xe.Availability}}Ir.baseTypeToTelemetryType=Rb;Ir.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData"};var Xe;(function(t){t[t.Event=0]="Event",t[t.Exception=1]="Exception",t[t.Trace=2]="Trace",t[t.Metric=3]="Metric",t[t.Request=4]="Request",t[t.Dependency=5]="Dependency",t[t.Availability=6]="Availability"})(Xe=Ir.TelemetryType||(Ir.TelemetryType={}))});var ov=p(so=>{"use strict";function Ab(t){for(var e in t)so.hasOwnProperty(e)||(so[e]=t[e])}Object.defineProperty(so,"__esModule",{value:!0});Ab(sv())});var ot=p(oo=>{"use strict";function iu(t){for(var e in t)oo.hasOwnProperty(e)||(oo[e]=t[e])}Object.defineProperty(oo,"__esModule",{value:!0});iu(iv());iu(nu());iu(ov())});var cv=p(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});var av=ot(),su=Ee(),Rr=[],ou=function(t){var e=t.data.message;Rr.forEach(function(r){e instanceof Error?r.trackException({exception:e}):(e.lastIndexOf(`
`)==e.length-1&&(e=e.substring(0,e.length-1)),r.trackTrace({message:e,severity:t.data.stderr?av.SeverityLevel.Warning:av.SeverityLevel.Information}))})};function Ob(t,e){t?(Rr.length===0&&su.channel.subscribe("console",ou),Rr.push(e)):(Rr=Rr.filter(function(r){return r!=e}),Rr.length===0&&su.channel.unsubscribe("console",ou))}ao.enable=Ob;function kb(){su.channel.unsubscribe("console",ou),Rr=[]}ao.dispose=kb});var uv=p(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});var hn=ot(),au=Ee(),Ar=[],Db={10:hn.SeverityLevel.Verbose,20:hn.SeverityLevel.Verbose,30:hn.SeverityLevel.Information,40:hn.SeverityLevel.Warning,50:hn.SeverityLevel.Error,60:hn.SeverityLevel.Critical},cu=function(t){var e=t.data.result;Ar.forEach(function(r){var n=Db[t.data.level];e instanceof Error?r.trackException({exception:e}):r.trackTrace({message:e,severity:n})})};function Pb(t,e){t?(Ar.length===0&&au.channel.subscribe("bunyan",cu),Ar.push(e)):(Ar=Ar.filter(function(r){return r!=e}),Ar.length===0&&au.channel.unsubscribe("bunyan",cu))}co.enable=Pb;function qb(){au.channel.unsubscribe("bunyan",cu),Ar=[]}co.dispose=qb});var lv=p(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});var qe=ot(),uu=Ee(),Or=[],Nb={syslog:function(t){var e={emerg:qe.SeverityLevel.Critical,alert:qe.SeverityLevel.Critical,crit:qe.SeverityLevel.Critical,error:qe.SeverityLevel.Error,warning:qe.SeverityLevel.Warning,notice:qe.SeverityLevel.Information,info:qe.SeverityLevel.Information,debug:qe.SeverityLevel.Verbose};return e[t]===void 0?qe.SeverityLevel.Information:e[t]},npm:function(t){var e={error:qe.SeverityLevel.Error,warn:qe.SeverityLevel.Warning,info:qe.SeverityLevel.Information,verbose:qe.SeverityLevel.Verbose,debug:qe.SeverityLevel.Verbose,silly:qe.SeverityLevel.Verbose};return e[t]===void 0?qe.SeverityLevel.Information:e[t]},unknown:function(t){return qe.SeverityLevel.Information}},lu=function(t){var e=t.data.message;Or.forEach(function(r){if(e instanceof Error)r.trackException({exception:e,properties:t.data.meta});else{var n=Nb[t.data.levelKind](t.data.level);r.trackTrace({message:e,severity:n,properties:t.data.meta})}})};function Lb(t,e){t?(Or.length===0&&uu.channel.subscribe("winston",lu),Or.push(e)):(Or=Or.filter(function(r){return r!=e}),Or.length===0&&uu.channel.unsubscribe("winston",lu))}uo.enable=Lb;function Fb(){uu.channel.unsubscribe("winston",lu),Or=[]}uo.dispose=Fb});var dv=p((xD,fv)=>{"use strict";var Mb=Vs(),jb=function(){function t(e){if(t.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=e,t.INSTANCE=this}return t.prototype.enable=function(e,r){Mb.IsInitialized&&(cv().enable(e&&r,this._client),uv().enable(e,this._client),lv().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1,!1)},t._methodNames=["debug","info","log","warn","error"],t}();fv.exports=jb});var pv=p((TD,hv)=>{"use strict";var $b=function(){function t(e){if(t.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e;var r=process.versions.node.split(".");t._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.enable=function(e){var r=this;if(e){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(s,o,a){a===void 0&&(a=new Error(t._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:a}),r._client.flush({isAppCrashing:!0}),s&&o&&process.listeners(o).length===1&&(console.error(a),process.exit(1))};t._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1),process.on(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,t.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1),process.on(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(t._canUseUncaughtExceptionMonitor?process.removeListener(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.INSTANCE=null,t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",t.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",t.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",t._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",t._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",t._canUseUncaughtExceptionMonitor=!1,t}();hv.exports=$b});var pn=p(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";z.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";z.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var He;(function(t){t.COMMITTED_BYTES="\\Memory\\Committed Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",t.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",t.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",t.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",t.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",t.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",t.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(He=z.QuickPulseCounter||(z.QuickPulseCounter={}));var lo;(function(t){t.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",t.AVAILABLE_BYTES="\\Memory\\Available Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",t.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",t.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(lo=z.PerformanceCounter||(z.PerformanceCounter={}));z.PerformanceToQuickPulseCounter=(Ct={},Ct[lo.PROCESSOR_TIME]=He.PROCESSOR_TIME,Ct[lo.REQUEST_RATE]=He.REQUEST_RATE,Ct[lo.REQUEST_DURATION]=He.REQUEST_DURATION,Ct[He.COMMITTED_BYTES]=He.COMMITTED_BYTES,Ct[He.REQUEST_FAILURE_RATE]=He.REQUEST_FAILURE_RATE,Ct[He.DEPENDENCY_RATE]=He.DEPENDENCY_RATE,Ct[He.DEPENDENCY_FAILURE_RATE]=He.DEPENDENCY_FAILURE_RATE,Ct[He.DEPENDENCY_DURATION]=He.DEPENDENCY_DURATION,Ct[He.EXCEPTION_RATE]=He.EXCEPTION_RATE,Ct);z.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability"};z.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument"};z.TelemetryTypeStringToQuickPulseType={EventData:z.QuickPulseType.Event,ExceptionData:z.QuickPulseType.Exception,MessageData:z.QuickPulseType.Trace,MetricData:z.QuickPulseType.Metric,RequestData:z.QuickPulseType.Request,RemoteDependencyData:z.QuickPulseType.Dependency,AvailabilityData:z.QuickPulseType.Availability};z.TelemetryTypeStringToQuickPulseDocumentType={EventData:z.QuickPulseDocumentType.Event,ExceptionData:z.QuickPulseDocumentType.Exception,MessageData:z.QuickPulseDocumentType.Trace,MetricData:z.QuickPulseDocumentType.Metric,RequestData:z.QuickPulseDocumentType.Request,RemoteDependencyData:z.QuickPulseDocumentType.Dependency,AvailabilityData:z.QuickPulseDocumentType.Availability};var Ct});var ho=p((bD,mv)=>{"use strict";var fo=require("os"),gt=pn(),Hb=function(){function t(e,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,this._client=e,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._lastCpus=fo.cpus(),this._lastRequests={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:t._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countRequest=function(e,r){var n;if(!!t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalRequestExecutionTime+=n,r===!1&&t._totalFailedRequestCount++,t._totalRequestCount++}},t.countException=function(){t._totalExceptionCount++},t.countDependency=function(e,r){var n;if(!!t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalDependencyExecutionTime+=n,r===!1&&t._totalFailedDependencyCount++,t._totalDependencyCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},t.prototype._trackCpu=function(){var e=fo.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var r=0,n=0,i=0,s=0,o=0,a=0;!!e&&a<e.length;a++){var c=e[a],l=this._lastCpus[a],u="% cpu("+a+") ",f=c.model,d=c.speed,h=c.times,m=l.times,v=h.user-m.user||0;r+=v;var g=h.sys-m.sys||0;n+=g;var y=h.nice-m.nice||0;i+=y;var E=h.idle-m.idle||0;s+=E;var x=h.irq-m.irq||0;o+=x}var T=void 0;if(typeof process.cpuUsage=="function"){var re=process.cpuUsage(),pe=process.hrtime(),oe=re.user-this._lastAppCpuUsage.user+(re.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var ee=(pe[0]-this._lastHrtime[0])*1e6+(pe[1]-this._lastHrtime[1])/1e3||0;T=100*oe/(ee*e.length)}this._lastAppCpuUsage=re,this._lastHrtime=pe}var w=r+n+i+s+o||1;this._client.trackMetric({name:gt.PerformanceCounter.PROCESSOR_TIME,value:(w-s)/w*100}),this._client.trackMetric({name:gt.PerformanceCounter.PROCESS_TIME,value:T||r/w*100})}this._lastCpus=e},t.prototype._trackMemory=function(){var e=fo.freemem(),r=process.memoryUsage().rss,n=fo.totalmem()-e;this._client.trackMetric({name:gt.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:gt.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:gt.QuickPulseCounter.COMMITTED_BYTES,value:n})},t.prototype._trackNetwork=function(){var e=this._lastRequests,r={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-e.totalRequestCount||0,i=r.totalFailedRequestCount-e.totalFailedRequestCount||0,s=r.time-e.time,o=s/1e3,a=(t._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=t._intervalRequestExecutionTime,s>0){var c=n/o,l=i/o;this._client.trackMetric({name:gt.PerformanceCounter.REQUEST_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:gt.PerformanceCounter.REQUEST_DURATION,value:a}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:gt.QuickPulseCounter.REQUEST_FAILURE_RATE,value:l})}this._lastRequests=r},t.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastDependencies,r={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-e.totalDependencyCount||0,i=r.totalFailedDependencyCount-e.totalFailedDependencyCount||0,s=r.time-e.time,o=s/1e3,a=(t._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=t._intervalDependencyExecutionTime,s>0){var c=n/o,l=i/o;this._client.trackMetric({name:gt.QuickPulseCounter.DEPENDENCY_RATE,value:c}),this._client.trackMetric({name:gt.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:gt.QuickPulseCounter.DEPENDENCY_DURATION,value:a})}this._lastDependencies=r}},t.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastExceptions,r={totalExceptionCount:t._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-e.totalExceptionCount||0,i=r.time-e.time,s=i/1e3;if(i>0){var o=n/s;this._client.trackMetric({name:gt.QuickPulseCounter.EXCEPTION_RATE,value:o})}this._lastExceptions=r}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t._totalRequestCount=0,t._totalFailedRequestCount=0,t._lastRequestExecutionTime=0,t._totalDependencyCount=0,t._totalFailedDependencyCount=0,t._lastDependencyExecutionTime=0,t._totalExceptionCount=0,t._intervalDependencyExecutionTime=0,t._intervalRequestExecutionTime=0,t}();mv.exports=Hb});var mn=p((ID,gv)=>{"use strict";gv.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var xt=p((hu,yv)=>{"use strict";var fu=hu&&hu.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Ub=require("http"),vv=require("https"),du=require("url"),po=require("constants"),Ci=Pe(),gn=mn(),Bb=function(){function t(){}return t.getCookie=function(e,r){var n="";if(e&&e.length&&typeof r=="string")for(var i=e+"=",s=r.split(";"),o=0;o<s.length;o++){var r=s[o];if(r=t.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,s[o].length);break}}return n},t.trim=function(e){return typeof e=="string"?e.replace(/^\s+|\s+$/g,""):""},t.int32ArrayToBase64=function(e){var r=function(a,c){return String.fromCharCode(a>>c&255)},n=function(a){return r(a,24)+r(a,16)+r(a,8)+r(a,0)},i=e.map(n).join(""),s=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),o=s.toString("base64");return o.substr(0,o.indexOf("="))},t.random32=function(){return 4294967296*Math.random()|0},t.randomu32=function(){return t.random32()+2147483648},t.w3cTraceId=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=t.random32(),r+=e[n&15]+e[n>>4&15]+e[n>>8&15]+e[n>>12&15]+e[n>>16&15]+e[n>>20&15]+e[n>>24&15]+e[n>>28&15];var s=e[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},t.isValidW3CId=function(e){return e.length===32&&e!=="00000000000000000000000000000000"},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.isError=function(e){return e instanceof Error},t.isPrimitive=function(e){var r=typeof e;return r==="string"||r==="number"||r==="boolean"},t.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"},t.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var r=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(e/(1e3*60))%60,i=""+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var o=s>0?s+".":"";return o+i+":"+n+":"+r},t.extractError=function(e){var r=e;return{message:e.message,code:r.code||r.id||""}},t.extractObject=function(e){return e instanceof Error?t.extractError(e):typeof e.toJSON=="function"?e.toJSON():e},t.validateStringMap=function(e){if(typeof e!="object"){Ci.info("Invalid properties dropped from payload");return}var r={};for(var n in e){var i="",s=e[n],o=typeof s;if(t.isPrimitive(s))i=s.toString();else if(s===null||o==="undefined")i="";else if(o==="function"){Ci.info("key: "+n+" was function; will not serialize");continue}else{var a=t.isArray(s)?s:t.extractObject(s);try{t.isPrimitive(a)?i=a:i=JSON.stringify(a)}catch(c){i=s.constructor.name.toString()+" (Error: "+c.message+")",Ci.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,t.MAX_PROPERTY_LENGTH)}return r},t.canIncludeCorrelationHeader=function(e,r){var n=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var s=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(s.test(du.parse(r).hostname))return!1}return!0},t.getCorrelationContextTarget=function(e,r){var n=e.headers&&e.headers[gn.requestContextHeader];if(n)for(var i=n.split(","),s=0;s<i.length;++s){var o=i[s].split("=");if(o.length==2&&o[0]==r)return o[1]}},t.makeRequest=function(e,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var s=du.parse(r),o=fu({},n,{host:s.hostname,port:s.port,path:s.pathname}),a=void 0;if(s.protocol==="https:"&&(a=e.proxyHttpsUrl||void 0),s.protocol==="http:"&&(a=e.proxyHttpUrl||void 0),a){a.indexOf("//")===0&&(a="http:"+a);var c=du.parse(a);c.protocol==="https:"?(Ci.info("Proxies that use HTTPS are not supported"),a=void 0):o=fu({},o,{host:c.hostname,port:c.port||"80",path:r,headers:fu({},o.headers,{Host:s.hostname})})}var l=s.protocol==="https:"&&!a;return l&&e.httpsAgent!==void 0?o.agent=e.httpsAgent:!l&&e.httpAgent!==void 0?o.agent=e.httpAgent:l&&(o.agent=t.tlsRestrictedAgent),l?vv.request(o,i):Ub.request(o,i)},t.safeIncludeCorrelationHeader=function(e,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(s){Ci.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}i?t.addCorrelationIdHeaderFromString(e,r,i):r.setHeader(gn.requestContextHeader,gn.requestContextSourceKey+"="+e.config.correlationId)},t.addCorrelationIdHeaderFromString=function(e,r,n){var i=n.split(","),s=gn.requestContextSourceKey+"=",o=i.some(function(a){return a.substring(0,s.length)===s});o||r.setHeader(gn.requestContextHeader,n+","+gn.requestContextSourceKey+"="+e.config.correlationId)},t.MAX_PROPERTY_LENGTH=8192,t.tlsRestrictedAgent=new vv.Agent({secureOptions:po.SSL_OP_NO_SSLv2|po.SSL_OP_NO_SSLv3|po.SSL_OP_NO_TLSv1|po.SSL_OP_NO_TLSv1_1}),t}();yv.exports=Bb});var pu=p((RD,_v)=>{"use strict";var Gb=function(){function t(){}return t.prototype.getUrl=function(){return this.url},t.prototype.RequestParser=function(){this.startTime=+new Date},t.prototype._setStatus=function(e,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=e;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var s in r)i[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=i},t.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},t}();_v.exports=Gb});var kr=p((AD,Ev)=>{"use strict";var mo=xt(),mu=Pe(),Vb=function(){function t(){}return t.queryCorrelationId=function(e,r){var n=e.profileQueryEndpoint+"/api/profiles/"+e.instrumentationKey+"/appId";if(t.completedLookups.hasOwnProperty(n)){r(t.completedLookups[n]);return}else if(t.pendingLookups[n]){t.pendingLookups[n].push(r);return}t.pendingLookups[n]=[r];var i=function(){if(!!t.pendingLookups[n]){var s={method:"GET",disableAppInsightsAutoCollection:!0};mu.info(t.TAG,s);var o=mo.makeRequest(e,n,s,function(a){if(a.statusCode===200){var c="";a.setEncoding("utf-8"),a.on("data",function(l){c+=l}),a.on("end",function(){mu.info(t.TAG,c);var l=t.correlationIdPrefix+c;t.completedLookups[n]=l,t.pendingLookups[n]&&t.pendingLookups[n].forEach(function(u){return u(l)}),delete t.pendingLookups[n]})}else a.statusCode>=400&&a.statusCode<500?(t.completedLookups[n]=void 0,delete t.pendingLookups[n]):setTimeout(i,e.correlationIdRetryIntervalMs)});o&&(o.on("error",function(a){mu.warn(t.TAG,a)}),o.end())}};setTimeout(i,0)},t.cancelCorrelationIdQuery=function(e,r){var n=e.profileQueryEndpoint+"/api/profiles/"+e.instrumentationKey+"/appId",i=t.pendingLookups[n];i&&(t.pendingLookups[n]=i.filter(function(s){return s!=r}),t.pendingLookups[n].length==0&&delete t.pendingLookups[n])},t.generateRequestId=function(e){if(e){e=e[0]=="|"?e:"|"+e,e[e.length-1]!=="."&&(e+=".");var r=(t.currentRootId++).toString(16);return t.appendSuffix(e,r,"_")}else return t.generateRootId()},t.getRootId=function(e){var r=e.indexOf(".");r<0&&(r=e.length);var n=e[0]==="|"?1:0;return e.substring(n,r)},t.generateRootId=function(){return"|"+mo.w3cTraceId()+"."},t.appendSuffix=function(e,r,n){if(e.length+r.length<t.requestIdMaxLength)return e+r+n;var i=t.requestIdMaxLength-9;if(e.length>i)for(;i>1;--i){var s=e[i-1];if(s==="."||s==="_")break}if(i<=1)return t.generateRootId();for(r=mo.randomu32().toString(16);r.length<8;)r="0"+r;return e.substring(0,i)+r+"#"},t.TAG="CorrelationIdManager",t.correlationIdPrefix="cid-v1:",t.w3cEnabled=!1,t.pendingLookups={},t.completedLookups={},t.requestIdMaxLength=1024,t.currentRootId=mo.randomu32(),t}();Ev.exports=Vb});var Cv=p((vu,wv)=>{"use strict";var Wb=vu&&vu.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xi=require("url"),gu=ot(),zb=xt(),Xb=mn(),Qb=pu(),Yb=kr(),Kb=function(t){Wb(e,t);function e(r,n){var i=t.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=e._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return e.prototype.onError=function(r){this._setStatus(void 0,r)},e.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=zb.getCorrelationContextTarget(r,Xb.requestContextTargetKey)},e.prototype.getDependencyTelemetry=function(r,n){var i=xi.parse(this.url);i.search=void 0,i.hash=void 0;var s=this.method.toUpperCase()+" "+i.pathname,o=gu.RemoteDependencyDataConstants.TYPE_HTTP,a=i.hostname;this.correlationId?(o=gu.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==Yb.correlationIdPrefix&&(a=i.hostname+" | "+this.correlationId)):o=gu.RemoteDependencyDataConstants.TYPE_HTTP,i.port&&(a+=":"+i.port);var c={id:n,name:s,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:o,target:a};if(r){for(var l in r)c[l]||(c[l]=r[l]);if(r.properties)for(var l in r.properties)c.properties[l]=r.properties[l]}return c},e._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")r=xi.parse(r);else{var i=r;r={},i&&Object.keys(i).forEach(function(a){r[a]=i[a]})}if(r.path){var s=xi.parse(r.path);r.pathname=s.pathname,r.search=s.search}if(r.host&&r.port){var o=xi.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||void 0,r.hostname=r.hostname||"localhost",xi.format(r)},e}(Qb);wv.exports=Kb});var yu=p((OD,xv)=>{"use strict";var Ne=xt(),Jb=kr(),Zb=function(){function t(e,r){if(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.version=t.DEFAULT_VERSION,e&&typeof e=="string")if(e.split(",").length>1)this.traceId=Ne.w3cTraceId(),this.spanId=Ne.w3cTraceId().substr(0,16);else{var n=e.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=Ne.w3cTraceId(),this.spanId=Ne.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=t.DEFAULT_VERSION,this.traceId=Ne.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=Ne.w3cTraceId(),this.spanId=Ne.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=t.DEFAULT_VERSION,this.traceId=Ne.w3cTraceId(),this.spanId=Ne.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=t.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.traceId=Ne.w3cTraceId()),t.isValidTraceId(this.traceId)||(this.traceId=Ne.w3cTraceId()),t.isValidSpanId(this.spanId)||(this.spanId=Ne.w3cTraceId().substr(0,16),this.traceId=Ne.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=Jb.getRootId(r);t.isValidTraceId(s)||(this.legacyRootId=s,s=Ne.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=Ne.w3cTraceId(),this.spanId=Ne.w3cTraceId().substr(0,16)}return t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},t.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},t.prototype.updateSpanId=function(){this.spanId=Ne.w3cTraceId().substr(0,16)},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}();xv.exports=Zb});var Sv=p(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});var Tv=Ee(),vn=[];yn.subscriber=function(t){t.data.event.commandName,vn.forEach(function(e){var r=t.data.startedData&&t.data.startedData.databaseName||"Unknown database";e.trackDependency({target:r,data:t.data.event.commandName,name:t.data.event.commandName,duration:t.data.event.duration,success:t.data.succeeded,resultCode:t.data.succeeded?"0":"1",dependencyTypeName:"mongodb"})})};function eI(t,e){t?(vn.length===0&&Tv.channel.subscribe("mongodb",yn.subscriber),vn.push(e)):(vn=vn.filter(function(r){return r!=e}),vn.length===0&&Tv.channel.unsubscribe("mongodb",yn.subscriber))}yn.enable=eI});var Iv=p(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});var bv=Ee(),_n=[];En.subscriber=function(t){_n.forEach(function(e){var r=t.data.query||{},n=r.sql||"Unknown query",i=!t.data.err,s=r._connection||{},o=s.config||{},a=o.socketPath?o.socketPath:(o.host||"localhost")+":"+o.port;e.trackDependency({target:a,data:n,name:n,duration:t.data.duration,success:i,resultCode:i?"0":"1",dependencyTypeName:"mysql"})})};function tI(t,e){t?(_n.length===0&&bv.channel.subscribe("mysql",En.subscriber),_n.push(e)):(_n=_n.filter(function(r){return r!=e}),_n.length===0&&bv.channel.unsubscribe("mysql",En.subscriber))}En.enable=tI});var Av=p(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});var Rv=Ee(),wn=[];Cn.subscriber=function(t){wn.forEach(function(e){t.data.commandObj.command!=="info"&&e.trackDependency({target:t.data.address,name:t.data.commandObj.command,data:t.data.commandObj.command,duration:t.data.duration,success:!t.data.err,resultCode:t.data.err?"1":"0",dependencyTypeName:"redis"})})};function rI(t,e){t?(wn.length===0&&Rv.channel.subscribe("redis",Cn.subscriber),wn.push(e)):(wn=wn.filter(function(r){return r!=e}),wn.length===0&&Rv.channel.unsubscribe("redis",Cn.subscriber))}Cn.enable=rI});var kv=p(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});var Ov=Ee(),xn=[];Tn.subscriber=function(t){xn.forEach(function(e){var r=t.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!t.data.error,s=t.data.database.host+":"+t.data.database.port;e.trackDependency({target:s,data:n,name:n,duration:t.data.duration,success:i,resultCode:i?"0":"1",dependencyTypeName:"postgres"})})};function nI(t,e){t?(xn.length===0&&Ov.channel.subscribe("postgres",Tn.subscriber),xn.push(e)):(xn=xn.filter(function(r){return r!=e}),xn.length===0&&Ov.channel.unsubscribe("postgres",Tn.subscriber))}Tn.enable=nI});var Ti=p((ND,Nv)=>{"use strict";var Dr=require("http"),Sn=require("https"),_u=Pe(),Dv=xt(),er=mn(),iI=Cv(),Pv=dn(),qv=kr(),Eu=yu(),sI=Vs(),oI=function(){function t(e){if(t.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),sI.IsInitialized&&(Sv().enable(e,this._client),Iv().enable(e,this._client),Av().enable(e,this._client),kv().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._initialize=function(){var e=this;this._isInitialized=!0;var r=Dr.get,n=Dr.request,i=Sn.request,s=function(o,a){var c=!a[t.disableCollectionRequestOption]&&!o[t.alreadyAutoCollectedFlag];o[t.alreadyAutoCollectedFlag]=!0,o&&a&&c&&(Pv.CorrelationContextManager.wrapEmitter(o),t.trackRequest(e._client,{options:a,request:o}))};Dr.request=function(o){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=n.call.apply(n,[Dr,o].concat(a));return s(l,o),l},Sn.request=function(o){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=i.call.apply(i,[Sn,o].concat(a));return s(l,o),l},Dr.get=function(o){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=(u=Dr.request).call.apply(u,[Dr,o].concat(a));return l.end(),l;var u},Sn.get=function(o){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=(u=Sn.request).call.apply(u,[Sn,o].concat(a));return l.end(),l;var u}},t.trackRequest=function(e,r){if(!r.options||!r.request||!e){_u.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!e);return}var n=new iI(r.options,r.request),i=Pv.CorrelationContextManager.getCurrentContext(),s,o;if(i&&i.operation&&i.operation.traceparent&&Eu.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),s=i.operation.traceparent.getBackCompatRequestId();else if(qv.w3cEnabled){var a=new Eu;o=a.toString(),s=a.getBackCompatRequestId()}else s=i&&i.operation&&i.operation.parentId+t.requestNumber+++".";if(Dv.canIncludeCorrelationHeader(e,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&e.config&&e.config.correlationId){var c=r.request.getHeader(er.requestContextHeader);try{Dv.safeIncludeCorrelationHeader(e,r.request,c)}catch(f){_u.warn("Request-Context header could not be set. Correlation of requests may be lost",f)}if(i&&i.operation)try{if(r.request.setHeader(er.requestIdHeader,s),r.request.setHeader(er.parentIdHeader,i.operation.id),r.request.setHeader(er.rootIdHeader,s),o||i.operation.traceparent)r.request.setHeader(er.traceparentHeader,o||i.operation.traceparent.toString());else if(qv.w3cEnabled){var a=new Eu().toString();r.request.setHeader(er.traceparentHeader,a)}if(i.operation.tracestate){var l=i.operation.tracestate.toString();l&&r.request.setHeader(er.traceStateHeader,l)}var u=i.customProperties.serializeToHeader();u&&r.request.setHeader(er.correlationContextHeader,u)}catch(f){_u.warn("Correlation headers could not be set. Correlation of requests may be lost.",f)}}r.request.on&&(r.request.on("response",function(f){n.onResponse(f);var d=n.getDependencyTelemetry(r,s);d.contextObjects=d.contextObjects||{},d.contextObjects["http.RequestOptions"]=r.options,d.contextObjects["http.ClientRequest"]=r.request,d.contextObjects["http.ClientResponse"]=f,e.trackDependency(d)}),r.request.on("error",function(f){n.onError(f);var d=n.getDependencyTelemetry(r,s);d.contextObjects=d.contextObjects||{},d.contextObjects["http.RequestOptions"]=r.options,d.contextObjects["http.ClientRequest"]=r.request,d.contextObjects.Error=f,e.trackDependency(d)}))},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.disableCollectionRequestOption="disableAppInsightsAutoCollection",t.requestNumber=1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();Nv.exports=oI});var Fv=p((LD,Lv)=>{"use strict";var aI=function(){function t(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return t.prototype.toString=function(){var e=this.fieldmap;return!e||e.length==0?null:e.join(", ")},t.validateKeyChars=function(e){var r=e.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),s=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),o=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&o}else if(r.length==1)return Boolean(e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},t.prototype.parseHeader=function(e){var r=[],n={},i=e.split(",");if(i.length>32)return null;for(var s=0,o=i;s<o.length;s++){var a=o[s],c=a.trim();if(c.length!==0){var l=c.split("=");if(l.length!==2||!t.validateKeyChars(l[0])||n[l[0]])return null;n[l[0]]=!0,r.push(c)}}return r},t.strict=!0,t}();Lv.exports=aI});var $v=p((Cu,jv)=>{"use strict";var cI=Cu&&Cu.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),go=require("url"),uI=ot(),Mv=xt(),Pr=mn(),lI=pu(),tr=kr(),fI=Fv(),wu=yu(),dI=function(t){cI(e,t);function e(r,n){var i=t.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return e.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},e.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},e.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+go.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},e.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[e.keys.locationIp]=r[e.keys.locationIp]||this._getIp(),n[e.keys.sessionId]=r[e.keys.sessionId]||this._getId("ai_session"),n[e.keys.userId]=r[e.keys.userId]||this._getId("ai_user"),n[e.keys.userAuthUserId]=r[e.keys.userAuthUserId]||this._getId("ai_authUser"),n[e.keys.operationName]=this.getOperationName(r),n[e.keys.operationParentId]=this.getOperationParentId(r),n[e.keys.operationId]=this.getOperationId(r),n},e.prototype.getOperationId=function(r){return r[e.keys.operationId]||this.operationId},e.prototype.getOperationParentId=function(r){return r[e.keys.operationParentId]||this.parentId||this.getOperationId(r)},e.prototype.getOperationName=function(r){return r[e.keys.operationName]||this.method+" "+go.parse(this.url).pathname},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},e.prototype.getTraceparent=function(){return this.traceparent},e.prototype.getTracestate=function(){return this.tracestate},e.prototype.getLegacyRootId=function(){return this.legacyRootId},e.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=go.parse(r.url),s=i.pathname,o=i.search,a=go.format({protocol:n?"https":"http",host:r.headers.host,pathname:s,search:o});return a},e.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var o=r.exec(s);if(o)return o[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},e.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=e.parseId(Mv.getCookie(r,n));return i},e.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},e.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=Mv.getCorrelationContextTarget(r,Pr.requestContextSourceKey),r.headers){var i=r.headers[Pr.traceStateHeader],s=r.headers[Pr.traceparentHeader],o=r.headers[Pr.requestIdHeader],a=r.headers[Pr.parentIdHeader],c=r.headers[Pr.rootIdHeader];this.correlationContextHeader=r.headers[Pr.correlationContextHeader],tr.w3cEnabled&&(s||i)?(this.traceparent=new wu(s),this.tracestate=s&&i&&new fI(i),this.setBackCompatFromThisTraceContext()):o?tr.w3cEnabled?(this.traceparent=new wu(null,o),this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=tr.generateRequestId(this.parentId),this.operationId=tr.getRootId(this.requestId)):tr.w3cEnabled?(this.traceparent=new wu,this.traceparent.parentId=a,this.traceparent.legacyRootId=c||a,this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=tr.generateRequestId(c||this.parentId),this.correlationContextHeader=null,this.operationId=tr.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=tr.getRootId(this.requestId))}},e.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},e.keys=new uI.ContextTagKeys,e}(lI);jv.exports=dI});var Tu=p((FD,Vv)=>{"use strict";var Hv=require("http"),Uv=require("https"),Bv=Pe(),Gv=xt(),hI=mn(),xu=$v(),Ut=dn(),pI=ho(),mI=function(){function t(e){if(t.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||pI.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},t.prototype.useAutoCorrelation=function(e,r){e&&!this._isAutoCorrelating?Ut.CorrelationContextManager.enable(r):!e&&this._isAutoCorrelating&&Ut.CorrelationContextManager.disable(),this._isAutoCorrelating=e},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},t.prototype._generateCorrelationContext=function(e){if(!!this._isAutoCorrelating)return Ut.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},t.prototype._initialize=function(){var e=this;this._isInitialized=!0;var r=function(o){if(!!o){if(typeof o!="function")throw new Error("onRequest handler must be a function");return function(a,c){Ut.CorrelationContextManager.wrapEmitter(a),Ut.CorrelationContextManager.wrapEmitter(c);var l=a&&!a[t.alreadyAutoCollectedFlag];if(a&&l){var u=new xu(a),f=e._generateCorrelationContext(u);Ut.CorrelationContextManager.runWithContext(f,function(){e._isEnabled&&(a[t.alreadyAutoCollectedFlag]=!0,t.trackRequest(e._client,{request:a,response:c},u)),typeof o=="function"&&o(a,c)})}else typeof o=="function"&&o(a,c)}}},n=function(o){var a=o.addListener.bind(o);o.addListener=function(c,l){switch(c){case"request":case"checkContinue":return a(c,r(l));default:return a(c,l)}},o.on=o.addListener},i=Hv.createServer;Hv.createServer=function(o){var a=i(r(o));return n(a),a};var s=Uv.createServer;Uv.createServer=function(o,a){var c=s(o,r(a));return n(c),c}},t.trackRequestSync=function(e,r){if(!r.request||!r.response||!e){Bv.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!e);return}t.addResponseCorrelationIdHeader(e,r.response);var n=Ut.CorrelationContextManager.getCurrentContext(),i=new xu(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(e.context.tags)||n.operation.id,n.operation.name=i.getOperationName(e.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),t.endRequest(e,i,r,r.duration,r.error)},t.trackRequest=function(e,r,n){if(!r.request||!r.response||!e){Bv.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!e);return}var i=Ut.CorrelationContextManager.getCurrentContext(),s=n||new xu(r.request,i&&i.operation.parentId);Gv.canIncludeCorrelationHeader(e,s.getUrl())&&t.addResponseCorrelationIdHeader(e,r.response),i&&!n&&(i.operation.id=s.getOperationId(e.context.tags)||i.operation.id,i.operation.name=s.getOperationName(e.context.tags)||i.operation.name,i.operation.parentId=s.getOperationParentId(e.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){t.endRequest(e,s,r,null,null)}),r.request.on&&r.request.on("error",function(o){t.endRequest(e,s,r,null,o)})},t.addResponseCorrelationIdHeader=function(e,r){if(e.config&&e.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(hI.requestContextHeader);Gv.safeIncludeCorrelationHeader(e,r,n)}},t.endRequest=function(e,r,n,i,s){s?r.onError(s,i):r.onResponse(n.response,i);var o=r.getRequestTelemetry(n);if(o.tagOverrides=r.getRequestTags(e.context.tags),n.tagOverrides)for(var a in n.tagOverrides)o.tagOverrides[a]=n.tagOverrides[a];var c=r.getLegacyRootId();c&&(o.properties.ai_legacyRootId=c),o.contextObjects=o.contextObjects||{},o.contextObjects["http.ServerRequest"]=n.request,o.contextObjects["http.ServerResponse"]=n.response,e.trackRequest(o)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1,Ut.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();Vv.exports=mI});var Xv=p((MD,zv)=>{"use strict";var Wv=pn(),gI=function(){function t(){}return t.parse=function(e){if(!e)return{};var r=e.split(t._FIELDS_SEPARATOR),n=r.reduce(function(s,o){var a=o.split(t._FIELD_KEY_VALUE_SEPARATOR);if(a.length===2){var c=a[0].toLowerCase(),l=a[1];s[c]=l}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||Wv.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||Wv.DEFAULT_LIVEMETRICS_ENDPOINT}return n},t._FIELDS_SEPARATOR=";",t._FIELD_KEY_VALUE_SEPARATOR="=",t}();zv.exports=gI});var vo=p((jD,Kv)=>{"use strict";var Su=kr(),Qv=Xv(),Yv=pn(),vI=require("url"),yI=function(){function t(e){var r=this;this.endpointBase=Yv.DEFAULT_BREEZE_ENDPOINT;var n=process.env[t.ENV_connectionString],i=Qv.parse(e),s=Qv.parse(n),o=!i.instrumentationkey&&Object.keys(i).length>0?null:e;this.instrumentationKey=i.instrumentationkey||o||s.instrumentationkey||t._getInstrumentationKey(),this.endpointUrl=(i.ingestionendpoint||s.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(a){return r.correlationId=a},this.proxyHttpUrl=process.env[t.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[t.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||s.ingestionendpoint||process.env[t.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||s.liveendpoint||process.env[t.ENV_quickPulseHost]||Yv.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=vI.parse(this._quickPulseHost).host)}return Object.defineProperty(t.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){Su.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=e,this.correlationId=Su.correlationIdPrefix,Su.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(e){this._quickPulseHost=e},enumerable:!0,configurable:!0}),t._getInstrumentationKey=function(){var e=process.env[t.ENV_iKey]||process.env[t.ENV_azurePrefix+t.ENV_iKey]||process.env[t.legacy_ENV_iKey]||process.env[t.ENV_azurePrefix+t.legacy_ENV_iKey];if(!e||e=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return e},t.ENV_azurePrefix="APPSETTING_",t.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",t.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",t.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",t.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",t.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",t.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",t.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",t.ENV_http_proxy="http_proxy",t.ENV_https_proxy="https_proxy",t}();Kv.exports=yI});var ey=p((Iu,Zv)=>{"use strict";var Si=Iu&&Iu.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},bu=require("os"),qr=ot(),Jv=pn(),_I=xt(),EI=Pe(),wI=_I.w3cTraceId(),CI=function(){function t(){}return t.createQuickPulseEnvelope=function(e,r,n,i){var s=bu&&typeof bu.hostname=="function"&&bu.hostname()||"Unknown",o=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||s,a={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:wI,MachineName:s,Instance:o};return a},t.createQuickPulseMetric=function(e){var r;return r={Name:e.name,Value:e.value,Weight:e.count||1},r},t.telemetryEnvelopeToQuickPulseDocument=function(e){switch(e.data.baseType){case qr.TelemetryTypeString.Event:return t.createQuickPulseEventDocument(e);case qr.TelemetryTypeString.Exception:return t.createQuickPulseExceptionDocument(e);case qr.TelemetryTypeString.Trace:return t.createQuickPulseTraceDocument(e);case qr.TelemetryTypeString.Dependency:return t.createQuickPulseDependencyDocument(e);case qr.TelemetryTypeString.Request:return t.createQuickPulseRequestDocument(e)}return null},t.createQuickPulseEventDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.name,i=Si({},r,{Name:n});return i},t.createQuickPulseTraceDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.severityLevel||0,i=Si({},r,{Message:e.data.baseData.message,SeverityLevel:qr.SeverityLevel[n]});return i},t.createQuickPulseExceptionDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.exceptions,i="",s="",o="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(c){i+=c.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),s=n[0].message,o=n[0].typeName);var a=Si({},r,{Exception:i,ExceptionMessage:s,ExceptionType:o});return a},t.createQuickPulseRequestDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,i=Si({},r,{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},t.createQuickPulseDependencyDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,i=Si({},r,{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},t.createQuickPulseDocument=function(e){var r,n,i,s;e.data.baseType?(n=Jv.TelemetryTypeStringToQuickPulseType[e.data.baseType],r=Jv.TelemetryTypeStringToQuickPulseDocumentType[e.data.baseType]):EI.warn("Document type invalid; not sending live metric document",e.data.baseType),i=e.tags[t.keys.operationId],s=t.aggregateProperties(e);var o={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:s};return o},t.aggregateProperties=function(e){var r=[],n=e.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],o={key:i,value:s};r.push(o)}var a=e.data.baseData.properties||{};for(var i in a)if(a.hasOwnProperty(i)){var s=a[i],o={key:i,value:s};r.push(o)}return r},t.keys=new qr.ContextTagKeys,t}();Zv.exports=CI});var ny=p(($D,ry)=>{"use strict";var xI=require("https"),TI=Ti(),ty=Pe(),Ru={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},SI=function(){function t(e){this._config=e,this._consecutiveErrors=0}return t.prototype.ping=function(e,r){this._submitData(e,r,"ping")},t.prototype.post=function(e,r){this._submitData([e],r,"post")},t.prototype._submitData=function(e,r,n){var i=this,s=JSON.stringify(e),o=(c={},c[TI.disableCollectionRequestOption]=!0,c.host=this._config.quickPulseHost,c.method=Ru.method,c.path="/QuickPulseService.svc/"+n+"?ikey="+this._config.instrumentationKey,c.headers=(l={Expect:"100-continue"},l[Ru.time]=1e4*Date.now(),l["Content-Type"]="application/json",l["Content-Length"]=Buffer.byteLength(s),l),c),a=xI.request(o,function(u){var f=u.headers[Ru.subscribed]==="true";i._consecutiveErrors=0,r(f,u)});a.on("error",function(u){i._consecutiveErrors++;var f="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";i._consecutiveErrors%t.MAX_QPS_FAILURES_BEFORE_WARN===0?(f="Live Metrics endpoint could not be reached "+i._consecutiveErrors+" consecutive times. Most recent error:",ty.warn(t.TAG,f,u)):ty.info(t.TAG,f,u),r()}),a.write(s),a.end();var c,l},t.TAG="QuickPulseSender",t.MAX_QPS_FAILURES_BEFORE_WARN=25,t}();ry.exports=SI});var yo=p((HD,ay)=>{"use strict";var Bt=require("os"),iy=require("fs"),sy=require("path"),bI=ot(),oy=Pe(),II=function(){function t(e){this.keys=new bI.ContextTagKeys,this.tags={},this._loadApplicationContext(),this._loadDeviceContext(),this._loadInternalContext()}return t.prototype._loadApplicationContext=function(e){if(e=e||sy.resolve(__dirname,"../../../../package.json"),!t.appVersion[e]){t.appVersion[e]="unknown";try{var r=JSON.parse(iy.readFileSync(e,"utf8"));r&&typeof r.version=="string"&&(t.appVersion[e]=r.version)}catch(n){oy.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=t.appVersion[e]},t.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=Bt&&Bt.hostname(),this.tags[this.keys.deviceOSVersion]=Bt&&Bt.type()+" "+Bt.release(),this.tags[this.keys.cloudRole]=t.DefaultRoleName,this.tags["ai.device.osArchitecture"]=Bt&&Bt.arch(),this.tags["ai.device.osPlatform"]=Bt&&Bt.platform()},t.prototype._loadInternalContext=function(){var e=sy.resolve(__dirname,"../../package.json");if(!t.sdkVersion){t.sdkVersion="unknown";try{var r=JSON.parse(iy.readFileSync(e,"utf8"));r&&typeof r.version=="string"&&(t.sdkVersion=r.version)}catch(n){oy.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+t.sdkVersion},t.DefaultRoleName="Web",t.appVersion={},t.sdkVersion=null,t}();ay.exports=II});var uy=p((UD,cy)=>{"use strict";var RI=Pe(),AI=vo(),Au=ey(),OI=ny(),kI=pn(),DI=yo(),PI=function(){function t(e,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new AI(e),this.context=r||new DI,this._sender=new OI(this.config),this._isEnabled=!1}return t.prototype.addCollector=function(e){this._collectors.push(e)},t.prototype.trackMetric=function(e){this._addMetric(e)},t.prototype.addDocument=function(e){var r=Au.telemetryEnvelopeToQuickPulseDocument(e);r&&this._documents.push(r)},t.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},t.prototype.enableCollectors=function(e){this._collectors.forEach(function(r){r.enable(e)})},t.prototype._addMetric=function(e){var r=e.value,n=e.count||1,i=kI.PerformanceToQuickPulseCounter[e.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=Au.createQuickPulseMetric(e),this._metrics[i].Name=i,this._metrics[i].Weight=1))},t.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},t.prototype._goQuickPulse=function(){var e=this,r=Object.keys(this._metrics).map(function(s){return e._metrics[s]}),n=Au.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var i=this._isCollectingData?t.POST_INTERVAL:t.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=t.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=t.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref()},t.prototype._ping=function(e){this._sender.ping(e,this._quickPulseDone.bind(this))},t.prototype._post=function(e){this._sender.post(e,this._quickPulseDone.bind(this))},t.prototype._quickPulseDone=function(e,r){e!=null?(this._isCollectingData!==e&&(RI.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},t.MAX_POST_WAIT_TIME=2e4,t.MAX_PING_WAIT_TIME=6e4,t.FALLBACK_INTERVAL=6e4,t.PING_INTERVAL=5e3,t.POST_INTERVAL=1e3,t}();cy.exports=PI});var fy=p(Ii=>{"use strict";var qI=Ii&&Ii.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(Ii,"__esModule",{value:!0});var ly=vo(),bi=yo(),NI=Pe(),LI=function(){function t(e){this._disabledMetrics={},t.INSTANCE&&t.INSTANCE.dispose(),t.INSTANCE=this,this._client=e}return t.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>=6},t.prototype.enable=function(e,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!t.isNodeVersionCompatible()){if(t._metricsAvailable==null&&e&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");t._emitter=new s,t._metricsAvailable=!0,NI.info("Native metrics module successfully loaded!")}catch{t._metricsAvailable=!1;return}this._isEnabled=e,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&t._emitter?(t._emitter.enable(!0,n),this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref()):t._emitter&&(t._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},t.prototype.dispose=function(){this.enable(!1)},t.parseEnabled=function(e){var r=process.env[ly.ENV_nativeMetricsDisableAll],n=process.env[ly.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),s={};if(i.length>0)for(var o=0,a=i;o<a.length;o++){var c=a[o];s[c]=!0}return typeof e=="object"?{isEnabled:!0,disabledMetrics:qI({},e,s)}:{isEnabled:e,disabledMetrics:s}}return typeof e=="boolean"?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},t.prototype._trackNativeMetrics=function(){var e=!0;typeof this._isEnabled!="object"&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},t.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var e=t._emitter.getGCData();for(var r in e){var n=e[r].metrics,i=r+" Garbage Collection Duration",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,max:n.max,min:n.min,stdDev:s,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+bi.sdkVersion,o)})}var o}},t.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var e=t._emitter.getLoopData(),r=e.loopUsage;if(r.count!=0){var n="Event Loop CPU Time",i=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:n,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:i,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+bi.sdkVersion,s)});var s}}},t.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var e=process.memoryUsage(),r=e.heapUsed,n=e.heapTotal,i=e.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:r,count:1,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+bi.sdkVersion,s)}),this._client.trackMetric({name:"Memory Total (Heap)",value:n,count:1,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+bi.sdkVersion,o)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:i-n,count:1,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+bi.sdkVersion,a)});var s,o,a}},t}();Ii.AutoCollectNativePerformance=LI});var py=p((GD,hy)=>{"use strict";var dy=Pe(),FI=function(){function t(e,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return t.prototype.setUseDiskRetryCaching=function(e,r,n){this._sender.setDiskRetryMode(e,r,n)},t.prototype.send=function(e){var r=this;if(!this._isDisabled()){if(!e){dy.warn("Cannot send null/undefined telemetry");return}var n=this._stringify(e);if(typeof n=="string"){if(this._buffer.push(n),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}}},t.prototype.triggerSend=function(e,r){var n=this._buffer.length<1;if(!n){var i=this._buffer.join(`
`);e?(this._sender.saveOnCrash(i),typeof r=="function"&&r("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(i):new Buffer(i),r)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},t.prototype._stringify=function(e){try{return JSON.stringify(e)}catch(r){dy.warn("Failed to serialize payload",r,e)}},t}();hy.exports=FI});var vy=p(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});var my=ot();function MI(t,e){var r=t.sampleRate,n=!1;return r==null||r>=100||t.data&&my.TelemetryType.Metric===my.baseTypeToTelemetryType(t.data.baseType)?!0:(e.correlationContext&&e.correlationContext.operation?n=gy(e.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}_o.samplingTelemetryProcessor=MI;function gy(t){var e=-2147483648,r=2147483647,n=5381;if(!t)return 0;for(;t.length<8;)t=t+t;for(var i=0;i<t.length;i++)n=((n<<5)+n|0)+t.charCodeAt(i)|0;return n=n<=e?r:Math.abs(n),n/r*100}_o.getSamplingHashCode=gy});var yy=p(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});var Ou=ho(),ku=ot();function jI(t,e){switch(e&&e.addDocument(t),t.data.baseType){case ku.TelemetryTypeString.Exception:Ou.countException();break;case ku.TelemetryTypeString.Request:var r=t.data.baseData;Ou.countRequest(r.duration,r.success);break;case ku.TelemetryTypeString.Dependency:var n=t.data.baseData;Ou.countDependency(n.duration,n.success);break}return!0}Du.performanceMetricsTelemetryProcessor=jI});var Ey=p(Eo=>{"use strict";function _y(t){for(var e in t)Eo.hasOwnProperty(e)||(Eo[e]=t[e])}Object.defineProperty(Eo,"__esModule",{value:!0});_y(vy());_y(yy())});var Cy=p((XD,wy)=>{"use strict";var Qe=require("fs"),wo=require("os"),Gt=require("path"),$I=require("zlib"),bn=require("child_process"),Ue=Pe(),HI=Ti(),UI=xt(),BI=function(){function t(e,r,n){if(this._config=e,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=t.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=t.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,!t.OS_PROVIDES_FILE_PROTECTION)if(t.USE_ICACLS){try{t.OS_PROVIDES_FILE_PROTECTION=Qe.existsSync(t.ICACLS_PATH)}catch{}t.OS_PROVIDES_FILE_PROTECTION||Ue.warn(t.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else t.OS_PROVIDES_FILE_PROTECTION=!0}return t.prototype.setDiskRetryMode=function(e,r,n){this._enableDiskRetryMode=t.OS_PROVIDES_FILE_PROTECTION&&e,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),e&&!t.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,Ue.warn(t.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},t.prototype.send=function(e,r){var n=this,i=this._config.endpointUrl,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};$I.gzip(e,function(o,a){var c=a;o?(Ue.warn(o),c=e,s.headers["Content-Length"]=e.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=a.length),Ue.info(t.TAG,s),s[HI.disableCollectionRequestOption]=!0;var l=function(f){f.setEncoding("utf-8");var d="";f.on("data",function(h){d+=h}),f.on("end",function(){n._numConsecutiveFailures=0,Ue.info(t.TAG,d),typeof n._onSuccess=="function"&&n._onSuccess(d),typeof r=="function"&&r(d),n._enableDiskRetryMode&&(f.statusCode===200?setTimeout(function(){return n._sendFirstFileOnDisk()},n._resendInterval).unref():(f.statusCode===408||f.statusCode===429||f.statusCode===439||f.statusCode===500||f.statusCode===503)&&n._storeToDisk(e))})},u=UI.makeRequest(n._config,i,s,l);u.on("error",function(f){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%t.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var d="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(d="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),Ue.warn(t.TAG,d,f)}else{var d="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";Ue.info(t.TAG,d,f)}if(n._onErrorHelper(f),typeof r=="function"){var h="error sending telemetry";f&&typeof f.toString=="function"&&(h=f.toString()),r(h)}n._enableDiskRetryMode&&n._storeToDisk(e)}),u.write(c),u.end()})},t.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(e)},t.prototype._runICACLS=function(e,r){var n=bn.spawn(t.ICACLS_PATH,e,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,s){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},t.prototype._runICACLSSync=function(e){if(bn.spawnSync){var r=bn.spawnSync(t.ICACLS_PATH,e,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},t.prototype._getACLIdentity=function(e){if(t.ACL_IDENTITY)return e(null,t.ACL_IDENTITY);var r=bn.spawn(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return e(i,null)}),r.on("close",function(i,s){return t.ACL_IDENTITY=n&&n.trim(),e(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),t.ACL_IDENTITY)})},t.prototype._getACLIdentitySync=function(){if(t.ACL_IDENTITY)return t.ACL_IDENTITY;if(bn.spawnSync){var e=bn.spawnSync(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(e.error)throw e.error;if(e.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+e.status+")");return t.ACL_IDENTITY=e.stdout&&e.stdout.toString().trim(),t.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},t.prototype._getACLArguments=function(e,r){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},t.prototype._applyACLRules=function(e,r){var n=this;if(!t.USE_ICACLS)return r(null);if(t.ACLED_DIRECTORIES[e]===void 0)t.ACLED_DIRECTORIES[e]=!1,this._getACLIdentity(function(i,s){if(i)return t.ACLED_DIRECTORIES[e]=!1,r(i);n._runICACLS(n._getACLArguments(e,s),function(o){return t.ACLED_DIRECTORIES[e]=!o,r(o)})});else return r(t.ACLED_DIRECTORIES[e]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},t.prototype._applyACLRulesSync=function(e){if(t.USE_ICACLS){if(t.ACLED_DIRECTORIES[e]===void 0){this._runICACLSSync(this._getACLArguments(e,this._getACLIdentitySync())),t.ACLED_DIRECTORIES[e]=!0;return}else if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},t.prototype._confirmDirExists=function(e,r){var n=this;Qe.lstat(e,function(i,s){i&&i.code==="ENOENT"?Qe.mkdir(e,function(o){o&&o.code!=="EEXIST"?r(o):n._applyACLRules(e,r)}):!i&&s.isDirectory()?n._applyACLRules(e,r):r(i||new Error("Path existed but was not a directory"))})},t.prototype._getShallowDirectorySize=function(e,r){Qe.readdir(e,function(n,i){if(n)return r(n,-1);var s=null,o=0,a=0;if(i.length===0){r(null,0);return}for(var c=0;c<i.length;c++)Qe.stat(Gt.join(e,i[c]),function(l,u){a++,l?s=l:u.isFile()&&(o+=u.size),a===i.length&&(s?r(s,-1):r(s,o))})})},t.prototype._getShallowDirectorySizeSync=function(e){for(var r=Qe.readdirSync(e),n=0,i=0;i<r.length;i++)n+=Qe.statSync(Gt.join(e,r[i])).size;return n},t.prototype._storeToDisk=function(e){var r=this,n=Gt.join(wo.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey);Ue.info(t.TAG,"Checking existance of data storage directory: "+n),this._confirmDirExists(n,function(i){if(i){Ue.warn(t.TAG,"Error while checking/creating directory: "+(i&&i.message)),r._onErrorHelper(i);return}r._getShallowDirectorySize(n,function(s,o){if(s||o<0){Ue.warn(t.TAG,"Error while checking directory size: "+(s&&s.message)),r._onErrorHelper(s);return}else if(o>r._maxBytesOnDisk){Ue.warn(t.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+o);return}var a=new Date().getTime()+".ai.json",c=Gt.join(n,a);Ue.info(t.TAG,"saving data to disk at: "+c),Qe.writeFile(c,e,{mode:384},function(l){return r._onErrorHelper(l)})})})},t.prototype._storeToDiskSync=function(e){var r=Gt.join(wo.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey);try{Ue.info(t.TAG,"Checking existance of data storage directory: "+r),Qe.existsSync(r)||Qe.mkdirSync(r),this._applyACLRulesSync(r);var n=this._getShallowDirectorySizeSync(r);if(n>this._maxBytesOnDisk){Ue.info(t.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+n);return}var i=new Date().getTime()+".ai.json",s=Gt.join(r,i);Ue.info(t.TAG,"saving data before crash to disk at: "+s),Qe.writeFileSync(s,e,{mode:384})}catch(o){Ue.warn(t.TAG,"Error while saving data to disk: "+(o&&o.message)),this._onErrorHelper(o)}},t.prototype._sendFirstFileOnDisk=function(){var e=this,r=Gt.join(wo.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey);Qe.exists(r,function(n){n&&Qe.readdir(r,function(i,s){if(i)e._onErrorHelper(i);else if(s=s.filter(function(c){return Gt.basename(c).indexOf(".ai.json")>-1}),s.length>0){var o=s[0],a=Gt.join(r,o);Qe.readFile(a,function(c,l){c?e._onErrorHelper(c):Qe.unlink(a,function(u){u?e._onErrorHelper(u):e.send(l)})})}})})},t.prototype._onErrorHelper=function(e){typeof this._onError=="function"&&this._onError(e)},t.TAG="Sender",t.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",t.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",t.ACLED_DIRECTORIES={},t.ACL_IDENTITY=null,t.WAIT_BETWEEN_RESEND=60*1e3,t.MAX_BYTES_ON_DISK=50*1e3*1e3,t.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,t.TEMPDIR_PREFIX="appInsights-node",t.OS_PROVIDES_FILE_PROTECTION=!1,t.USE_ICACLS=wo.type()==="Windows_NT",t}();wy.exports=BI});var Sy=p((QD,Ty)=>{"use strict";var I=ot(),Tt=xt(),GI=dn(),VI=function(){function t(){}return t.createEnvelope=function(e,r,n,i,s){var o=null;switch(r){case I.TelemetryType.Trace:o=t.createTraceData(e);break;case I.TelemetryType.Dependency:o=t.createDependencyData(e);break;case I.TelemetryType.Event:o=t.createEventData(e);break;case I.TelemetryType.Exception:o=t.createExceptionData(e);break;case I.TelemetryType.Request:o=t.createRequestData(e);break;case I.TelemetryType.Metric:o=t.createMetricData(e);break;case I.TelemetryType.Availability:o=t.createAvailabilityData(e);break}if(n&&I.domainSupportsProperties(o.baseData)){if(o&&o.baseData)if(!o.baseData.properties)o.baseData.properties=n;else for(var a in n)o.baseData.properties[a]||(o.baseData.properties[a]=n[a]);o.baseData.properties=Tt.validateStringMap(o.baseData.properties)}var c=s&&s.instrumentationKey||"",l=new I.Envelope;return l.data=o,l.iKey=c,l.name="Microsoft.ApplicationInsights."+c.replace(/-/g,"")+"."+o.baseType.substr(0,o.baseType.length-4),l.tags=this.getTags(i,e.tagOverrides),l.time=new Date().toISOString(),l.ver=1,l.sampleRate=s?s.samplingPercentage:100,r===I.TelemetryType.Metric&&(l.sampleRate=100),l},t.createTraceData=function(e){var r=new I.MessageData;r.message=e.message,r.properties=e.properties,isNaN(e.severity)?r.severityLevel=I.SeverityLevel.Information:r.severityLevel=e.severity;var n=new I.Data;return n.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Trace),n.baseData=r,n},t.createDependencyData=function(e){var r=new I.RemoteDependencyData;typeof e.name=="string"&&(r.name=e.name.length>1024?e.name.slice(0,1021)+"...":e.name),r.data=e.data,r.target=e.target,r.duration=Tt.msToTimeSpan(e.duration),r.success=e.success,r.type=e.dependencyTypeName,r.properties=e.properties,r.resultCode=e.resultCode?e.resultCode+"":"",e.id?r.id=e.id:r.id=Tt.w3cTraceId();var n=new I.Data;return n.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Dependency),n.baseData=r,n},t.createEventData=function(e){var r=new I.EventData;r.name=e.name,r.properties=e.properties,r.measurements=e.measurements;var n=new I.Data;return n.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Event),n.baseData=r,n},t.createExceptionData=function(e){var r=new I.ExceptionData;r.properties=e.properties,isNaN(e.severity)?r.severityLevel=I.SeverityLevel.Error:r.severityLevel=e.severity,r.measurements=e.measurements,r.exceptions=[];var n=e.exception.stack,i=new I.ExceptionDetails;i.message=e.exception.message,i.typeName=e.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=Tt.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var s=new I.Data;return s.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Exception),s.baseData=r,s},t.createRequestData=function(e){var r=new I.RequestData;e.id?r.id=e.id:r.id=Tt.w3cTraceId(),r.name=e.name,r.url=e.url,r.source=e.source,r.duration=Tt.msToTimeSpan(e.duration),r.responseCode=e.resultCode?e.resultCode+"":"",r.success=e.success,r.properties=e.properties;var n=new I.Data;return n.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Request),n.baseData=r,n},t.createMetricData=function(e){var r=new I.MetricData;r.metrics=[];var n=new I.DataPoint;n.count=isNaN(e.count)?1:e.count,n.kind=I.DataPointType.Aggregation,n.max=isNaN(e.max)?e.value:e.max,n.min=isNaN(e.min)?e.value:e.min,n.name=e.name,n.stdDev=isNaN(e.stdDev)?0:e.stdDev,n.value=e.value,r.metrics.push(n),r.properties=e.properties;var i=new I.Data;return i.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Metric),i.baseData=r,i},t.createAvailabilityData=function(e){var r=new I.AvailabilityData;e.id?r.id=e.id:r.id=Tt.w3cTraceId(),r.name=e.name,r.duration=Tt.msToTimeSpan(e.duration),r.success=e.success,r.runLocation=e.runLocation,r.message=e.message,r.measurements=e.measurements,r.properties=e.properties;var n=new I.Data;return n.baseType=I.telemetryTypeToBaseType(I.TelemetryType.Availability),n.baseData=r,n},t.getTags=function(e,r){var n=GI.CorrelationContextManager.getCurrentContext(),i={};if(e&&e.tags)for(var s in e.tags)i[s]=e.tags[s];if(r)for(var s in r)i[s]=r[s];return n&&(i[e.keys.operationId]=i[e.keys.operationId]||n.operation.id,i[e.keys.operationName]=i[e.keys.operationName]||n.operation.name,i[e.keys.operationParentId]=i[e.keys.operationParentId]||n.operation.parentId),i},t.parseStack=function(e){var r=void 0;if(typeof e=="string"){var n=e.split(`
`);r=[];for(var i=0,s=0,o=0;o<=n.length;o++){var a=n[o];if(xy.regex.test(a)){var c=new xy(n[o],i++);s+=c.sizeInBytes,r.push(c)}}var l=32*1024;if(s>l)for(var u=0,f=r.length-1,d=0,h=u,m=f;u<f;){var v=r[u].sizeInBytes,g=r[f].sizeInBytes;if(d+=v+g,d>l){var y=m-h+1;r.splice(h,y);break}h=u,m=f,u++,f--}}return r},t}(),xy=function(){function t(e,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=Tt.trim(e);var n=e.match(t.regex);n&&n.length>=5&&(this.method=Tt.trim(n[2])||this.method,this.fileName=Tt.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=t.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return t.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}();Ty.exports=VI});var Oy=p((YD,Ay)=>{"use strict";var WI=require("url"),zI=vo(),XI=yo(),rr=ot(),QI=py(),by=Ey(),Iy=dn(),YI=Cy(),KI=xt(),Ry=Pe(),JI=Sy(),ZI=function(){function t(e){this._telemetryProcessors=[];var r=new zI(e);this.config=r,this.context=new XI,this.commonProperties={};var n=new YI(this.config);this.channel=new QI(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return t.prototype.trackAvailability=function(e){this.track(e,rr.TelemetryType.Availability)},t.prototype.trackTrace=function(e){this.track(e,rr.TelemetryType.Trace)},t.prototype.trackMetric=function(e){this.track(e,rr.TelemetryType.Metric)},t.prototype.trackException=function(e){e&&e.exception&&!KI.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,rr.TelemetryType.Exception)},t.prototype.trackEvent=function(e){this.track(e,rr.TelemetryType.Event)},t.prototype.trackRequest=function(e){this.track(e,rr.TelemetryType.Request)},t.prototype.trackDependency=function(e){e&&!e.target&&e.data&&(e.target=WI.parse(e.data).host),this.track(e,rr.TelemetryType.Dependency)},t.prototype.flush=function(e){this.channel.triggerSend(e?!!e.isAppCrashing:!1,e?e.callback:void 0)},t.prototype.track=function(e,r){if(e&&rr.telemetryTypeToBaseType(r)){var n=JI.createEnvelope(e,r,this.commonProperties,this.context,this.config);e.time&&(n.time=e.time.toISOString());var i=this.runTelemetryProcessors(n,e.contextObjects);i=i&&by.samplingTelemetryProcessor(n,{correlationContext:Iy.CorrelationContextManager.getCurrentContext()}),by.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),i&&this.channel.send(n)}else Ry.warn("track() requires telemetry object and telemetryType to be specified.")},t.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},t.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},t.prototype.runTelemetryProcessors=function(e,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=Iy.CorrelationContextManager.getCurrentContext();for(var s=0;s<i;++s)try{var o=this._telemetryProcessors[s];if(o&&o.apply(null,[e,r])===!1){n=!1;break}}catch(a){n=!0,Ry.warn("One of telemetry processors failed, telemetry item will be sent.",a,e)}return n},t}();Ay.exports=ZI});var Py=p((Pu,Dy)=>{"use strict";var eR=Pu&&Pu.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tR=Oy(),ky=Tu(),rR=Ti(),Co=Pe(),nR=function(t){eR(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?ky.trackRequestSync(this,r):Co.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},e.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&Co.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?ky.trackRequest(this,r):Co.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},e.prototype.trackNodeHttpDependency=function(r){r&&r.request?rR.trackRequest(this,r):Co.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},e}(tR);Dy.exports=nR});var Jy=p(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});var Ny=dn(),iR=dv(),sR=pv(),Ly=ho(),oR=Ti(),aR=Tu(),cR=kr(),Ri=Pe(),uR=uy(),Fy=fy();b.TelemetryClient=Py();b.Contracts=ot();var My;(function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C"})(My=b.DistributedTracingModes||(b.DistributedTracingModes={}));var jy=!0,$y=!1,Hy=!0,Uy=!0,By=!0,Gy=!0,Vy=!0,qu=!0,Wy,xo=!1,zy=!0,Xy,Qy=void 0,Yy=void 0,Ai,Oi,ki,In,Nr,Di,nr=!1,qy;function lR(t){return b.defaultClient?Ri.info("The default client is already setup"):(b.defaultClient=new b.TelemetryClient(t),Ai=new iR(b.defaultClient),Oi=new sR(b.defaultClient),ki=new Ly(b.defaultClient),Nr=new aR(b.defaultClient),Di=new oR(b.defaultClient),In||(In=new Fy.AutoCollectNativePerformance(b.defaultClient))),b.defaultClient&&b.defaultClient.channel&&b.defaultClient.channel.setUseDiskRetryCaching(Vy,Qy,Yy),Nu}b.setup=lR;function Ky(){return b.defaultClient?(nr=!0,Ai.enable(jy,$y),Oi.enable(Hy),ki.enable(Uy),In.enable(zy,Xy),Nr.useAutoCorrelation(qu,Wy),Nr.enable(By),Di.enable(Gy),b.liveMetricsClient&&xo&&b.liveMetricsClient.enable(xo)):Ri.warn("Start cannot be called before setup"),Nu}b.start=Ky;function fR(){return qu?Ny.CorrelationContextManager.getCurrentContext():null}b.getCorrelationContext=fR;function dR(t){return Ny.CorrelationContextManager.wrapCallback(t)}b.wrapWithCorrelationContext=dR;var Nu=function(){function t(){}return t.setDistributedTracingMode=function(e){return cR.w3cEnabled=e===My.AI_AND_W3C,t},t.setAutoCollectConsole=function(e,r){return r===void 0&&(r=!1),jy=e,$y=r,nr&&Ai.enable(e,r),t},t.setAutoCollectExceptions=function(e){return Hy=e,nr&&Oi.enable(e),t},t.setAutoCollectPerformance=function(e,r){r===void 0&&(r=!0),Uy=e;var n=Fy.AutoCollectNativePerformance.parseEnabled(r);return zy=n.isEnabled,Xy=n.disabledMetrics,nr&&(ki.enable(e),In.enable(n.isEnabled,n.disabledMetrics)),t},t.setAutoCollectRequests=function(e){return By=e,nr&&Nr.enable(e),t},t.setAutoCollectDependencies=function(e){return Gy=e,nr&&Di.enable(e),t},t.setAutoDependencyCorrelation=function(e,r){return qu=e,Wy=r,nr&&Nr.useAutoCorrelation(e,r),t},t.setUseDiskRetryCaching=function(e,r,n){return Vy=e,Qy=r,Yy=n,b.defaultClient&&b.defaultClient.channel&&b.defaultClient.channel.setUseDiskRetryCaching(e,r,n),t},t.setInternalLogging=function(e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),Ri.enableDebug=e,Ri.disableWarnings=!r,t},t.setSendLiveMetrics=function(e){return e===void 0&&(e=!1),b.defaultClient?(!b.liveMetricsClient&&e?(b.liveMetricsClient=new uR(b.defaultClient.config.instrumentationKey),qy=new Ly(b.liveMetricsClient,1e3,!0),b.liveMetricsClient.addCollector(qy),b.defaultClient.quickPulseClient=b.liveMetricsClient):b.liveMetricsClient&&b.liveMetricsClient.enable(e),xo=e,t):(Ri.warn("Live metrics client cannot be setup without the default client"),t)},t.start=Ky,t}();b.Configuration=Nu;function hR(){b.defaultClient=null,nr=!1,Ai&&Ai.dispose(),Oi&&Oi.dispose(),ki&&ki.dispose(),In&&In.dispose(),Nr&&Nr.dispose(),Di&&Di.dispose(),b.liveMetricsClient&&(b.liveMetricsClient.enable(!1),xo=!1,b.liveMetricsClient=void 0)}b.dispose=hR});var e_=p(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL=!0;var pR=require("fs"),Zy=require("os"),mR=require("path"),Z=require("vscode"),To=Jy(),gR=function(){function t(e,r,n,i){var s=this;this.extensionId=e,this.extensionVersion=r,this.firstParty=!1,this.userOptIn=!1,this.firstParty=!!i;var o=process.env.VSCODE_LOGS||"";o&&e&&process.env.VSCODE_LOG_LEVEL==="trace"&&(o=mR.join(o,e+".txt"),this.logStream=pR.createWriteStream(o,{flags:"a",encoding:"utf8",autoClose:!0})),this.updateUserOptIn(n),Z.env.onDidChangeTelemetryEnabled!==void 0?this.optOutListener=Z.env.onDidChangeTelemetryEnabled(function(){return s.updateUserOptIn(n)}):this.optOutListener=Z.workspace.onDidChangeConfiguration(function(){return s.updateUserOptIn(n)})}return t.prototype.updateUserOptIn=function(e){var r=Z.workspace.getConfiguration(t.TELEMETRY_CONFIG_ID),n=Z.env.isTelemetryEnabled===void 0?r.get(t.TELEMETRY_CONFIG_ENABLED_ID,!0):Z.env.isTelemetryEnabled;this.userOptIn!==n&&(this.userOptIn=n,this.userOptIn?this.createAppInsightsClient(e):this.dispose())},t.prototype.createAppInsightsClient=function(e){To.defaultClient?(this.appInsightsClient=new To.TelemetryClient(e),this.appInsightsClient.channel.setUseDiskRetryCaching(!0)):(To.setup(e).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this.appInsightsClient=To.defaultClient),this.appInsightsClient.commonProperties=this.getCommonProperties(),Z&&Z.env&&(this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.userId]=Z.env.machineId,this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.sessionId]=Z.env.sessionId),e&&e.indexOf("AIF-")===0&&(this.appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1",this.firstParty=!0)},t.prototype.getCommonProperties=function(){var e=Object.create(null);if(e["common.os"]=Zy.platform(),e["common.platformversion"]=(Zy.release()||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),e["common.extname"]=this.extensionId,e["common.extversion"]=this.extensionVersion,Z&&Z.env){switch(e["common.vscodemachineid"]=Z.env.machineId,e["common.vscodesessionid"]=Z.env.sessionId,e["common.vscodeversion"]=Z.version,e["common.isnewappinstall"]=Z.env.isNewAppInstall,Z.env.uiKind){case Z.UIKind.Web:e["common.uikind"]="web";break;case Z.UIKind.Desktop:e["common.uikind"]="desktop";break;default:e["common.uikind"]="unknown"}e["common.remotename"]=this.cleanRemoteName(Z.env.remoteName)}return e},t.prototype.cleanRemoteName=function(e){if(!e)return"none";var r="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(function(n){e.indexOf(n+"+")===0&&(r=n)}),r},t.prototype.shouldSendErrorTelemetry=function(){return this.firstParty?this.cleanRemoteName(Z.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===Z.ExtensionKind.Workspace||Z.env.uiKind===Z.UIKind.Web):!0},Object.defineProperty(t.prototype,"extension",{get:function(){return this._extension===void 0&&(this._extension=Z.extensions.getExtension(this.extensionId)),this._extension},enumerable:!1,configurable:!0}),t.prototype.cloneAndChange=function(e,r){if(e===null||typeof e!="object"||typeof r!="function")return e;var n={};for(var i in e)n[i]=r(i,e[i]);return n},t.prototype.anonymizeFilePaths=function(e,r){if(e==null)return"";var n=[new RegExp(Z.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")];this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));var i=e;if(r){for(var s=[],o=0,a=n;o<a.length;o++)for(var c=a[o];;){var l=c.exec(e);if(!l)break;s.push([l.index,c.lastIndex])}var u=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,f=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g,d=0;i="";for(var h=function(){var y=f.exec(e);if(!y)return"break";!u.test(y[0])&&s.every(function(E){var x=E[0],T=E[1];return y.index<x||y.index>=T})&&(i+=e.substring(d,y.index)+"<REDACTED: user-file-path>",d=f.lastIndex)};;){var m=h();if(m==="break")break}d<e.length&&(i+=e.substr(d))}for(var v=0,g=n;v<g.length;v++){var c=g[v];i=i.replace(c,"")}return i},t.prototype.sendTelemetryEvent=function(e,r,n){var i=this;if(this.userOptIn&&e&&this.appInsightsClient){var s=this.cloneAndChange(r,function(o,a){return i.anonymizeFilePaths(a,i.firstParty)});this.appInsightsClient.trackEvent({name:this.extensionId+"/"+e,properties:s,measurements:n}),this.logStream&&this.logStream.write("telemetry/"+e+" "+JSON.stringify({properties:r,measurements:n})+`
`)}},t.prototype.sendTelemetryErrorEvent=function(e,r,n,i){var s=this;if(this.userOptIn&&e&&this.appInsightsClient){var o=this.cloneAndChange(r,function(a,c){return s.shouldSendErrorTelemetry()?s.anonymizeFilePaths(c,s.firstParty):i===void 0||i.indexOf(a)!==-1?"REDACTED":s.anonymizeFilePaths(c,s.firstParty)});this.appInsightsClient.trackEvent({name:this.extensionId+"/"+e,properties:o,measurements:n}),this.logStream&&this.logStream.write("telemetry/"+e+" "+JSON.stringify({properties:r,measurements:n})+`
`)}},t.prototype.sendTelemetryException=function(e,r,n){var i=this;if(this.shouldSendErrorTelemetry()&&this.userOptIn&&e&&this.appInsightsClient){var s=this.cloneAndChange(r,function(o,a){return i.anonymizeFilePaths(a,i.firstParty)});this.appInsightsClient.trackException({exception:e,properties:s,measurements:n}),this.logStream&&this.logStream.write("telemetry/"+e.name+" "+e.message+" "+JSON.stringify({properties:r,measurements:n})+`
`)}},t.prototype.dispose=function(){var e=this;this.optOutListener.dispose();var r=new Promise(function(i){if(!e.logStream)return i(void 0);e.logStream.on("finish",i),e.logStream.end()}),n=new Promise(function(i){e.appInsightsClient?e.appInsightsClient.flush({callback:function(){e.appInsightsClient=void 0,i(void 0)}}):i(void 0)});return Promise.all([n,r])},t.TELEMETRY_CONFIG_ID="telemetry",t.TELEMETRY_CONFIG_ENABLED_ID="enableTelemetry",t}();Lu.default=gR});var r_=p(Mu=>{var Fr=require("path"),sr=process.platform==="win32",ir=require("fs"),_R=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function ER(){var t;if(_R){var e=new Error;t=r}else t=n;return t;function r(i){i&&(e.message=i.message,i=e,n(i))}function n(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var s="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(s):console.error(s)}}}}function wR(t){return typeof t=="function"?t:ER()}var ZD=Fr.normalize;sr?Vt=/(.*?)(?:[\/\\]+|$)/g:Vt=/(.*?)(?:[\/]+|$)/g;var Vt;sr?qi=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:qi=/^[\/]*/;var qi;Mu.realpathSync=function(e,r){if(e=Fr.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var n=e,i={},s={},o,a,c,l;u();function u(){var g=qi.exec(e);o=g[0].length,a=g[0],c=g[0],l="",sr&&!s[c]&&(ir.lstatSync(c),s[c]=!0)}for(;o<e.length;){Vt.lastIndex=o;var f=Vt.exec(e);if(l=a,a+=f[0],c=l+f[1],o=Vt.lastIndex,!(s[c]||r&&r[c]===c)){var d;if(r&&Object.prototype.hasOwnProperty.call(r,c))d=r[c];else{var h=ir.lstatSync(c);if(!h.isSymbolicLink()){s[c]=!0,r&&(r[c]=c);continue}var m=null;if(!sr){var v=h.dev.toString(32)+":"+h.ino.toString(32);i.hasOwnProperty(v)&&(m=i[v])}m===null&&(ir.statSync(c),m=ir.readlinkSync(c)),d=Fr.resolve(l,m),r&&(r[c]=d),sr||(i[v]=m)}e=Fr.resolve(d,e.slice(o)),u()}}return r&&(r[n]=e),e};Mu.realpath=function(e,r,n){if(typeof n!="function"&&(n=wR(r),r=null),e=Fr.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(n.bind(null,null,r[e]));var i=e,s={},o={},a,c,l,u;f();function f(){var g=qi.exec(e);a=g[0].length,c=g[0],l=g[0],u="",sr&&!o[l]?ir.lstat(l,function(y){if(y)return n(y);o[l]=!0,d()}):process.nextTick(d)}function d(){if(a>=e.length)return r&&(r[i]=e),n(null,e);Vt.lastIndex=a;var g=Vt.exec(e);return u=c,c+=g[0],l=u+g[1],a=Vt.lastIndex,o[l]||r&&r[l]===l?process.nextTick(d):r&&Object.prototype.hasOwnProperty.call(r,l)?v(r[l]):ir.lstat(l,h)}function h(g,y){if(g)return n(g);if(!y.isSymbolicLink())return o[l]=!0,r&&(r[l]=l),process.nextTick(d);if(!sr){var E=y.dev.toString(32)+":"+y.ino.toString(32);if(s.hasOwnProperty(E))return m(null,s[E],l)}ir.stat(l,function(x){if(x)return n(x);ir.readlink(l,function(T,re){sr||(s[E]=re),m(T,re)})})}function m(g,y,E){if(g)return n(g);var x=Fr.resolve(u,y);r&&(r[E]=x),v(x)}function v(g){e=Fr.resolve(g,e.slice(a)),f()}}});var Uu=p((tP,o_)=>{o_.exports=or;or.realpath=or;or.sync=Hu;or.realpathSync=Hu;or.monkeypatch=xR;or.unmonkeypatch=TR;var Rn=require("fs"),ju=Rn.realpath,$u=Rn.realpathSync,CR=process.version,n_=/^v[0-5]\./.test(CR),i_=r_();function s_(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function or(t,e,r){if(n_)return ju(t,e,r);typeof e=="function"&&(r=e,e=null),ju(t,e,function(n,i){s_(n)?i_.realpath(t,e,r):r(n,i)})}function Hu(t,e){if(n_)return $u(t,e);try{return $u(t,e)}catch(r){if(s_(r))return i_.realpathSync(t,e);throw r}}function xR(){Rn.realpath=or,Rn.realpathSync=Hu}function TR(){Rn.realpath=ju,Rn.realpathSync=$u}});var c_=p((rP,a_)=>{a_.exports=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n],n);SR(i)?r.push.apply(r,i):r.push(i)}return r};var SR=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var h_=p((nP,d_)=>{"use strict";d_.exports=l_;function l_(t,e,r){t instanceof RegExp&&(t=u_(t,r)),e instanceof RegExp&&(e=u_(e,r));var n=f_(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function u_(t,e){var r=e.match(t);return r?r[0]:null}l_.range=f_;function f_(t,e,r){var n,i,s,o,a,c=r.indexOf(t),l=r.indexOf(e,c+1),u=c;if(c>=0&&l>0){if(t===e)return[c,l];for(n=[],s=r.length;u>=0&&!a;)u==c?(n.push(u),c=r.indexOf(t,u+1)):n.length==1?a=[n.pop(),l]:(i=n.pop(),i<s&&(s=i,o=l),l=r.indexOf(e,u+1)),u=c<l&&c>=0?c:l;n.length&&(a=[s,o])}return a}});var w_=p((iP,E_)=>{var bR=c_(),p_=h_();E_.exports=AR;var m_="\0SLASH"+Math.random()+"\0",g_="\0OPEN"+Math.random()+"\0",Gu="\0CLOSE"+Math.random()+"\0",v_="\0COMMA"+Math.random()+"\0",y_="\0PERIOD"+Math.random()+"\0";function Bu(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function IR(t){return t.split("\\\\").join(m_).split("\\{").join(g_).split("\\}").join(Gu).split("\\,").join(v_).split("\\.").join(y_)}function RR(t){return t.split(m_).join("\\").split(g_).join("{").split(Gu).join("}").split(v_).join(",").split(y_).join(".")}function __(t){if(!t)return[""];var e=[],r=p_("{","}",t);if(!r)return t.split(",");var n=r.pre,i=r.body,s=r.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var a=__(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function AR(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),An(IR(t),!0).map(RR)):[]}function OR(t){return"{"+t+"}"}function kR(t){return/^-?0\d/.test(t)}function DR(t,e){return t<=e}function PR(t,e){return t>=e}function An(t,e){var r=[],n=p_("{","}",t);if(!n||/\$$/.test(n.pre))return[t];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),o=i||s,a=n.body.indexOf(",")>=0;if(!o&&!a)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+Gu+n.post,An(t)):[t];var c;if(o)c=n.body.split(/\.\./);else if(c=__(n.body),c.length===1&&(c=An(c[0],!1).map(OR),c.length===1)){var u=n.post.length?An(n.post,!1):[""];return u.map(function(R){return n.pre+c[0]+R})}var l=n.pre,u=n.post.length?An(n.post,!1):[""],f;if(o){var d=Bu(c[0]),h=Bu(c[1]),m=Math.max(c[0].length,c[1].length),v=c.length==3?Math.abs(Bu(c[2])):1,g=DR,y=h<d;y&&(v*=-1,g=PR);var E=c.some(kR);f=[];for(var x=d;g(x,h);x+=v){var T;if(s)T=String.fromCharCode(x),T==="\\"&&(T="");else if(T=String(x),E){var re=m-T.length;if(re>0){var pe=new Array(re+1).join("0");x<0?T="-"+pe+T.slice(1):T=pe+T}}f.push(T)}}else f=bR(c,function(k){return An(k,!1)});for(var oe=0;oe<f.length;oe++)for(var ee=0;ee<u.length;ee++){var w=l+f[oe]+u[ee];(!e||o||w)&&r.push(w)}return r}});var Ao=p((sP,b_)=>{b_.exports=at;at.Minimatch=Le;var Ni=function(){try{return require("path")}catch{}}()||{sep:"/"};at.sep=Ni.sep;var zu=at.GLOBSTAR=Le.GLOBSTAR={},qR=w_(),C_={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Vu="[^/]",Wu=Vu+"*?",NR="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",LR="(?:(?!(?:\\/|^)\\.).)*?",x_=FR("().*{}+?[]^$\\!");function FR(t){return t.split("").reduce(function(e,r){return e[r]=!0,e},{})}var T_=/\/+/;at.filter=MR;function MR(t,e){return e=e||{},function(r,n,i){return at(r,t,e)}}function ar(t,e){e=e||{};var r={};return Object.keys(t).forEach(function(n){r[n]=t[n]}),Object.keys(e).forEach(function(n){r[n]=e[n]}),r}at.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return at;var e=at,r=function(i,s,o){return e(i,s,ar(t,o))};return r.Minimatch=function(i,s){return new e.Minimatch(i,ar(t,s))},r.Minimatch.defaults=function(i){return e.defaults(ar(t,i)).Minimatch},r.filter=function(i,s){return e.filter(i,ar(t,s))},r.defaults=function(i){return e.defaults(ar(t,i))},r.makeRe=function(i,s){return e.makeRe(i,ar(t,s))},r.braceExpand=function(i,s){return e.braceExpand(i,ar(t,s))},r.match=function(n,i,s){return e.match(n,i,ar(t,s))},r};Le.defaults=function(t){return at.defaults(t).Minimatch};function at(t,e,r){return Ro(e),r||(r={}),!r.nocomment&&e.charAt(0)==="#"?!1:new Le(e,r).match(t)}function Le(t,e){if(!(this instanceof Le))return new Le(t,e);Ro(t),e||(e={}),t=t.trim(),!e.allowWindowsEscape&&Ni.sep!=="/"&&(t=t.split(Ni.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}Le.prototype.debug=function(){};Le.prototype.make=jR;function jR(){var t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,r),r=this.globParts=r.map(function(n){return n.split(T_)}),this.debug(this.pattern,r),r=r.map(function(n,i,s){return n.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(n){return n.indexOf(!1)===-1}),this.debug(this.pattern,r),this.set=r}Le.prototype.parseNegate=$R;function $R(){var t=this.pattern,e=!1,r=this.options,n=0;if(!r.nonegate){for(var i=0,s=t.length;i<s&&t.charAt(i)==="!";i++)e=!e,n++;n&&(this.pattern=t.substr(n)),this.negate=e}}at.braceExpand=function(t,e){return S_(t,e)};Le.prototype.braceExpand=S_;function S_(t,e){return e||(this instanceof Le?e=this.options:e={}),t=typeof t>"u"?this.pattern:t,Ro(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:qR(t)}var HR=1024*64,Ro=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>HR)throw new TypeError("pattern is too long")};Le.prototype.parse=UR;var Io={};function UR(t,e){Ro(t);var r=this.options;if(t==="**")if(r.noglobstar)t="*";else return zu;if(t==="")return"";var n="",i=!!r.nocase,s=!1,o=[],a=[],c,l=!1,u=-1,f=-1,d=t.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function m(){if(c){switch(c){case"*":n+=Wu,i=!0;break;case"?":n+=Vu,i=!0;break;default:n+="\\"+c;break}h.debug("clearStateChar %j %j",c,n),c=!1}}for(var v=0,g=t.length,y;v<g&&(y=t.charAt(v));v++){if(this.debug("%s	%s %s %j",t,v,n,y),s&&x_[y]){n+="\\"+y,s=!1;continue}switch(y){case"/":return!1;case"\\":m(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,v,n,y),l){this.debug("  in class"),y==="!"&&v===f+1&&(y="^"),n+=y;continue}h.debug("call clearStateChar %j",c),m(),c=y,r.noext&&m();continue;case"(":if(l){n+="(";continue}if(!c){n+="\\(";continue}o.push({type:c,start:v-1,reStart:n.length,open:C_[c].open,close:C_[c].close}),n+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,n),c=!1;continue;case")":if(l||!o.length){n+="\\)";continue}m(),i=!0;var E=o.pop();n+=E.close,E.type==="!"&&a.push(E),E.reEnd=n.length;continue;case"|":if(l||!o.length||s){n+="\\|",s=!1;continue}m(),n+="|";continue;case"[":if(m(),l){n+="\\"+y;continue}l=!0,f=v,u=n.length,n+=y;continue;case"]":if(v===f+1||!l){n+="\\"+y,s=!1;continue}var x=t.substring(f+1,v);try{RegExp("["+x+"]")}catch{var T=this.parse(x,Io);n=n.substr(0,u)+"\\["+T[0]+"\\]",i=i||T[1],l=!1;continue}i=!0,l=!1,n+=y;continue;default:m(),s?s=!1:x_[y]&&!(y==="^"&&l)&&(n+="\\"),n+=y}}for(l&&(x=t.substr(f+1),T=this.parse(x,Io),n=n.substr(0,u)+"\\["+T[0],i=i||T[1]),E=o.pop();E;E=o.pop()){var re=n.slice(E.reStart+E.open.length);this.debug("setting tail",n,E),re=re.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(be,L,vt){return vt||(vt="\\"),L+L+vt+"|"}),this.debug(`tail=%j
   %s`,re,re,E,n);var pe=E.type==="*"?Wu:E.type==="?"?Vu:"\\"+E.type;i=!0,n=n.slice(0,E.reStart)+pe+"\\("+re}m(),s&&(n+="\\\\");var oe=!1;switch(n.charAt(0)){case"[":case".":case"(":oe=!0}for(var ee=a.length-1;ee>-1;ee--){var w=a[ee],k=n.slice(0,w.reStart),R=n.slice(w.reStart,w.reEnd-8),ae=n.slice(w.reEnd-8,w.reEnd),J=n.slice(w.reEnd);ae+=J;var de=k.split("(").length-1,U=J;for(v=0;v<de;v++)U=U.replace(/\)[+*?]?/,"");J=U;var B="";J===""&&e!==Io&&(B="$");var M=k+R+J+B+ae;n=M}if(n!==""&&i&&(n="(?=.)"+n),oe&&(n=d+n),e===Io)return[n,i];if(!i)return GR(t);var P=r.nocase?"i":"";try{var F=new RegExp("^"+n+"$",P)}catch{return new RegExp("$.")}return F._glob=t,F._src=n,F}at.makeRe=function(t,e){return new Le(t,e||{}).makeRe()};Le.prototype.makeRe=BR;function BR(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?Wu:e.dot?NR:LR,n=e.nocase?"i":"",i=t.map(function(s){return s.map(function(o){return o===zu?r:typeof o=="string"?VR(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch{this.regexp=!1}return this.regexp}at.match=function(t,e,r){r=r||{};var n=new Le(e,r);return t=t.filter(function(i){return n.match(i)}),n.options.nonull&&!t.length&&t.push(e),t};Le.prototype.match=function(e,r){if(typeof r>"u"&&(r=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;var n=this.options;Ni.sep!=="/"&&(e=e.split(Ni.sep).join("/")),e=e.split(T_),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var s,o;for(o=e.length-1;o>=0&&(s=e[o],!s);o--);for(o=0;o<i.length;o++){var a=i[o],c=e;n.matchBase&&a.length===1&&(c=[s]);var l=this.matchOne(c,a,r);if(l)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate};Le.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,s=0,o=t.length,a=e.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var c=e[s],l=t[i];if(this.debug(e,c,l),c===!1)return!1;if(c===zu){this.debug("GLOBSTAR",[e,c,l]);var u=i,f=s+1;if(f===a){for(this.debug("** at the end");i<o;i++)if(t[i]==="."||t[i]===".."||!n.dot&&t[i].charAt(0)===".")return!1;return!0}for(;u<o;){var d=t[u];if(this.debug(`
globstar while`,t,u,e,f,d),this.matchOne(t.slice(u),e.slice(f),r))return this.debug("globstar found match!",u,o,d),!0;if(d==="."||d===".."||!n.dot&&d.charAt(0)==="."){this.debug("dot detected!",t,u,e,f);break}this.debug("globstar swallow a segment, and continue"),u++}return!!(r&&(this.debug(`
>>> no match, partial?`,t,u,e,f),u===o))}var h;if(typeof c=="string"?(h=l===c,this.debug("string match",c,l,h)):(h=l.match(c),this.debug("pattern match",c,l,h)),!h)return!1}if(i===o&&s===a)return!0;if(i===o)return r;if(s===a)return i===o-1&&t[i]==="";throw new Error("wtf?")};function GR(t){return t.replace(/\\(.)/g,"$1")}function VR(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var I_=p((oP,Xu)=>{typeof Object.create=="function"?Xu.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Xu.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var R_=p((aP,Yu)=>{try{if(Qu=require("util"),typeof Qu.inherits!="function")throw"";Yu.exports=Qu.inherits}catch{Yu.exports=I_()}var Qu});var ko=p((cP,Oo)=>{"use strict";function A_(t){return t.charAt(0)==="/"}function O_(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=e.exec(t),n=r[1]||"",i=Boolean(n&&n.charAt(1)!==":");return Boolean(r[2]||i)}Oo.exports=process.platform==="win32"?O_:A_;Oo.exports.posix=A_;Oo.exports.win32=O_});var Ju=p(cr=>{cr.setopts=KR;cr.ownProp=k_;cr.makeAbs=Li;cr.finish=JR;cr.mark=ZR;cr.isIgnored=P_;cr.childrenIgnored=eA;function k_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var WR=require("fs"),On=require("path"),zR=Ao(),D_=ko(),Ku=zR.Minimatch;function XR(t,e){return t.localeCompare(e,"en")}function QR(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(YR))}function YR(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new Ku(r,{dot:!0})}return{matcher:new Ku(t,{dot:!0}),gmatcher:e}}function KR(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||WR,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),QR(t,r),t.changedCwd=!1;var n=process.cwd();k_(r,"cwd")?(t.cwd=On.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=n,t.root=r.root||On.resolve(t.cwd,"/"),t.root=On.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=D_(t.cwd)?t.cwd:Li(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new Ku(e,r),t.options=t.minimatch.options}function JR(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var s=t.matches[n];if(!s||Object.keys(s).length===0){if(t.nonull){var o=t.minimatch.globSet[n];e?r.push(o):r[o]=!0}}else{var a=Object.keys(s);e?r.push.apply(r,a):a.forEach(function(c){r[c]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(XR)),t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(c){var l=!/\/$/.test(c),u=t.cache[c]||t.cache[Li(t,c)];return l&&u&&(l=u!=="DIR"&&!Array.isArray(u)),l}))}t.ignore.length&&(r=r.filter(function(c){return!P_(t,c)})),t.found=r}function ZR(t,e){var r=Li(t,e),n=t.cache[r],i=e;if(n){var s=n==="DIR"||Array.isArray(n),o=e.slice(-1)==="/";if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==e){var a=Li(t,i);t.statCache[a]=t.statCache[r],t.cache[a]=t.cache[r]}}return i}function Li(t,e){var r=e;return e.charAt(0)==="/"?r=On.join(t.root,e):D_(e)||e===""?r=e:t.changedCwd?r=On.resolve(t.cwd,e):r=On.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function P_(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function eA(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}});var M_=p((hP,F_)=>{F_.exports=L_;L_.GlobSync=xe;var tA=Uu(),q_=Ao(),lP=q_.Minimatch,fP=tl().Glob,dP=require("util"),Zu=require("path"),N_=require("assert"),Do=ko(),Mr=Ju(),rA=Mr.setopts,el=Mr.ownProp,nA=Mr.childrenIgnored,iA=Mr.isIgnored;function L_(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new xe(t,e).found}function xe(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof xe))return new xe(t,e);if(rA(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}xe.prototype._finish=function(){if(N_(this instanceof xe),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i);var s=tA.realpathSync(i,t.realpathCache);n[s]=!0}catch(o){if(o.syscall==="stat")n[t._makeAbs(i)]=!0;else throw o}})}Mr.finish(this)};xe.prototype._process=function(t,e,r){N_(this instanceof xe);for(var n=0;typeof t[n]=="string";)n++;var i;switch(n){case t.length:this._processSimple(t.join("/"),e);return;case 0:i=null;break;default:i=t.slice(0,n).join("/");break}var s=t.slice(n),o;i===null?o=".":((Do(i)||Do(t.join("/")))&&(!i||!Do(i))&&(i="/"+i),o=i);var a=this._makeAbs(o);if(!nA(this,o)){var c=s[0]===q_.GLOBSTAR;c?this._processGlobStar(i,o,a,s,e,r):this._processReaddir(i,o,a,s,e,r)}};xe.prototype._processReaddir=function(t,e,r,n,i,s){var o=this._readdir(r,s);if(!!o){for(var a=n[0],c=!!this.minimatch.negate,l=a._glob,u=this.dot||l.charAt(0)===".",f=[],d=0;d<o.length;d++){var h=o[d];if(h.charAt(0)!=="."||u){var m;c&&!t?m=!h.match(a):m=h.match(a),m&&f.push(h)}}var v=f.length;if(v!==0){if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var d=0;d<v;d++){var h=f[d];t&&(t.slice(-1)!=="/"?h=t+"/"+h:h=t+h),h.charAt(0)==="/"&&!this.nomount&&(h=Zu.join(this.root,h)),this._emitMatch(i,h)}return}n.shift();for(var d=0;d<v;d++){var h=f[d],g;t?g=[t,h]:g=[h],this._process(g.concat(n),i,s)}}}};xe.prototype._emitMatch=function(t,e){if(!iA(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};xe.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r,n;try{r=this.fs.lstatSync(t)}catch(s){if(s.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,!i&&r&&!r.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};xe.prototype._readdir=function(t,e){var r;if(e&&!el(this.symlinks,t))return this._readdirInGlobStar(t);if(el(this.cache,t)){var n=this.cache[t];if(!n||n==="FILE")return null;if(Array.isArray(n))return n}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(i){return this._readdirError(t,i),null}};xe.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];t==="/"?n=t+n:n=t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e};xe.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};xe.prototype._processGlobStar=function(t,e,r,n,i,s){var o=this._readdir(r,s);if(!!o){var a=n.slice(1),c=t?[t]:[],l=c.concat(a);this._process(l,i,!1);var u=o.length,f=this.symlinks[r];if(!(f&&s))for(var d=0;d<u;d++){var h=o[d];if(!(h.charAt(0)==="."&&!this.dot)){var m=c.concat(o[d],a);this._process(m,i,!0);var v=c.concat(o[d],n);this._process(v,i,!0)}}}};xe.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!r){if(t&&Do(t)&&!this.nomount){var n=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Zu.join(this.root,t):(t=Zu.resolve(this.root,t),n&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};xe.prototype._stat=function(t){var e=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&el(this.cache,e)){var o=this.cache[e];if(Array.isArray(o)&&(o="DIR"),!r||o==="DIR")return o;if(r&&o==="FILE")return!1}var n,i=this.statCache[e];if(!i){var s;try{s=this.fs.lstatSync(e)}catch(a){if(a&&(a.code==="ENOENT"||a.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(s&&s.isSymbolicLink())try{i=this.fs.statSync(e)}catch{i=s}else i=s}this.statCache[e]=i;var o=!0;return i&&(o=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,r&&o==="FILE"?!1:o};xe.prototype._mark=function(t){return Mr.mark(this,t)};xe.prototype._makeAbs=function(t){return Mr.makeAbs(this,t)}});var rl=p((pP,$_)=>{$_.exports=j_;function j_(t,e){if(t&&e)return j_(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(n){r[n]=t[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var s=t.apply(this,n),o=n[n.length-1];return typeof s=="function"&&s!==o&&Object.keys(o).forEach(function(a){s[a]=o[a]}),s}}});var il=p((mP,nl)=>{var H_=rl();nl.exports=H_(Po);nl.exports.strict=H_(U_);Po.proto=Po(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Po(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return U_(this)},configurable:!0})});function Po(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function U_(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var G_=p((gP,B_)=>{var sA=rl(),Fi=Object.create(null),oA=il();B_.exports=sA(aA);function aA(t,e){return Fi[t]?(Fi[t].push(e),null):(Fi[t]=[e],cA(t))}function cA(t){return oA(function e(){var r=Fi[t],n=r.length,i=uA(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,i)})):delete Fi[t]}})}function uA(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}});var tl=p((_P,W_)=>{W_.exports=jr;var lA=Uu(),V_=Ao(),vP=V_.Minimatch,fA=R_(),dA=require("events").EventEmitter,sl=require("path"),ol=require("assert"),Mi=ko(),cl=M_(),$r=Ju(),hA=$r.setopts,al=$r.ownProp,ul=G_(),yP=require("util"),pA=$r.childrenIgnored,mA=$r.isIgnored,gA=il();function jr(t,e,r){if(typeof e=="function"&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return cl(t,e)}return new G(t,e,r)}jr.sync=cl;var vA=jr.GlobSync=cl.GlobSync;jr.glob=jr;function yA(t,e){if(e===null||typeof e!="object")return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}jr.hasMagic=function(t,e){var r=yA({},e);r.noprocess=!0;var n=new G(t,r),i=n.minimatch.set;if(!t)return!1;if(i.length>1)return!0;for(var s=0;s<i[0].length;s++)if(typeof i[0][s]!="string")return!0;return!1};jr.Glob=G;fA(G,dA);function G(t,e,r){if(typeof e=="function"&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new vA(t,e)}if(!(this instanceof G))return new G(t,e,r);hA(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),typeof r=="function"&&(r=gA(r),this.on("error",r),this.on("end",function(c){r(null,c)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(n===0)return a();for(var s=!0,o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,a);s=!1;function a(){--i._processing,i._processing<=0&&(s?process.nextTick(function(){i._finish()}):i._finish())}}G.prototype._finish=function(){if(ol(this instanceof G),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();$r.finish(this),this.emit("end",this.found)}};G.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n);function n(){--t===0&&e._finish()}};G.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,s=n.length;if(s===0)return e();var o=this.matches[t]=Object.create(null);n.forEach(function(a,c){a=i._makeAbs(a),lA.realpath(a,i.realpathCache,function(l,u){l?l.syscall==="stat"?o[a]=!0:i.emit("error",l):o[u]=!0,--s===0&&(i.matches[t]=o,e())})})};G.prototype._mark=function(t){return $r.mark(this,t)};G.prototype._makeAbs=function(t){return $r.makeAbs(this,t)};G.prototype.abort=function(){this.aborted=!0,this.emit("abort")};G.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};G.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};G.prototype._process=function(t,e,r,n){if(ol(this instanceof G),ol(typeof n=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,r,n]);return}for(var i=0;typeof t[i]=="string";)i++;var s;switch(i){case t.length:this._processSimple(t.join("/"),e,n);return;case 0:s=null;break;default:s=t.slice(0,i).join("/");break}var o=t.slice(i),a;s===null?a=".":((Mi(s)||Mi(t.join("/")))&&(!s||!Mi(s))&&(s="/"+s),a=s);var c=this._makeAbs(a);if(pA(this,a))return n();var l=o[0]===V_.GLOBSTAR;l?this._processGlobStar(s,a,c,o,e,r,n):this._processReaddir(s,a,c,o,e,r,n)}};G.prototype._processReaddir=function(t,e,r,n,i,s,o){var a=this;this._readdir(r,s,function(c,l){return a._processReaddir2(t,e,r,n,i,s,l,o)})};G.prototype._processReaddir2=function(t,e,r,n,i,s,o,a){if(!o)return a();for(var c=n[0],l=!!this.minimatch.negate,u=c._glob,f=this.dot||u.charAt(0)===".",d=[],h=0;h<o.length;h++){var m=o[h];if(m.charAt(0)!=="."||f){var v;l&&!t?v=!m.match(c):v=m.match(c),v&&d.push(m)}}var g=d.length;if(g===0)return a();if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var h=0;h<g;h++){var m=d[h];t&&(t!=="/"?m=t+"/"+m:m=t+m),m.charAt(0)==="/"&&!this.nomount&&(m=sl.join(this.root,m)),this._emitMatch(i,m)}return a()}n.shift();for(var h=0;h<g;h++){var m=d[h],y;t&&(t!=="/"?m=t+"/"+m:m=t+m),this._process([m].concat(n),i,s,a)}a()};G.prototype._emitMatch=function(t,e){if(!this.aborted&&!mA(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var r=Mi(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}};G.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var r="lstat\0"+t,n=this,i=ul(r,s);i&&n.fs.lstat(t,i);function s(o,a){if(o&&o.code==="ENOENT")return e();var c=a&&a.isSymbolicLink();n.symlinks[t]=c,!c&&a&&!a.isDirectory()?(n.cache[t]="FILE",e()):n._readdir(t,!1,e)}};G.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=ul("readdir\0"+t+"\0"+e,r),!!r)){if(e&&!al(this.symlinks,t))return this._readdirInGlobStar(t,r);if(al(this.cache,t)){var n=this.cache[t];if(!n||n==="FILE")return r();if(Array.isArray(n))return r(null,n)}var i=this;i.fs.readdir(t,_A(this,t,r))}};function _A(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}G.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];t==="/"?i=t+i:i=t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}};G.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return r()}};G.prototype._processGlobStar=function(t,e,r,n,i,s,o){var a=this;this._readdir(r,s,function(c,l){a._processGlobStar2(t,e,r,n,i,s,l,o)})};G.prototype._processGlobStar2=function(t,e,r,n,i,s,o,a){if(!o)return a();var c=n.slice(1),l=t?[t]:[],u=l.concat(c);this._process(u,i,!1,a);var f=this.symlinks[r],d=o.length;if(f&&s)return a();for(var h=0;h<d;h++){var m=o[h];if(!(m.charAt(0)==="."&&!this.dot)){var v=l.concat(o[h],c);this._process(v,i,!0,a);var g=l.concat(o[h],n);this._process(g,i,!0,a)}}a()};G.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,s){n._processSimple2(t,e,i,s,r)})};G.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&Mi(t)&&!this.nomount){var s=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=sl.join(this.root,t):(t=sl.resolve(this.root,t),s&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()};G.prototype._stat=function(t,e){var r=this._makeAbs(t),n=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&al(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||i==="DIR")return e(null,i);if(n&&i==="FILE")return e()}var s,o=this.statCache[r];if(o!==void 0){if(o===!1)return e(null,o);var a=o.isDirectory()?"DIR":"FILE";return n&&a==="FILE"?e():e(null,a,o)}var c=this,l=ul("stat\0"+r,u);l&&c.fs.lstat(r,l);function u(f,d){if(d&&d.isSymbolicLink())return c.fs.stat(r,function(h,m){h?c._stat2(t,r,null,d,e):c._stat2(t,r,h,m,e)});c._stat2(t,r,f,d,e)}};G.prototype._stat2=function(t,e,r,n,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[e]=!1,i();var s=t.slice(-1)==="/";if(this.statCache[e]=n,e.slice(-1)==="/"&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,s&&o==="FILE"?i():i(null,o,n)}});var eE=p((EP,Z_)=>{var K=require("assert"),Y_=require("path"),z_=require("fs"),kn;try{kn=tl()}catch{}var EA={nosort:!0,silent:!0},ll=0,ji=process.platform==="win32",K_=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||z_[r],r=r+"Sync",t[r]=t[r]||z_[r]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&kn===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||EA},dl=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),K(t,"rimraf: missing path"),K.equal(typeof t,"string","rimraf: path should be a string"),K.equal(typeof r,"function","rimraf: callback function required"),K(e,"rimraf: invalid options argument provided"),K.equal(typeof e,"object","rimraf: options should be object"),K_(e);let n=0,i=null,s=0,o=c=>{i=i||c,--s===0&&r(i)},a=(c,l)=>{if(c)return r(c);if(s=l.length,s===0)return r();l.forEach(u=>{let f=d=>{if(d){if((d.code==="EBUSY"||d.code==="ENOTEMPTY"||d.code==="EPERM")&&n<e.maxBusyTries)return n++,setTimeout(()=>fl(u,e,f),n*100);if(d.code==="EMFILE"&&ll<e.emfileWait)return setTimeout(()=>fl(u,e,f),ll++);d.code==="ENOENT"&&(d=null)}ll=0,o(d)};fl(u,e,f)})};if(e.disableGlob||!kn.hasMagic(t))return a(null,[t]);e.lstat(t,(c,l)=>{if(!c)return a(null,[t]);kn(t,e.glob,a)})},fl=(t,e,r)=>{K(t),K(e),K(typeof r=="function"),e.lstat(t,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&ji&&X_(t,e,n,r),i&&i.isDirectory())return qo(t,e,n,r);e.unlink(t,s=>{if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return ji?X_(t,e,s,r):qo(t,e,s,r);if(s.code==="EISDIR")return qo(t,e,s,r)}return r(s)})})},X_=(t,e,r,n)=>{K(t),K(e),K(typeof n=="function"),e.chmod(t,438,i=>{i?n(i.code==="ENOENT"?null:r):e.stat(t,(s,o)=>{s?n(s.code==="ENOENT"?null:r):o.isDirectory()?qo(t,e,r,n):e.unlink(t,n)})})},Q_=(t,e,r)=>{K(t),K(e);try{e.chmodSync(t,438)}catch(i){if(i.code==="ENOENT")return;throw r}let n;try{n=e.statSync(t)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?No(t,e,r):e.unlinkSync(t)},qo=(t,e,r,n)=>{K(t),K(e),K(typeof n=="function"),e.rmdir(t,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?wA(t,e,n):i&&i.code==="ENOTDIR"?n(r):n(i)})},wA=(t,e,r)=>{K(t),K(e),K(typeof r=="function"),e.readdir(t,(n,i)=>{if(n)return r(n);let s=i.length;if(s===0)return e.rmdir(t,r);let o;i.forEach(a=>{dl(Y_.join(t,a),e,c=>{if(!o){if(c)return r(o=c);--s===0&&e.rmdir(t,r)}})})})},J_=(t,e)=>{e=e||{},K_(e),K(t,"rimraf: missing path"),K.equal(typeof t,"string","rimraf: path should be a string"),K(e,"rimraf: missing options"),K.equal(typeof e,"object","rimraf: options should be object");let r;if(e.disableGlob||!kn.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch{r=kn.sync(t,e.glob)}if(!!r.length)for(let n=0;n<r.length;n++){let i=r[n],s;try{s=e.lstatSync(i)}catch(o){if(o.code==="ENOENT")return;o.code==="EPERM"&&ji&&Q_(i,e,o)}try{s&&s.isDirectory()?No(i,e,null):e.unlinkSync(i)}catch(o){if(o.code==="ENOENT")return;if(o.code==="EPERM")return ji?Q_(i,e,o):No(i,e,o);if(o.code!=="EISDIR")throw o;No(i,e,o)}}},No=(t,e,r)=>{K(t),K(e);try{e.rmdirSync(t)}catch(n){if(n.code==="ENOENT")return;if(n.code==="ENOTDIR")throw r;(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")&&CA(t,e)}},CA=(t,e)=>{K(t),K(e),e.readdirSync(t).forEach(i=>J_(Y_.join(t,i),e));let r=ji?100:1,n=0;do{let i=!0;try{let s=e.rmdirSync(t,e);return i=!1,s}finally{if(++n<r&&i)continue}}while(!0)};Z_.exports=dl;dl.sync=J_});var yE=p((wP,Wt)=>{var Te=require("fs"),vl=require("os"),ct=require("path"),tE=require("crypto"),Dt={fs:Te.constants,os:vl.constants},iE=eE(),rE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",sE=/XXXXXX/,xA=3,oE=(Dt.O_CREAT||Dt.fs.O_CREAT)|(Dt.O_EXCL||Dt.fs.O_EXCL)|(Dt.O_RDWR||Dt.fs.O_RDWR),TA=vl.platform()==="win32",SA=Dt.EBADF||Dt.os.errno.EBADF,bA=Dt.ENOENT||Dt.os.errno.ENOENT,aE=448,cE=384,IA="exit",Dn=[],uE=Te.rmdirSync.bind(Te),lE=iE.sync,fE=!1;function yl(t,e){let r=Pn(t,e),n=r[0],i=r[1];try{mE(n)}catch(o){return i(o)}let s=n.tries;(function o(){try{let a=pE(n);Te.stat(a,function(c){if(!c)return s-- >0?o():i(new Error("Could not get a unique tmp filename, max tries reached "+a));i(null,a)})}catch(a){i(a)}})()}function _l(t){let e=Pn(t),r=e[0];mE(r);let n=r.tries;do{let i=pE(r);try{Te.statSync(i)}catch{return i}}while(n-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function RA(t,e){let r=Pn(t,e),n=r[0],i=r[1];yl(n,function(o,a){if(o)return i(o);Te.open(a,oE,n.mode||cE,function(l,u){if(l)return i(l);if(n.discardDescriptor)return Te.close(u,function(d){return i(d,a,void 0,pl(a,-1,n,!1))});{let f=n.discardDescriptor||n.detachDescriptor;i(null,a,u,pl(a,f?-1:u,n,!1))}})})}function AA(t){let e=Pn(t),r=e[0],n=r.discardDescriptor||r.detachDescriptor,i=_l(r);var s=Te.openSync(i,oE,r.mode||cE);return r.discardDescriptor&&(Te.closeSync(s),s=void 0),{name:i,fd:s,removeCallback:pl(i,n?-1:s,r,!0)}}function OA(t,e){let r=Pn(t,e),n=r[0],i=r[1];yl(n,function(o,a){if(o)return i(o);Te.mkdir(a,n.mode||aE,function(l){if(l)return i(l);i(null,a,dE(a,n,!1))})})}function kA(t){let e=Pn(t),r=e[0],n=_l(r);return Te.mkdirSync(n,r.mode||aE),{name:n,removeCallback:dE(n,r,!0)}}function DA(t,e){let r=function(n){if(n&&!gl(n))return e(n);e()};0<=t[0]?Te.close(t[0],function(){Te.unlink(t[1],r)}):Te.unlink(t[1],r)}function PA(t){let e=null;try{0<=t[0]&&Te.closeSync(t[0])}catch(r){if(!NA(r)&&!gl(r))throw r}finally{try{Te.unlinkSync(t[1])}catch(r){gl(r)||(e=r)}}if(e!==null)throw e}function pl(t,e,r,n){let i=Lo(PA,[e,t],n),s=Lo(DA,[e,t],n,i);return r.keep||Dn.unshift(i),n?i:s}function dE(t,e,r){let n=e.unsafeCleanup?iE:Te.rmdir.bind(Te),i=e.unsafeCleanup?lE:uE,s=Lo(i,t,r),o=Lo(n,t,r,s);return e.keep||Dn.unshift(s),r?s:o}function Lo(t,e,r,n){let i=!1;return function s(o){if(!i){let a=n||s,c=Dn.indexOf(a);return c>=0&&Dn.splice(c,1),i=!0,r||t===uE||t===lE?t(e):t(e,o||function(){})}}}function qA(){if(!!fE)for(;Dn.length;)try{Dn[0]()}catch{}}function nE(t){let e=[],r=null;try{r=tE.randomBytes(t)}catch{r=tE.pseudoRandomBytes(t)}for(var n=0;n<t;n++)e.push(rE[r[n]%rE.length]);return e.join("")}function hE(t){return t===null||et(t)||!t.trim()}function et(t){return typeof t>"u"}function Pn(t,e){if(typeof t=="function")return[{},t];if(et(t))return[{},e];let r={};for(let n of Object.getOwnPropertyNames(t))r[n]=t[n];return[r,e]}function pE(t){let e=t.tmpdir;if(!et(t.name))return ct.join(e,t.dir,t.name);if(!et(t.template))return ct.join(e,t.dir,t.template).replace(sE,nE(6));let r=[t.prefix?t.prefix:"tmp","-",process.pid,"-",nE(12),t.postfix?"-"+t.postfix:""].join("");return ct.join(e,t.dir,r)}function mE(t){t.tmpdir=vE(t);let e=t.tmpdir;if(et(t.name)||hl(t.name,"name",e),et(t.dir)||hl(t.dir,"dir",e),!et(t.template)&&(hl(t.template,"template",e),!t.template.match(sE)))throw new Error(`Invalid template, found "${t.template}".`);if(!et(t.tries)&&isNaN(t.tries)||t.tries<0)throw new Error(`Invalid tries, found "${t.tries}".`);t.tries=et(t.name)?t.tries||xA:1,t.keep=!!t.keep,t.detachDescriptor=!!t.detachDescriptor,t.discardDescriptor=!!t.discardDescriptor,t.unsafeCleanup=!!t.unsafeCleanup,t.dir=et(t.dir)?"":ct.relative(e,ml(t.dir,e)),t.template=et(t.template)?void 0:ct.relative(e,ml(t.template,e)),t.template=hE(t.template)?void 0:ct.relative(t.dir,t.template),t.name=et(t.name)?void 0:El(t.name),t.prefix=et(t.prefix)?"":t.prefix,t.postfix=et(t.postfix)?"":t.postfix}function ml(t,e){let r=El(t);return r.startsWith(e)?ct.resolve(r):ct.resolve(ct.join(e,r))}function El(t){return hE(t)?t:t.replace(/["']/g,"")}function hl(t,e,r){if(e==="name"){if(ct.isAbsolute(t))throw new Error(`${e} option must not contain an absolute path, found "${t}".`);let n=ct.basename(t);if(n===".."||n==="."||n!==t)throw new Error(`${e} option must not contain a path, found "${t}".`)}else{if(ct.isAbsolute(t)&&!t.startsWith(r))throw new Error(`${e} option must be relative to "${r}", found "${t}".`);let n=ml(t,r);if(!n.startsWith(r))throw new Error(`${e} option must be relative to "${r}", found "${n}".`)}}function NA(t){return gE(t,-SA,"EBADF")}function gl(t){return gE(t,-bA,"ENOENT")}function gE(t,e,r){return TA?t.code===r:t.code===r&&t.errno===e}function LA(){fE=!0}function vE(t){return ct.resolve(El(t&&t.tmpdir||vl.tmpdir()))}process.addListener(IA,qA);Object.defineProperty(Wt.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return vE()}});Wt.exports.dir=OA;Wt.exports.dirSync=kA;Wt.exports.file=RA;Wt.exports.fileSync=AA;Wt.exports.tmpName=yl;Wt.exports.tmpNameSync=_l;Wt.exports.setGracefulCleanup=LA});var $A={};AE($A,{Extension:()=>Ho,activate:()=>FA,deactivate:()=>MA});module.exports=OE($A);var X=q(require("vscode")),lr=q(require("path")),fr=q(require("fs"));var Nn=q(require("vscode")),Bi=class{constructor(e){this.extension=e,this.logPanel=Nn.window.createOutputChannel("LaTeX Utilities"),this.addLogMessage("Initializing LaTeX Utilities.")}addLogMessage(e){this.logPanel.append(`[${new Date().toLocaleTimeString("en-US",{hour12:!1})}] ${e}
`)}showErrorMessage(e,...r){if(Nn.workspace.getConfiguration("latex-utilities").get("message.error.show"))return Nn.window.showErrorMessage(e,...r)}showLog(){this.logPanel.show()}logError(e){this.addLogMessage(e.message),e.stack&&this.addLogMessage(e.stack)}};var C=q(require("vscode"));var Sl=q(require("vscode")),bl=require("child_process");function Il(t,e){let r="([^\\\\]|^)"+e+".*$",n=RegExp(r,"gm");return t.replace(n,"$1")}function Gi(t){return t==="tex"||t==="latex"||t==="doctex"}function Rl(t){try{(0,bl.execSync)(`${t} --version`)}catch(e){e.status===127&&Sl.window.showErrorMessage(`Command ${t} not found`)}}var DE=!1,Pt;DE?Pt=function(t,e,r,n){console.log(`\u26AA TypeFinder took ${+new Date-t}ms and ${e} lines to determine: ${r==="text"?"\u{1D601}\u{1D5F2}\u{1D605}\u{1D601}":"\u{1D5FA}\u{1D5EE}\u{1D601}\u{1D5F5}\u{1D600}"} ${n}`)}:Pt=(t,e,r,n)=>{};var Vi=class{constructor(){this.envs={"\\(":{mode:"maths",type:"start",pair:"\\)"},"\\[":{mode:"maths",type:"start",pair:"\\]"},"\\begin{equation}":{mode:"maths",type:"start",pair:"\\end{equation}"},"\\begin{displaymath}":{mode:"maths",type:"start",pair:"\\end{displaymath}"},"\\begin{align}":{mode:"maths",type:"start",pair:"\\end{align}"},"\\begin{gather}":{mode:"maths",type:"start",pair:"\\end{gather}"},"\\begin{flalign}":{mode:"maths",type:"start",pair:"\\end{flalign}"},"\\begin{multline}":{mode:"maths",type:"start",pair:"\\end{multline}"},"\\begin{alignat}":{mode:"maths",type:"start",pair:"\\end{alignat}"},"\\begin{split}":{mode:"maths",type:"start",pair:"\\end{split}"},"\\text":{mode:"text",type:"start",pair:null},"\\begin{document}":{mode:"text",type:"start",pair:null},"\\chapter":{mode:"text",type:"start",pair:null},"\\section":{mode:"text",type:"start",pair:null},"\\subsection":{mode:"text",type:"start",pair:null},"\\subsubsection":{mode:"text",type:"start",pair:null},"\\paragraph":{mode:"text",type:"start",pair:null},"\\subparagraph":{mode:"text",type:"start",pair:null}};this.allEnvRegex=this.constructEnvRegexs()}constructEnvRegexs(){function e(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}let r=[],n=[],i=[],s=/\\begin{(\w+)}/;for(let o of Object.keys(this.envs)){let a=this.envs[o];if(a.type==="end")continue;let c=o.match(s);c?(n.push(c[1]),this.envs[`\\begin{${c[1]}*}`]={mode:a.mode,type:"start",pair:`\\end{${c[1]}*}`},a.pair!==null&&(i.push(c[1]),this.envs[`\\end{${c[1]}*}`]={mode:a.mode,type:"end",pair:`\\begin{${c[1]}*}`})):(r.push(e(o)),a.pair!==null&&r.push(e(a.pair))),a.pair!==null&&(this.envs[a.pair]={mode:a.mode,type:"end",pair:o})}return r.push(`\\\\begin{(?:${n.join("|")})\\*?}`),r.push(`\\\\end{(?:${i.join("|")})\\*?}`),new RegExp(`(?:^|[^\\\\])(${r.join("|")})`,"g")}getTypeAtPosition(e,r,n){let i=+new Date,s=r.line,o=[],a=0,c=-1;n!==void 0&&n.position.isBefore(r)&&(a=n.position.line,c=n.position.character);do{let l=e.lineAt(s--).text;if(s+1===r.line&&(l=l.substr(0,r.character+1)),l=Il(l,"%"),s+1===r.line&&r.character>l.length)return Pt(i,r.line-s,"text","since it's a comment"),"text";let u=[],f;do f=this.allEnvRegex.exec(l),f!==null&&u.push(f);while(f);if(u.length===0)if(s+1===a&&0<=c&&n){if(o.length>0){let h=this.envs[o[o.length-1]];if(h.type==="end"&&h.mode===n.mode){a=0;continue}}return Pt(i,r.line-s,n.mode,"using lastknown (1)"),n.mode}else continue;else u=u.reverse();let d=0;for(let h=0;h<u.length;h++){let m=u[h],v=this.envs[m[1]];for(let g=l.length-1;g>=0;g--){if(m[1]==="\\text"&&m.index===g&&d>0)return Pt(i,r.line-s,v.mode,"from \\text"),v.mode;l[g]==="}"?d--:l[g]==="{"&&d++}if(v.type==="end"){if(v.pair===null)return Pt(i,r.line-s,v.mode,"from env with no pair"),v.mode;o.push(m[1])}else{if((o.length===0||o[o.length-1]!==v.pair)&&m[1]!=="\\text")return Pt(i,r.line-s,v.mode,"from unpaired env token"),v.mode;if(o.length>0&&m[1]!=="\\text"&&(o.pop(),n&&v.mode===n.mode))continue}if(s+1===a&&m.index<c&&n){if(o.length>0){let g=this.envs[o[o.length-1]];if(g.type==="end"&&g.mode===n.mode){a=0;continue}}return Pt(i,r.line-s,n.mode,"using lastknown (2)"),n.mode}}}while(s>=a);return Pt(i,r.line-s,"text","by default"),"text"}};var Bd=require("child_process"),Vr=q(require("path")),Ge=require("fs"),Gd=q(fa()),BC=!1,Xn;BC?Xn=function(t,e,r){console.log(`${t} Watcher took ${+new Date-e}ms ${r}`)}:Xn=(t,e,r)=>{};var is=class{constructor(e){this.currentlyExecutingChange=!1;this.MAX_CONFIG_AGE=5e3;this.snippets=[];this.activeSnippets=[];this.extension=e,this.typeFinder=new Vi,this.enabled=C.workspace.getConfiguration("latex-utilities").get("liveReformat.enabled"),this.configAge=+new Date,C.workspace.onDidChangeTextDocument(this.watcher,this),this.snippetFile={user:this.getUserSnippetsFile(),extension:Vr.join(this.extension.extensionRoot,"resources","liveSnippets.json")},this.loadSnippets(),e.logger.addLogMessage("Completion Watcher Initialised")}processSnippets(){for(let e=0;e<this.snippets.length;e++){let r=this.snippets[e];!/\$\$(?:\d|{\d)/.test(r.body)&&r.noPlaceholders===void 0&&(r.noPlaceholders=!0,r.priority===void 0&&(r.priority=-.1)),r.priority===void 0&&(r.priority=0),r.triggerWhenComplete===void 0&&(r.triggerWhenComplete=!1),r.mode===void 0?r.mode="any":/^maths|text|any$/.test(r.mode)||this.extension.logger.addLogMessage(`Invalid mode (${r.mode}) for live snippet "${r.description}"`)}this.snippets.sort((e,r)=>(r.priority===void 0?0:r.priority)-(e.priority===void 0?0:e.priority))}async watcher(e){if(+new Date-this.configAge>this.MAX_CONFIG_AGE&&(this.enabled=C.workspace.getConfiguration("latex-utilities").get("liveReformat.enabled"),this.configAge=+new Date),e.document.languageId!=="latex"||e.contentChanges.length===0||this.currentlyExecutingChange||this.sameChanges(e)||!this.enabled||!C.window.activeTextEditor)return;this.lastChanges=e,this.activeSnippets=[];let r=+new Date,n=0;for(let i of e.contentChanges){let s=this.typeFinder.getTypeAtPosition(e.document,i.range.start,this.lastKnownType);if(this.lastKnownType={position:i.range.start,mode:s},i.range.isSingleLine){let o=e.document.lineAt(i.range.start.line);for(let a=0;a<this.snippets.length;a++)if(this.snippets[a].mode==="any"||this.snippets[a].mode===s){let c=await this.execSnippet(this.snippets[a],o,i,n);if(c==="break")break;c!==void 0&&(n+=c,o=e.document.lineAt(i.range.start.line))}}}this.extension.telemetryReporter.sendTelemetryEvent("liveSnippetTimings",{timeToCheck:(r-+new Date).toString()}),Xn("\u{1F535}",r,"to check for snippets")}sameChanges(e){if(this.lastChanges){if(this.lastChanges.contentChanges.length!==e.contentChanges.length)return!1;if(!this.lastChanges.contentChanges.every((n,i)=>{let s=e.contentChanges[i];return!(n.text!==s.text||!n.range.isEqual(s.range))}))return!1}else return!1;return!0}async execSnippet(e,r,n,i){return new Promise((s,o)=>{let a=e.prefix.exec(r.text.substr(0,n.range.start.character+n.text.length+i));if(a&&C.window.activeTextEditor){this.snippetFile.current===this.snippetFile.user?this.extension.telemetryReporter.sendTelemetryEvent("livesnippet",{description:"CUSTOM_SNIPPET"}):e.description&&this.extension.telemetryReporter.sendTelemetryEvent("livesnippet",{description:e.description});let c,l;if(e.body==="SPECIAL_ACTION_BREAK"){s("break");return}else e.body==="SPECIAL_ACTION_FRACTION"?[c,l]=this.getFraction(a,r):(c=new C.Range(new C.Position(r.lineNumber,a.index),new C.Position(r.lineNumber,a.index+a[0].length)),e.body==="SPECIAL_ACTION_SYMPY"?l=this.execSympy(a,r):l=a[0].replace(e.prefix,e.body).replace(/\$\$/g,"$"));if(e.triggerWhenComplete){this.currentlyExecutingChange=!0;let u=+new Date;e.noPlaceholders?C.window.activeTextEditor.edit(f=>{f.replace(c,l)},{undoStopBefore:!0,undoStopAfter:!0}).then(()=>{let f=l.length-a[0].length;C.window.activeTextEditor&&f>0&&(C.window.activeTextEditor.selection=new C.Selection(C.window.activeTextEditor.selection.anchor.translate(0,f),C.window.activeTextEditor.selection.anchor.translate(0,f))),this.currentlyExecutingChange=!1,Xn(" \u25B9",u,"to perform text replacement"),s(f)}):C.window.activeTextEditor.edit(f=>{f.delete(c)},{undoStopBefore:!0,undoStopAfter:!1}).then(()=>{!C.window.activeTextEditor||C.window.activeTextEditor.insertSnippet(new C.SnippetString(l),void 0,{undoStopBefore:!0,undoStopAfter:!0}).then(()=>{this.currentlyExecutingChange=!1,Xn(" \u25B9",u,"to insert snippet"),s(l.length-a[0].length)},f=>{this.currentlyExecutingChange=!1,o(f)})},f=>{this.currentlyExecutingChange=!1,o(f)})}else this.activeSnippets.push({label:l,filterText:a[0],sortText:a[0],range:c,detail:"live snippet",kind:C.CompletionItemKind.Reference})}else s(void 0)})}provide(){return this.activeSnippets}editSnippetsFile(){(0,Ge.existsSync)(this.snippetFile.user)||(0,Ge.writeFileSync)(this.snippetFile.user,(0,Ge.readFileSync)(this.snippetFile.extension),"utf8"),C.workspace.openTextDocument(C.Uri.file(this.snippetFile.user)).then(e=>C.window.showTextDocument(e))}resetSnippetsFile(){if((0,Ge.existsSync)(this.snippetFile.user)){let e=this.snippetFile.user.replace(/\.json$/,".old.json");(0,Ge.existsSync)(e)&&(0,Gd.removeSync)(e),(0,Ge.renameSync)(this.snippetFile.user,e)}this.snippetFile.current=this.snippetFile.extension,this.extension.telemetryReporter.sendTelemetryEvent("livesnippet_reset")}compareSnippetsFile(){return this.extension.telemetryReporter.sendTelemetryEvent("livesnippet_compare"),C.commands.executeCommand("vscode.diff",C.Uri.file(this.snippetFile.extension),C.Uri.file(this.snippetFile.user),"LiveSnippets: Default \u{1F81A} User")}determineIfUserSnippetsRedundant(){let e=(0,Ge.readFileSync)(this.snippetFile.user).toString(),r=(0,Ge.readFileSync)(this.snippetFile.extension).toString();e===r&&C.window.showWarningMessage("You don't seem to have changed the default snippets, but having a user config prevents you from receiving updates to the default","Keep using the extension snippet file","Switch to user snippet file").then(n=>{n==="Keep using the extension snippet file"&&C.commands.executeCommand("latex-utilities.resetLiveSnippetsFile")})}loadSnippets(e=!1){let r;if((0,Ge.existsSync)(this.snippetFile.user)?r=this.snippetFile.user:r=this.snippetFile.extension,!(r===this.snippetFile.current&&!e)){{this.snippetFile.current=r;try{let n=JSON.parse((0,Ge.readFileSync)(this.snippetFile.current,{encoding:"utf8"}));for(let i=0;i<n.length;i++)n[i].prefix=new RegExp(n[i].prefix);this.snippets=n,this.processSnippets()}catch(n){this.extension.logger.logError(n),this.extension.logger.showErrorMessage("Couldn't load snippets file. Is it a valid JSON?")}}this.extension.logger.addLogMessage("Live Snippets Loaded")}}getUserSnippetsFile(){let e=C.version.indexOf("insider")>=0?"Code - Insiders":"Code",r="latexUtilsLiveSnippets.json";if(process.platform==="win32"&&process.env.APPDATA)return Vr.join(process.env.APPDATA,e,"User",r);if(process.platform==="darwin"&&process.env.HOME)return Vr.join(process.env.HOME,"Library","Application Support",e,"User",r);if(process.platform==="linux"&&process.env.HOME){let n=Vr.join(process.env.HOME,".config",e,"User",r);return(0,Ge.existsSync)(n)||(n=Vr.join(process.env.HOME,".config","Code - OSS","User",r)),n}else return""}getFraction(e,r){let n=e[1],i={")":"(","]":"[","}":"{"}[n],s=0;for(let o=e.index;o>=0;o--)if(r.text[o]===n?s--:r.text[o]===i&&s++,s===0){let a=/.*(\\\w+)$/.exec(r.text.substr(0,o));n==="}"&&a!==null&&(o-=a[1].length);let c=new C.Range(new C.Position(r.lineNumber,o),new C.Position(r.lineNumber,e.index+e[0].length)),l=`\\frac{${a?"\\":""}${r.text.substring(o+1,e.index)}}{$1} `;return[c,l]}return[new C.Range(new C.Position(r.lineNumber,e.index+e[0].length),new C.Position(r.lineNumber,e.index+e[0].length)),""]}execSympy(e,r){let n="SYMPY_CALCULATING",i=e[1].replace(/\\(\w+) ?/g,"$1").replace(/\^/,"**").replace("{","(").replace("}",")");return(0,Bd.exec)(`python3 -c "from sympy import *
import re
a, b, c, x, y, z, t = symbols('a b c x y z t')
k, m, n = symbols('k m n', integer=True)
f, g, h = symbols('f g h', cls=Function)
init_printing()
print(eval('''latex(${i})'''), end='')"`,{encoding:"utf8"},(s,o,a)=>{if(C.window.activeTextEditor)a&&(o="SYMPY_ERROR",setTimeout(()=>{this.extension.logger.addLogMessage(`error executing sympy command: ${i}`),C.window.activeTextEditor&&C.window.activeTextEditor.edit(c=>{c.delete(new C.Range(new C.Position(r.lineNumber,e.index),new C.Position(r.lineNumber,e.index+o.length)))})},400));else return;C.window.activeTextEditor.edit(c=>{c.replace(new C.Range(new C.Position(r.lineNumber,e.index),new C.Position(r.lineNumber,e.index+n.length)),o)})}),n}},ss=class{constructor(e){this.extension=e}provideCompletionItems(e,r,n,i){return this.extension.completionWatcher.activeSnippets}};var A=q(require("vscode")),V=q(require("path")),ft=q(require("fs")),Xd=q(fa()),mr=require("child_process"),Qd=q(zd()),Yd=require("stream"),ma=require("util"),VC=(0,ma.promisify)(ft.copyFile),WC=(0,ma.promisify)(ft.readFile),os=class{constructor(e){this.PATH_VARIABLE_GRAPHICS_PATH=/\$\{graphicsPath\}/g;this.PATH_VARIABLE_CURRNET_FILE_DIR=/\$\{currentFileDir\}/g;this.PATH_VARIABLE_IMAGE_FILE_PATH=/\$\{imageFilePath\}/g;this.PATH_VARIABLE_IMAGE_FILE_PATH_WITHOUT_EXT=/\$\{imageFilePathWithoutExt\}/g;this.PATH_VARIABLE_IMAGE_FILE_NAME=/\$\{imageFileName\}/g;this.PATH_VARIABLE_IMAGE_FILE_NAME_WITHOUT_EXT=/\$\{imageFileNameWithoutExt\}/g;this.pasteTemplate="";this.basePathConfig="${graphicsPath}";this.graphicsPathFallback="${currentFileDir}";this.extension=e}async paste(){this.extension.logger.addLogMessage("Performing formatted paste");let e=A.window.activeTextEditor;if(!e)return;let r=e.document.uri;if(!r)return;let n=await A.env.clipboard.readText();if(n===""){if(r.scheme==="untitled"){A.window.showInformationMessage("You need to the save the current editor before pasting an image");return}this.pasteImage(e,r.fsPath)}if(n.split(`
`).length===1){let i,s;if(r.scheme==="untitled"?(i=n,s=""):(i=V.resolve(r.fsPath,n),s=r.fsPath),ft.existsSync(i)){await this.pasteFile(e,s,n);return}}try{await this.pasteTable(e,n)}catch(i){this.pasteNormal(e,this.reformatText(n,!0,A.workspace.getConfiguration("latex-utilities.formattedPaste").get("maxLineLength"),e)),this.extension.telemetryReporter.sendTelemetryEvent("formattedPaste",{type:"text"})}}pasteNormal(e,r){e.edit(n=>{let i=e.selection;i.isEmpty?n.insert(i.start,r):n.replace(i,r)})}async pasteFile(e,r,n){let i=[".png",".jpg",".jpeg",".eps",".pdf"],s=[".csv"],o=V.extname(n);if(i.indexOf(o)!==-1)this.pasteImage(e,r,n);else if(s.indexOf(o)!==-1&&o===".csv"){let a=await WC(V.resolve(r,n));await this.pasteTable(e,a.toString())}}async pasteTable(e,r,n){this.extension.logger.addLogMessage("Pasting: Table");let i=A.workspace.getConfiguration("latex-utilities.formattedPaste"),s=n||i.customTableDelimiter,o=i.tableColumnType,a=i.tableBooktabsStyle,c=i.tableHeaderRows;r=(g=>g.replace(/\r\n/g,`
`).replace(/^[^\S\t]+|[^\S\t]+$/gm,"").replace(/^[\uFEFF\xA0]+|[\uFEFF\xA0]+$/gm,""))(r);let u=new Set([s,"	",",","|"]),f=[];for(let g of u)try{let y=await this.processTable(r,g);f.push(y),this.extension.logger.addLogMessage(`Successfully found ${g} delimited table`)}catch(y){this.extension.logger.addLogMessage(`Failed to find ${g} delimited table`),this.extension.logger.addLogMessage(y)}if(f.length===0)if(this.extension.logger.addLogMessage("No table found"),i.tableDelimiterPrompt){let g=await A.window.showInputBox({prompt:"Please specify the table cell delimiter",value:s,placeHolder:s,validateInput:y=>y===""?"No delimiter specified!":null});if(g===void 0)throw new Error("no table cell delimiter set");try{let y=await this.processTable(r,g);f.push(y),this.extension.logger.addLogMessage(`Successfully found ${g} delimited table`)}catch(y){throw A.window.showWarningMessage(y),Error("Unable to identify table")}}else throw Error("Unable to identify table");f.sort((g,y)=>g.length*g[0].length-y.length*y[0].length);let d=f[0].map(g=>g.map(y=>this.reformatText(y.replace(/^\s+|\s+$/gm,""),!1))),h=d.map(g=>"	"+g.join(" & "));if(c&&h.length>c){let g=e.document.eol===A.EndOfLine.LF?`
`:`\r
`,y="	"+(a?"\\midrule":"\\hline")+g;h[c]=y+h[c]}let m=h.join(` \\\\
`);a&&(m=`	\\toprule
`+m+` \\\\
	\\bottomrule`);let v=`\\begin{tabular}{${o.repeat(d[0].length)}}
${m}
\\end{tabular}`;e.edit(g=>{let y=e.selection;y.isEmpty?g.insert(y.start,v):g.replace(y,v)}),this.extension.telemetryReporter.sendTelemetryEvent("formattedPaste",{type:"table"})}processTable(e,r=","){let n=s=>s.reduce((o,a,c,l)=>a.length===l[0].length?o:!1,!0),i=s=>{let o=s[0].reduce((u,f)=>f+u,"")==="",a=s[s.length-1].reduce((u,f)=>f+u,"")==="",c=s.reduce((u,f)=>u+f[0],"")==="",l=s.reduce((u,f)=>u+f[f.length-1],"")==="";return o||a||c||l?(o&&s.shift(),a&&s.pop(),c&&s.forEach(u=>u.shift()),l&&s.forEach(u=>u.pop()),i(s)):s};return new Promise((s,o)=>{let a=[],c=new Yd.Readable;if(r==="|"){let l=/^\s*[-+:| ]+\s*$/;e=e.split(`
`).filter(f=>!l.test(f)).join(`
`)}c.push(e),c.push(null),c.pipe((0,Qd.default)({headers:!1,separator:r})).on("data",l=>a.push(Object.values(l))).on("end",()=>{a=i(a),n(a)?(a.length===1||a[0].length===1)&&o("Doesn't look like a table"):o("Table is not consistent"),s(a)})})}reformatText(e,r=!0,n=null,i){function s(l){return l=l.replace(/\u200B/g,""),l=l.replace(/\n{2,}/g,"\uE000"),l=l.replace(/\s+/g," "),l=l.replace(/\uE000/g,`

`),l=l.replace(/\uE001/g,`
`),l=l.replace(/\uE002/g,"	"),l=l.replace(/^\s+|\s+$/g,""),l}function o(l,u,f=[" ",",",".",":",";","?","!"]){let d=[],h=i?i.document.lineAt(i.selection.start.line).text.replace(/^(\s*).*/,"$1"):"",m=i?-i.selection.start.character:0,v=0,g;for(g=0;g<u.length;g++)u[g]===`
`&&(d.push((d.length>0?h:"")+u.slice(Math.max(0,m),g).replace(/^[^\S\t]+/,"").replace(/\s+$/,"")),m=g),f.indexOf(u[g])!==-1&&(v=g+1),g-m>=l-h.length&&(d.push((d.length>0?h:"")+u.slice(Math.max(0,m),v).replace(/^[^\S\t]+/,"").replace(/\s+$/,"")),m=v,g=v);return m<g&&d.push((d.length>0?h:"")+u.slice(Math.max(0,m),g).replace(/^\s+/,"").replace(/\s+$/,"")),console.log(d.map(y=>l-y.length)),d.join(`
`)}e=e.replace(/(\w+)-\s?$\s?\n(\w+)/gm,`$1$2
`);let a={"\\\\":"\\textbackslash ","&":"\\&","%":"\\%","\\$":"\\$","#":"\\#",_:"\\_","\\^":"\\textasciicircum ","{":"\\{","}":"\\}","~":"\\textasciitilde ",'\\B"([^"]+)"\\B':"``$1''","\\B'([^']+)'\\B":"`$1'","\u201C":"``","\u201D":"''","\u2018":"`","\u2019":"'","\u2014":"---","\u2013":"--"," -- ":" --- ","\u2212":"-","\u2026":"\\ldots ","\u2010":"-","\u2122":"\\texttrademark ","\xAE":"\\textregistered ","\xA9":"\\textcopyright ","\xA2":"\\cent ","\xA3":"\\pound ","\xD7":"\\(\\times \\)","\xF7":"\\(\\div \\)","\xB1":"\\(\\pm \\)","\u2192":"\\(\\to \\)","(\\d*)\xB0 ?(C|F)?":"\\($1^\\circ $2\\)","\u2264":"\\(\\leq \\)","\u2265":"\\(\\geq \\)","\\.\\.\\.":"\\ldots ","-{20,}":"\\hline","-{2,3}>":"\\(\\longrightarrow \\)","->":"\\(\\to \\)","<-{2,3}":"\\(\\longleftarrow \\)","<-":"\\(\\leftarrow \\)","\\b([A-Z]+)\\.\\s([A-Z])":"$1\\@. $2","\\b(etc|ie|i\\.e|eg|e\\.g)\\.\\s(\\w)":"$1.\\ $2","\\s?\u2022\\s?":"\uE001\uE002\\item ","\\n?((?:\\s*\uE002\\\\item .*)+)":"\uE001\\begin{itemize}\uE001$1\uE001\\end{itemize}\uE001","\uF0AC":"<","\uF0BE":"-","\uF0AE":">"};if(!/\\[A-Za-z]{3,15}/.test(e))for(let l in a)e=e.replace(new RegExp(l,"gm"),a[l]);return r&&(e=s(e)),n!==null&&(e=o(n,e)),e}pasteImage(e,r,n){this.extension.logger.addLogMessage("Pasting: Image");let i=V.dirname(r),s=A.workspace.workspaceFolders?A.workspace.workspaceFolders[0].uri.fsPath:i,o=e.selection,a=e.document.getText(o);if(a&&/\//.test(a)){A.window.showInformationMessage("Your selection is not a valid file name!");return}if(this.loadImageConfig(s,r),n&&!a){let c=this.renderImagePaste(V.dirname(r),n);if(!A.window.activeTextEditor)return;A.window.activeTextEditor.insertSnippet(new A.SnippetString(c),e.selection.start,{undoStopBefore:!0,undoStopAfter:!0});return}this.getImagePath(r,n,a,this.basePathConfig,(c,l)=>{try{ft.existsSync(l)?A.window.showInformationMessage(`File ${l} exists. Would you want to replace?`,"Replace","Cancel").then(f=>{f==="Replace"&&this.saveAndPaste(e,l,n)}):this.saveAndPaste(e,l,n)}catch(u){A.window.showErrorMessage(`fs.existsSync(${l}) fail. message=${u.message}`);return}})}loadImageConfig(e,r){let i=A.workspace.getConfiguration("latex-utilities.formattedPaste.image").get("template");if(i===void 0)throw new Error("No config value found for latex-utilities.imagePaste.template");typeof i=="string"?this.pasteTemplate=i:this.pasteTemplate=i.join(`
`),this.graphicsPathFallback=this.replacePathVariables("${currentFileDir}",e,r),this.basePathConfig=this.replacePathVariables("${graphicsPath}",e,r),this.pasteTemplate=this.replacePathVariables(this.pasteTemplate,e,r)}getImagePath(e,r="",n,i,s){let o=this.basePathConfig,a=Math.max(0,...ft.readdirSync(o).map(f=>parseInt(f.replace(/^image(\d+)\.\w+/,"$1"))).filter(f=>!isNaN(f)))+1,c=V.extname(r)?V.extname(r):".png",l=n?n+c:`image${a}`+c;A.window.showInputBox({prompt:"Please specify the filename of the image.",value:l,valueSelection:[l.length-l.length,l.length-4]}).then(f=>{f&&(f.endsWith(c)||(f+=c),f=u(f),s(null,f))});function u(f){let d=V.dirname(e),h="";return V.isAbsolute(i)?h=V.join(i,f):h=V.join(d,i,f),h}}async saveAndPaste(e,r,n){this.ensureImgDirExists(r).then(i=>{if(n){VC(n,i);let s=this.renderImagePaste(this.basePathConfig,i),o=e.selection;if(o.isEmpty||e.edit(a=>{a.delete(o)},{undoStopBefore:!0,undoStopAfter:!1}),!A.window.activeTextEditor)return;A.window.activeTextEditor.insertSnippet(new A.SnippetString(s),e.selection.start,{undoStopBefore:!0,undoStopAfter:!0})}else this.saveClipboardImageToFileAndGetPath(i,(s,o)=>{if(!o)return;if(o==="no image"){A.window.showInformationMessage("No image in clipboard");return}let a=this.renderImagePaste(this.basePathConfig,i),c=e.selection;c.isEmpty||e.edit(l=>{l.delete(c)},{undoStopBefore:!0,undoStopAfter:!1}),A.window.activeTextEditor&&A.window.activeTextEditor.insertSnippet(new A.SnippetString(a),e.selection.start,{undoStopBefore:!0,undoStopAfter:!0})});this.extension.telemetryReporter.sendTelemetryEvent("formattedPaste",{type:"image"})}).catch(i=>{A.window.showErrorMessage(`Failed make folder. message=${i.message}`)})}ensureImgDirExists(e){return new Promise((r,n)=>{let i=V.dirname(e);ft.stat(i,(s,o)=>{s===null?o.isDirectory()?r(e):n(new Error(`The image destination directory '${i}' is a file.`)):s.code==="ENOENT"?Xd.ensureDir(i,void 0,a=>{if(a){n(a);return}r(e)}):n(s)})})}saveClipboardImageToFileAndGetPath(e,r){if(!e)return;let n=process.platform;if(A.env.remoteName==="wsl"){let i=V.join(this.extension.extensionRoot,"./scripts/saveclipimg-pc.ps1");(0,mr.spawn)("wslpath",["-w",i]).stdout.on("data",o=>{i=o.toString().trim(),i=i.replace("\\wsl.localhost","\\wsl$"),this.extension.logger.addLogMessage(`saveClipimg-pc.ps1: ${i}`),(0,mr.spawn)("wslpath",["-w",e]).stdout.on("data",c=>{e=c.toString().trim(),this.extension.logger.addLogMessage(`imagePath: ${e}`);let u=(0,mr.spawn)("powershell.exe",["-noprofile","-noninteractive","-nologo","-sta","-executionpolicy","unrestricted","-windowstyle","hidden","-file",i,e]);u.on("error",f=>{f.name==="ENOENT"?A.window.showErrorMessage("The powershell command is not in you PATH environment variables.Please add it and retry."):(console.log(f),A.window.showErrorMessage(f.message))}),u.on("exit",(f,d)=>{}),u.stdout.on("data",f=>{r(e,f.toString().trim())})})})}else if(n==="win32"){let i=V.join(this.extension.extensionRoot,"./scripts/saveclipimg-pc.ps1"),s="C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe";ft.existsSync(s)||(s="powershell");let a=(0,mr.spawn)(s,["-noprofile","-noninteractive","-nologo","-sta","-executionpolicy","unrestricted","-windowstyle","hidden","-file",i,e]);a.on("error",c=>{c.name==="ENOENT"?A.window.showErrorMessage("The powershell command is not in you PATH environment variables.Please add it and retry."):(console.log(c),A.window.showErrorMessage(c.message))}),a.on("exit",(c,l)=>{}),a.stdout.on("data",c=>{r(e,c.toString().trim())})}else if(n==="darwin"){let i=V.join(this.extension.extensionRoot,"./scripts/saveclipimg-mac.applescript"),s=(0,mr.spawn)("osascript",[i,e]);s.on("error",o=>{console.log(o),A.window.showErrorMessage(o.message)}),s.on("exit",(o,a)=>{}),s.stdout.on("data",o=>{r(e,o.toString().trim())})}else{let i=V.join(this.extension.extensionRoot,"./scripts/saveclipimg-linux.sh"),s=(0,mr.spawn)("sh",[i,e]);s.on("error",o=>{console.log(o),A.window.showErrorMessage(o.message)}),s.on("exit",(o,a)=>{}),s.stdout.on("data",o=>{let a=o.toString().trim();if(a==="no xclip"){A.window.showErrorMessage("You need to install xclip command first.");return}r(e,a)})}}renderImagePaste(e,r){e&&(r=V.relative(e,r),process.platform==="win32"&&(r=r.replace(/\\/g,"/")));let n=V.extname(r),i=r.replace(/\.\w+$/,""),s=V.basename(r),o=V.basename(r,n),a=this.pasteTemplate;return a=a.replace(this.PATH_VARIABLE_IMAGE_FILE_PATH,r),a=a.replace(this.PATH_VARIABLE_IMAGE_FILE_PATH_WITHOUT_EXT,i),a=a.replace(this.PATH_VARIABLE_IMAGE_FILE_NAME,s),a=a.replace(this.PATH_VARIABLE_IMAGE_FILE_NAME_WITHOUT_EXT,o),a}replacePathVariables(e,r,n,i=s=>s){var l;let s=V.dirname(n),o=(l=A.window.activeTextEditor)==null?void 0:l.document.getText();if(!o)return e;let a=this.extension.manager.getGraphicsPath(o);a=a.length!==0?a[0]:this.graphicsPathFallback,a=V.resolve(s,a);let c=A.workspace.getConfiguration("latex-utilities.formattedPaste").get("imagePathOverride");return c.length!==0&&(a=c),e=e.replace(this.PATH_VARIABLE_GRAPHICS_PATH,i(a)),e=e.replace(this.PATH_VARIABLE_CURRNET_FILE_DIR,i(s)),e}};var Ae=q(require("vscode")),Kd=q(require("fs")),qt=q(require("path")),Jd=q(require("child_process")),Zd=q(require("util"));var as=class{constructor(e){this.extension=e,this.status=Ae.window.createStatusBarItem(Ae.StatusBarAlignment.Left,-10002),this.status.command="latex-utilities.selectWordcountFormat",this.setStatus()}async counts(e=!0,r=(n=>(n=Ae.window.activeTextEditor)==null?void 0:n.document.fileName)()){if(r===void 0){this.extension.logger.addLogMessage("A valid file was not give for TexCount");return}let i=Ae.workspace.getConfiguration("latex-utilities.countWord"),s=i.get("args").slice(),o=Zd.promisify(Jd.execFile);e&&s.push("-merge"),s.push("-brief");let a=i.get("path");i.get("docker.enabled")&&(process.platform==="win32"?a=qt.resolve(this.extension.extensionRoot,"./scripts/countword-win.bat"):(a=qt.resolve(this.extension.extensionRoot,"./scripts/countword-linux.sh"),Kd.chmodSync(a,493))),this.extension.logger.addLogMessage(`TexCount args: ${s}`);let c,l;try{({stdout:c,stderr:l}=await o(a,s.concat([qt.basename(r)]),{cwd:qt.dirname(r)}))}catch(d){this.extension.logger.addLogMessage(`Cannot count words: ${d.message}, ${l}`),this.extension.logger.showErrorMessage("TeXCount failed. Please refer to LaTeX Utilities Output for details.");return}let u=c.replace(/\(errors:\d+\)/,"").split(`
`).map(d=>d.trim()).filter(d=>d!=="").slice(-1)[0];this.extension.logger.addLogMessage(`TeXCount output for word: ${c}`),s.push("-char"),this.extension.logger.addLogMessage(`TexCount args: ${s}`);try{({stdout:c,stderr:l}=await o(a,s.concat([qt.basename(r)]),{cwd:qt.dirname(r)}))}catch(d){this.extension.logger.addLogMessage(`Cannot count words: ${d.message}, ${l}`),this.extension.logger.showErrorMessage("TeXCount failed. Please refer to LaTeX Utilities Output for details.");return}let f=c.replace(/\(errors:\d+\)/,"").split(`
`).map(d=>d.trim()).filter(d=>d!=="").slice(-1)[0];return this.extension.logger.addLogMessage(`TeXCount output for char: ${c}`),this.parseTexCount(u,f)}parseTexCount(e,r){let n=/^(?<wordsBody>\d+)\+(?<wordsHeaders>\d+)\+(?<wordsCaptions>\d+) \((?<instancesHeaders>\d+)\/(?<instancesFloats>\d+)\/(?<mathInline>\d+)\/(?<mathDisplayed>\d+)\)/.exec(e),i=/^(?<charsBody>\d+)\+(?<charsHeaders>\d+)\+(?<charsCaptions>\d+) \((?<instancesHeaders>\d+)\/(?<instancesFloats>\d+)\/(?<mathInline>\d+)\/(?<mathDisplayed>\d+)\)/.exec(r);if(n!==null&&i!==null){let{groups:{wordsBody:s,wordsHeaders:o,wordsCaptions:a,instancesHeaders:c,instancesFloats:l,mathInline:u,mathDisplayed:f}}=n,{groups:{charsBody:d,charsHeaders:h,charsCaptions:m}}=i;return{words:{body:parseInt(s),headers:parseInt(o),captions:parseInt(a)},chars:{body:parseInt(d),headers:parseInt(h),captions:parseInt(m)},instances:{headers:parseInt(c),floats:parseInt(l),math:{inline:parseInt(u),displayed:parseInt(f)}}}}else throw new Error("String was not valid TexCount output")}async setStatus(){if(Ae.window.activeTextEditor===void 0||!Gi(Ae.window.activeTextEditor.document.languageId)){this.status.hide();return}else{let e=Ae.workspace.getConfiguration("latex-utilities.countWord").get("format");if(e===""){this.status.hide();return}let r=await this.counts(void 0,Ae.window.activeTextEditor.document.fileName);this.status.show(),this.status.text=this.formatString(r,e)}}async pickFormat(){let e=await this.counts(),r=["${words} Words","${wordsBody} Words","${chars} Chars","${charsBody} Chars","${headers} Headers","${floats} Floats","${math} Equations","custom"],n={};for(let o of r)n[o]=this.formatString(e,o),(o.startsWith("${wordsBody}")||o.startsWith("${charsBody}"))&&(n[o]+=" (body only)");let i=await Ae.window.showQuickPick(Object.values(n),{placeHolder:"Select format to use"}),s=i;if(i==="custom"){let o=Ae.workspace.getConfiguration("latex-utilities.countWord").get("format");s=await Ae.window.showInputBox({placeHolder:"Template",value:o,valueSelection:[0,o.length],prompt:"The Template. Feel free to use the following placeholders:                     ${wordsBody}, ${wordsHeaders}, ${wordsCaptions}, ${words},                     ${charsBody}, ${charsHeaders}, ${charsCaptions}, ${chars},                     ${headers}, ${floats}, ${mathInline}, ${mathDisplayed}, ${math}"})}else for(let o in n)if(n[o]===i){s=o;break}s!==void 0&&Ae.workspace.getConfiguration("latex-utilities.countWord").update("format",s,Ae.ConfigurationTarget.Global).then(()=>{setTimeout(()=>{this.status.text=this.formatString(e,s)},300)})}formatString(e,r){if(e===void 0)return"...";let n={"${wordsBody}":e.words.body,"${wordsHeaders}":e.words.headers,"${wordsCaptions}":e.words.captions,"${charsBody}":e.chars.body,"${charsHeaders}":e.chars.headers,"${charsCaptions}":e.chars.captions,"${words}":e.words.body+e.words.headers+e.words.captions,"${chars}":e.chars.body+e.chars.headers+e.chars.captions,"${headers}":e.instances.headers,"${floats}":e.instances.floats,"${mathInline}":e.instances.math.inline,"${mathDisplayed}":e.instances.math.displayed,"${math}":e.instances.math.inline+e.instances.math.displayed};for(let i in n)r=r.replace(i,n[i].toString());return r}};var dt=q(require("vscode"));var eh=require("child_process"),cs=class{constructor(e){this.extension=e}async provideDefinition(e,r,n){try{if(!dt.workspace.getConfiguration("latex-utilities.texdef").get("enabled"))return;let s=e.lineAt(r.line),o,a=/\\[\w@]+/g,c=a.exec(s.text);for(;c!==null;){let v=s.range.start.translate(0,c.index),g=v.translate(0,c[0].length),y=new dt.Range(v,g);if(y.contains(r)){o=y;break}c=a.exec(s.text)}if(o===void 0)return;Rl("texdef");let l=["--source","--Find","--tex","latex"],u=this.extension.manager.usedPackages(e);/\.sty$/.test(e.uri.fsPath)&&l.push(e.uri.fsPath.replace(/\.sty$/,"")),l.push(...[...u].map(v=>["-p",v]).reduce((v,g)=>v.concat(g),[]));let f=this.getDocumentClass(e);l.push("--class",f!==null?f:"article"),l.push(e.getText(o));let d=await this.getFirstLineOfOutput("texdef",l),h=/% (.+), line (\d+):/,m;if((m=d.match(h))!==null)return this.extension.telemetryReporter.sendTelemetryEvent("texdef"),new dt.Location(dt.Uri.file(m[1]),new dt.Position(parseInt(m[2])-1,0));dt.window.showWarningMessage(`Could not find definition for ${e.getText(o)}`),this.extension.logger.addLogMessage(`Could not find definition for ${e.getText(o)}`);return}catch(i){this.extension.logger.addLogMessage(i),this.extension.telemetryReporter.sendTelemetryException(i,{command:"MacroDefinitions.provideDefinition"}),this.extension.logger.addLogMessage("Error reported.")}}getDocumentClass(e){let r=/\\documentclass((?:\[[\w-,]*\])?{[\w-]+)}/,n,i=0;for(;i<50&&i<e.lineCount;)if((n=e.lineAt(i++).text.match(r))!==null)return n[1].replace(/{([\w-]+)$/,"$1");return null}async getFirstLineOfOutput(e,r){return new Promise(n=>{let i=+new Date;this.extension.logger.addLogMessage(`Running command ${e} ${r.join(" ")}`);try{let s=(0,eh.spawn)(e,r);s.stdout.on("data",o=>{this.extension.logger.addLogMessage(`Took ${+new Date-i}ms to find definition for ${r[r.length-1]}`),s.kill(),n(o.toString())}),s.stdout.on("error",()=>{this.extension.logger.addLogMessage(`Error running texdef for ${r[r.length-1]}}`),n("")}),s.stdout.on("end",()=>{n("")}),setTimeout(()=>{s.kill()},6e3)}catch(s){this.extension.logger.showErrorMessage(`Got ${s} while running texdef. Is texdef installed?`)}})}};var De=q(require("vscode")),Jn=q(Op()),bs=class{constructor(e){this.extension=e}async caywCite(){let e=De.workspace.getConfiguration("latex-utilities.zotero"),r=e.get("zoteroUrl"),n={format:"biblatex",command:e.get("latexCommand")};try{return(await Jn.default.get(`${r}/better-bibtex/cayw`,{params:n})).data}catch(i){return i.code==="ECONNREFUSED"?this.extension.logger.showErrorMessage("Could not connect to Zotero. Is it running with the Better BibTeX extension installed?"):(this.extension.logger.addLogMessage(`Cannot insert citation: ${i.message}`),this.extension.logger.showErrorMessage("Cite as you write failed. Please refer to LaTeX Utilities Output for details.")),null}}search(e){let n=De.workspace.getConfiguration("latex-utilities.zotero").get("zoteroUrl");this.extension.logger.addLogMessage(`Searching Zotero for "${e}"`);let s=Jn.default.CancelToken.source();return[(0,Jn.default)(`${n}/better-bibtex/json-rpc`,{method:"post",data:{jsonrpc:"2.0",method:"item.search",params:[e]},responseType:"json",cancelToken:s.token}).then(a=>{let c=a.data.result;return this.extension.logger.addLogMessage(`Got ${c.length} search results from Zotero for "${e}"`),c}).catch(a=>(this.extension.logger.showErrorMessage(`Searching Zotero failed: ${a.message}`),[])),()=>s.cancel("request canceled")]}async vscodeCite(){let e=[];try{let r=await new Promise((n,i)=>{let s=De.window.createQuickPick();s.matchOnDescription=!0,s.matchOnDetail=!0,s.canSelectMany=!0,s.placeholder="Type to insert citations";let o;e.push(s.onDidChangeValue(a=>{if(a){s.busy=!0,o&&(o(),o=void 0);let[c,l]=this.search(a);o=l,c.then(u=>{s.items=u.map(f=>new Is(f))}).catch(u=>{u.isCanceled||(u.code==="ECONNREFUSED"?this.extension.logger.showErrorMessage("Could not connect to Zotero. Is it running with the Better BibTeX extension installed?"):(this.extension.logger.addLogMessage(`Searching Zotero failed: ${u.message}`),s.items=[new Ha(u)]))}).finally(()=>{s.busy=!1})}else s.items=[]})),e.push(s.onDidAccept(()=>{let a=s.selectedItems.length>0?s.selectedItems:s.activeItems;s.hide(),n(a.filter(c=>c instanceof Is).map(c=>c.result))})),e.push(s.onDidHide(()=>{o&&o(),n([]),s.dispose()})),s.show()});if(r&&r.length>0){let i=De.workspace.getConfiguration("latex-utilities.zotero").get("latexCommand"),s=r.map(o=>o.citekey).join(",");return i.length>0?`\\${i}{${s}}`:`${s}`}else return null}finally{e.forEach(r=>r.dispose())}}async insertCitation(e){let r=De.window.activeTextEditor;r?(await r.edit(n=>{r.selection.isEmpty?n.insert(r.selection.active,e):(n.delete(r.selection),n.insert(r.selection.start,e))}),this.extension.logger.addLogMessage(`Added citation: ${e}`)):this.extension.logger.addLogMessage("Could not insert citation: no active text editor")}async cite(){let r=De.workspace.getConfiguration("latex-utilities.zotero").get("citeMethod");if(!await this.checkZotero())return;let n=null;r==="zotero"?n=await this.caywCite():r==="vscode"?n=await this.vscodeCite():this.extension.logger.showErrorMessage(`Unknown cite method: ${r}`),n&&this.insertCitation(n),this.extension.telemetryReporter.sendTelemetryEvent("zoteroCite")}extractCiteKey(e){if(e.selection.isEmpty){let r=e.document.getWordRangeAtPosition(e.selection.active);return e.document.getText(r)}else return e.document.getText(new De.Range(e.selection.start,e.selection.end))}async openCitation(){if(!await this.checkZotero())return;let e=De.window.activeTextEditor;if(!e)return;let r=this.extractCiteKey(e);this.extension.logger.addLogMessage(`Opening ${r} in Zotero`);let n=De.Uri.parse(`zotero://select/items/bbt:${r}`);await De.env.openExternal(n)}async checkZotero(){let r=De.workspace.getConfiguration("latex-utilities.zotero").get("zoteroUrl");try{return await Jn.default.get(`${r}/connector/ping`),!0}catch(n){if(n.code==="ECONNREFUSED")return De.window.showWarningMessage("Zotero doesn't appear to be running."),!1}return!1}},Is=class{constructor(e){this.result=e;if(this.label=e.title,this.detail=e.citekey,e.author){let r=e.author.map(n=>`${n.given} ${n.family}`);r.length<2?this.description=r.join(" "):r.length===2?this.description=r.slice(0,-1).join(", ")+" and "+r[r.length-1]:this.description=r.slice(0,-1).join(", ")+", and "+r[r.length-1]}else this.description=""}},Ha=class{constructor(e){this.message=e;this.label=e.replace(/\r?\n/g," ")}};var xE=q(e_());var se=q(require("vscode")),Fe=q(require("path")),ur=q(require("fs"));var bo=q(require("vscode")),ve=q(require("path")),So=q(require("fs"));function vR(t){let e=/(^|[^\\]|(?:(?<!\\)(?:\\\\)+))%.*$/gm;return t.replace(e,"$1")}function yR(t,e){let n=`\\\\begin{(${e.join("|")})}.*?\\\\end{\\1}`,i=RegExp(n,"gms");return t.replace(i,(s,...o)=>{let a=Math.max(s.split(`
`).length,1);return`
`.repeat(a-1)})}function Pi(t){let e=vR(t);e=e.replace(/\\verb\*?([^a-zA-Z0-9]).*?\1/g,"");let n=bo.workspace.getConfiguration("latex-workshop").get("latex.verbatimEnvs");return yR(e,n)}function Lr(t,e,r=".tex"){e.startsWith("/")&&t.unshift("");for(let n of t){let i=ve.resolve(n,e);if(ve.extname(i)===""&&(i+=r),!So.existsSync(i)&&So.existsSync(i+r)&&(i+=r),So.existsSync(i))return i}}function t_(t,e){return r=>{var x;let n=bo.workspace.getConfiguration("latex-workshop"),i=n.get("docker.enabled"),s=(x=bo.workspace.workspaceFolders)==null?void 0:x[0],o=(s==null?void 0:s.uri.fsPath.split(ve.sep).join("/"))||"",a=ve.parse(t),c=a.name,l=a.base,u=ve.normalize(a.dir),f=u.split(ve.sep).join("/"),d=ve.join(u,c),h=d.split(ve.sep).join("/"),m=ve.join(u,l),v=m.split(ve.sep).join("/"),g=T=>T.replace(/%DOC%/g,i?c:h).replace(/%DOC_W32%/g,i?c:d).replace(/%DOC_EXT%/g,i?l:v).replace(/%DOC_EXT_W32%/g,i?l:m).replace(/%DOCFILE_EXT%/g,l).replace(/%DOCFILE%/g,c).replace(/%DIR%/g,i?"./":f).replace(/%DIR_W32%/g,i?"./":u).replace(/%TMPDIR%/g,e).replace(/%WORKSPACE_FOLDER%/g,i?"./":o).replace(/%RELATIVE_DIR%/,i?"./":ve.relative(o,f)).replace(/%RELATIVE_DOC%/,i?c:ve.relative(o,h)),y=ve.normalize(g(n.get("latex.outDir"))),E=y.split(ve.sep).join("/");return g(r).replace(/%OUTDIR%/g,E).replace(/%OUTDIR_W32%/g,y)}}var CE=q(yE());var qn=q(require("vscode")),Hr=q(require("path"));var _E=q(require("fs")),Fo=class{readFileSyncGracefully(e){try{return _E.readFileSync(e).toString()}catch(r){r instanceof Error&&this.extension.logger.logError(r);return}}constructor(e){this.extension=e}findRootFromMagic(){if(!qn.window.activeTextEditor)return;let e=/^(?:%\s*!\s*T[Ee]X\sroot\s*=\s*(.*\.(?:tex|[jrsRS]nw|[rR]tex|jtexw))$)/m,r=qn.window.activeTextEditor.document.getText(),n=r.match(e),i=[];if(n){let s=Hr.resolve(Hr.dirname(qn.window.activeTextEditor.document.fileName),n[1]);if(r=this.readFileSyncGracefully(s),r===void 0){let o=`Not found root file specified in the magic comment: ${s}`;throw this.extension.logger.addLogMessage(o),new Error(o)}for(i.push(s),this.extension.logger.addLogMessage(`Found root file by magic comment: ${s}`),n=r.match(e);n;){if(s=Hr.resolve(Hr.dirname(s),n[1]),i.includes(s))return this.extension.logger.addLogMessage(`Looped root file by magic comment found: ${s}, stop here.`),s;if(i.push(s),this.extension.logger.addLogMessage(`Recursively found root file by magic comment: ${s}`),r=this.readFileSyncGracefully(s),r===void 0){let o=`Not found root file specified in the magic comment: ${s}`;throw this.extension.logger.addLogMessage(o),new Error(o)}n=r.match(e)}return s}}findSubFiles(e){if(!qn.window.activeTextEditor)return;let r=/(?:\\documentclass\[(.*)\]{subfiles})/,n=e.match(r);if(n){let i=Lr([Hr.dirname(qn.window.activeTextEditor.document.fileName)],n[1]);return i?this.extension.logger.addLogMessage(`Found root file of this subfile from active editor: ${i}`):this.extension.logger.addLogMessage(`Cannot find root file of this subfile from active editor: ${n[1]}`),i}}};var EE=q(require("vscode")),Se=q(require("path")),wE=q(require("fs"));var Mo=class{constructor(){this.inputRegexp=/\\(?:input|InputIfFileExists|include|SweaveInput|subfile|loadglsentries|(?:(?:sub)?(?:import|inputfrom|includefrom)\*?{([^}]*)}))(?:\[[^[\]{}]*\])?{([^}]*)}/g,this.childRegexp=/<<(?:[^,]*,)*\s*child='([^']*)'\s*(?:,[^,]*)*>>=/g}resetLastIndex(){this.inputRegexp.lastIndex=0,this.childRegexp.lastIndex=0}exec(e){let r=this.inputRegexp.exec(e);if(r)return{type:0,path:r[2],directory:r[1],matchedString:r[0],index:r.index};if(r=this.childRegexp.exec(e),r)return{type:1,path:r[1],directory:"",matchedString:r[0],index:r.index}}parseInputFilePath(e,r,n){let i=EE.workspace.getConfiguration("latex-workshop").get("latex.texDirs");if(e.type===1)return Lr([Se.dirname(r),Se.dirname(n),...i],e.path);if(e.type===0)return e.matchedString.startsWith("\\subimport")||e.matchedString.startsWith("\\subinputfrom")||e.matchedString.startsWith("\\subincludefrom")?Lr([Se.dirname(r)],Se.join(e.directory,e.path)):e.matchedString.startsWith("\\import")||e.matchedString.startsWith("\\inputfrom")||e.matchedString.startsWith("\\includefrom")?Lr([e.directory,Se.join(Se.dirname(n),e.directory)],e.path):Lr([Se.dirname(r),Se.dirname(n),...i],e.path)}},jo=class{constructor(e){this.extension=e}getOutDir(e){return this.extension.manager.getOutDir(e)}getFlsFilePath(e){let r=Se.dirname(e),n=this.getOutDir(e),i=Se.parse(e).name,s=Se.resolve(r,Se.join(n,i+".fls"));if(!wE.existsSync(s)){this.extension.logger.addLogMessage(`Cannot find fls file: ${s}`);return}return this.extension.logger.addLogMessage(`Fls file found: ${s}`),s}parseFlsContent(e,r){let n=new Set,i=new Set,s=/^(?:(INPUT)\s*(.*))|(?:(OUTPUT)\s*(.*))$/gm;for(;;){let o=s.exec(e);if(!o)break;if(o[1]){let a=Se.resolve(r,o[2]);a&&n.add(a)}else if(o[3]){let a=Se.resolve(r,o[4]);a&&i.add(a)}}return{input:Array.from(n),output:Array.from(i)}}};var $o=class{constructor(e){this.cachedContent=Object.create(null);this.localRootFiles=Object.create(null);this.rootFilesLanguageIds=Object.create(null);this.rootFiles=Object.create(null);this.workspaceRootDirUri="";this.rsweaveExt=[".rnw",".Rnw",".rtex",".Rtex",".snw",".Snw"];this.jlweaveExt=[".jnw",".jtexw"];this.extension=e,this.finderUtils=new Fo(e),this.pathUtils=new jo(e),this.tmpDir=CE.dirSync({unsafeCleanup:!0}).name.split(Fe.sep).join("/")}getOutDir(e){if(e===void 0&&(e=this.rootFile),e===void 0)return"./";let n=se.workspace.getConfiguration("latex-workshop").get("latex.outDir"),i=t_(e,this.tmpDir)(n);return Fe.normalize(i).split(Fe.sep).join("/")}get rootDir(){return this.rootFile?Fe.dirname(this.rootFile):void 0}get rootFile(){let e=this.rootFiles[this.workspaceRootDirUri];if(e){if(e.type==="filePath")return e.filePath;if(e.uri.scheme==="file")return e.uri.fsPath;this.extension.logger.addLogMessage(`The file cannot be used as the root file: ${e.uri.toString(!0)}`);return}else return}set rootFile(e){e?this.rootFiles[this.workspaceRootDirUri]={type:"filePath",filePath:e}:this.rootFiles[this.workspaceRootDirUri]=void 0}get rootFileUri(){let e=this.rootFiles[this.workspaceRootDirUri];if(e)return e.type==="filePath"?se.Uri.file(e.filePath):e.uri}set rootFileUri(e){let r;e&&(e.scheme==="file"?r={type:"filePath",filePath:e.fsPath}:r={type:"uri",uri:e}),this.rootFiles[this.workspaceRootDirUri]=r}get localRootFile(){return this.localRootFiles[this.workspaceRootDirUri]}set localRootFile(e){this.localRootFiles[this.workspaceRootDirUri]=e}get rootFileLanguageId(){return this.rootFilesLanguageIds[this.workspaceRootDirUri]}set rootFileLanguageId(e){this.rootFilesLanguageIds[this.workspaceRootDirUri]=e}getIncludedTeX(e,r=[]){if(e===void 0&&(e=this.rootFile),e===void 0)return[];if(!(e in this.extension.manager.cachedContent))return[];r.push(e);for(let n of this.extension.manager.cachedContent[e].children)r.includes(n.file)||this.getIncludedTeX(n.file,r);return r}usedPackages(e){let r=e.getText(),n=new Set,i=r.match(/\\usepackage\{(.*?)\}/g);if(i){for(let s of i){let o=s.replace(/\\usepackage\{(.*?)\}/,"$1");n.add(o)}this.extension.logger.addLogMessage(`${i}`)}return n}getGraphicsPath(e){let r=[],n=/\\graphicspath{[\s\n]*((?:{[^{}]*}[\s\n]*)*)}/g,i=Pi(e),s;do if(s=n.exec(i),s)for(let o of s[1].split(/\{|\}/).filter(a=>a.replace(/^\s*$/,"")))r.includes(o)||r.push(o);while(s);return this.extension.logger.addLogMessage(`${r}`),r}getCachedContent(e){return this.cachedContent[e]}inferLanguageId(e){let r=Fe.extname(e).toLocaleLowerCase();return r===".tex"?"latex":this.jlweaveExt.includes(r)?"jlweave":this.rsweaveExt.includes(r)?"rsweave":void 0}hasTexId(e){return["tex","latex","latex-expl3","doctex","jlweave","rsweave"].includes(e)}findWorkspace(){var i;let e=(i=se.workspace.workspaceFolders)==null?void 0:i[0];if(!e){this.workspaceRootDirUri="";return}if(!se.window.activeTextEditor){this.workspaceRootDirUri=e.uri.toString(!0);return}let r=se.window.activeTextEditor.document.uri,n=se.workspace.getWorkspaceFolder(r);if(n){this.workspaceRootDirUri=n.uri.toString(!0);return}this.workspaceRootDirUri=e.uri.toString(!0)}async findRoot(){var n;this.findWorkspace();let e=(n=se.workspace.workspaceFolders)==null?void 0:n.map(i=>i.uri.toString(!0));this.extension.logger.addLogMessage(`Current workspace folders: ${JSON.stringify(e)}`),this.extension.logger.addLogMessage(`Current workspaceRootDir: ${this.workspaceRootDirUri}`),this.localRootFile=void 0;let r=[()=>{if(!se.window.activeTextEditor)return;let i=/^(?:%\s*!\s*T[Ee]X\sroot\s*=\s*(.*\.(?:tex|[jrsRS]nw|[rR]tex|jtexw))$)/m,s=se.window.activeTextEditor.document.getText(),o=s.match(i),a=[];if(o){let c=Fe.resolve(Fe.dirname(se.window.activeTextEditor.document.fileName),o[1]);if(s=ur.readFileSync(c).toString(),s===void 0){let l=`Not found root file specified in the magic comment: ${c}`;throw this.extension.logger.addLogMessage(l),new Error(l)}for(a.push(c),this.extension.logger.addLogMessage(`Found root file by magic comment: ${c}`),o=s.match(i);o;){if(c=Fe.resolve(Fe.dirname(c),o[1]),a.includes(c))return this.extension.logger.addLogMessage(`Looped root file by magic comment found: ${c}, stop here.`),c;if(a.push(c),this.extension.logger.addLogMessage(`Recursively found root file by magic comment: ${c}`),s=ur.readFileSync(c).toString(),s===void 0){let l=`Not found root file specified in the magic comment: ${c}`;throw this.extension.logger.addLogMessage(l),new Error(l)}o=s.match(i)}return c}},()=>this.findRootFromActive(),()=>this.findRootInWorkspace()];for(let i of r){let s=await i();if(s!==void 0)return this.rootFile!==s?(this.extension.logger.addLogMessage(`Root file changed: from ${this.rootFile} to ${s}`),this.extension.logger.addLogMessage("Start to find all dependencies."),this.rootFile=s,this.rootFileLanguageId=this.inferLanguageId(s),this.extension.logger.addLogMessage(`Root file languageId: ${this.rootFileLanguageId}`)):this.extension.logger.addLogMessage(`Keep using the same root file: ${this.rootFile}`),s}}findRootFromActive(){if(!se.window.activeTextEditor)return;if(se.window.activeTextEditor.document.uri.scheme!=="file"){this.extension.logger.addLogMessage(`The active document cannot be used as the root file: ${se.window.activeTextEditor.document.uri.toString(!0)}`);return}let e=/\\begin{document}/m,r=Pi(se.window.activeTextEditor.document.getText());if(r.match(e)){let i=this.finderUtils.findSubFiles(r),s=se.window.activeTextEditor.document.fileName;return i?(this.localRootFile=s,i):(this.extension.logger.addLogMessage(`Found root file from active editor: ${s}`),s)}}async findRootInWorkspace(){let e=/\\begin{document}/m;if(!this.workspaceRootDirUri)return;let r=se.workspace.getConfiguration("latex-workshop"),n=r.get("latex.search.rootFiles.include"),i="{"+n.join(",")+"}",s=r.get("latex.search.rootFiles.exclude"),o=s.length>0?"{"+s.join(",")+"}":void 0;try{let a=await se.workspace.findFiles(i,o),c=[];for(let l of a){if(l.scheme!=="file"){this.extension.logger.addLogMessage(`Skip the file: ${l.toString(!0)}`);continue}let u=this.getTeXChildrenFromFls(l.fsPath);if(se.window.activeTextEditor&&u.includes(se.window.activeTextEditor.document.fileName))return this.extension.logger.addLogMessage(`Found root file from '.fls': ${l.fsPath}`),l.fsPath;let f=Pi(ur.readFileSync(l.fsPath).toString());if(f.match(e)){let h=this.getTeXChildren(l.fsPath,l.fsPath,[],f);if(se.window.activeTextEditor&&h.includes(se.window.activeTextEditor.document.fileName))return this.extension.logger.addLogMessage(`Found root file from parent: ${l.fsPath}`),l.fsPath;c.push(l.fsPath)}}if(c.length>0)return this.extension.logger.addLogMessage(`Found files that might be root, choose the first one: ${c}`),c[0]}catch(a){this.extension.logger.addLogMessage(`Cannot find root file: ${a.message}`)}}getTeXChildrenFromFls(e){let r=this.pathUtils.getFlsFilePath(e);if(r===void 0)return[];let n=Fe.dirname(e);return this.pathUtils.parseFlsContent(ur.readFileSync(r).toString(),n).input}getTeXChildren(e,r,n,i){if(i===void 0&&(i=Pi(ur.readFileSync(e).toString())),this.cachedContent[e]===void 0){this.cachedContent[e]={content:i,bibs:[],children:[]};let s=new Mo;for(;;){let o=s.exec(i);if(!o)break;let a=s.parseInputFilePath(o,e,r);!a||!ur.existsSync(a)||Fe.relative(a,r)===""||this.cachedContent[e].children.push({index:o.index,file:a})}}return this.cachedContent[e].children.forEach(s=>{n.includes(s.file)||(n.push(s.file),this.getTeXChildren(s.file,r,n))}),n}};var O;function FA(t){O=new Ho,O.logger.addLogMessage("LaTeX Utilities Started"),t.subscriptions.push(X.commands.registerCommand("latex-utilities.editLiveSnippetsFile",()=>O.withTelemetry("editLiveSnippetsFile",()=>{O.completionWatcher.editSnippetsFile()})),X.commands.registerCommand("latex-utilities.resetLiveSnippetsFile",()=>O.withTelemetry("resetLiveSnippetsFile",()=>{O.completionWatcher.resetSnippetsFile()})),X.commands.registerCommand("latex-utilities.compareLiveSnippetsFile",()=>O.withTelemetry("compareLiveSnippetsFile",()=>{O.completionWatcher.compareSnippetsFile()})),X.commands.registerCommand("latex-utilities.formattedPaste",()=>O.withTelemetry("formattedPaste",()=>{O.paster.paste()})),X.commands.registerCommand("latex-utilities.citeZotero",()=>O.withTelemetry("citeZotero",()=>{O.zotero.cite()})),X.commands.registerCommand("latex-utilities.openInZotero",()=>O.withTelemetry("openInZotero",()=>{O.zotero.openCitation()})),X.commands.registerCommand("latex-utilities.selectWordcountFormat",()=>O.withTelemetry("selectWordcountFormat",()=>{O.wordCounter.pickFormat()}))),t.subscriptions.push(X.workspace.onDidChangeTextDocument(e=>{Gi(e.document.languageId)&&O.withTelemetry("onDidChangeTextDocument",()=>O.completionWatcher.watcher(e))}),X.workspace.onDidSaveTextDocument(e=>{e.uri.fsPath===O.completionWatcher.snippetFile.user?O.withTelemetry("onDidSaveTextDocument_updateSnippet",()=>O.completionWatcher.loadSnippets(!0)):O.withTelemetry("onDidSaveTextDocument_tex_wordcounter",()=>O.wordCounter.setStatus())}),X.workspace.onDidCloseTextDocument(e=>{e.uri.fsPath.includes(O.completionWatcher.snippetFile.user)&&O.withTelemetry("onDidCloseTextDocument_determineIfUserSnippetsRedundant",()=>O.completionWatcher.determineIfUserSnippetsRedundant())}),X.window.onDidChangeActiveTextEditor(e=>{O.withTelemetry("onDidChangeActiveTextEditor_tex_wordcounter",()=>O.wordCounter.setStatus())})),t.subscriptions.push(X.languages.registerCompletionItemProvider({scheme:"file",language:"tex"},O.completer),X.languages.registerCompletionItemProvider({scheme:"file",language:"latex"},O.completer),X.languages.registerCompletionItemProvider({scheme:"file",language:"doctex"},O.completer),X.languages.registerDefinitionProvider({language:"latex",scheme:"file"},new cs(O))),jA(t.extensionPath),t.subscriptions.push(O.telemetryReporter)}function MA(){O.telemetryReporter.dispose()}function jA(t){fr.readFile(`${t}${lr.sep}package.json`,(e,r)=>{if(e){O.logger.addLogMessage("Cannot read package information.");return}if(O.packageInfo=JSON.parse(r.toString()),O.logger.addLogMessage(`LaTeX Utilities version: ${O.packageInfo.version}`),fr.existsSync(`${t}${lr.sep}VERSION`)&&fr.readFileSync(`${t}${lr.sep}VERSION`).toString()===O.packageInfo.version)return;fr.writeFileSync(`${t}${lr.sep}VERSION`,O.packageInfo.version);let n=X.workspace.getConfiguration("latex-utilities");!n.get("message.update.show")||X.window.showInformationMessage(`LaTeX Utilities updated to version ${O.packageInfo.version}.`,"Change log","Star the project","Disable this message forever").then(i=>{switch(i){case"Change log":X.commands.executeCommand("markdown.showPreview",X.Uri.file(`${t}${lr.sep}CHANGELOG.md`));break;case"Star the project":X.commands.executeCommand("vscode.open",X.Uri.parse("https://github.com/tecosaur/LaTeX-Utilities/"));break;case"Disable this message forever":n.update("message.update.show",!1,!0);break;default:break}})})}var Ho=class{constructor(){this.extensionRoot=lr.resolve(`${__dirname}/../`);let e=X.extensions.getExtension("tecosaur.latex-utilities");this.telemetryReporter=new xE.default("tecosaur.latex-utilities",e.packageJSON.version,"11a955d7-02dc-4c1a-85e4-053858f88af0"),this.logger=new Bi(this),this.completionWatcher=new is(this),this.completer=new ss(this),this.paster=new os(this),this.wordCounter=new as(this),this.zotero=new bs(this),this.manager=new $o(this)}withTelemetry(e,r){this.logger.addLogMessage(e);try{r()}catch(n){this.logger.addLogMessage(n),this.telemetryReporter.sendTelemetryException(n,{command:e}),this.logger.addLogMessage("Error reported.")}}};0&&(module.exports={Extension,activate,deactivate});
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
